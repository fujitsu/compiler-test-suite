#include <stdlib.h>
#include <math.h>
#include  <stdio.h>
#define TRUE 0
#define FALSE -1

int n;
static int errflg = FALSE;
static int colm = 0;
static int res [92][8] = {{ 0, 4, 7, 5, 2, 6, 1, 3},
                          { 0, 5, 7, 2, 6, 3, 1, 4},
                          { 0, 6, 3, 5, 7, 1, 4, 2},
                          { 0, 6, 4, 7, 1, 3, 5, 2},
                          { 1, 3, 5, 7, 2, 0, 6, 4},
                          { 1, 4, 6, 0, 2, 7, 5, 3},
                          { 1, 4, 6, 3, 0, 7, 5, 2},
                          { 1, 5, 0, 6, 3, 7, 2, 4},
                          { 1, 5, 7, 2, 0, 3, 6, 4},
                          { 1, 6, 2, 5, 7, 4, 0, 3},
                          { 1, 6, 4, 7, 0, 3, 5, 2},
                          { 1, 7, 5, 0, 2, 4, 6, 3},
                          { 2, 0, 6, 4, 7, 1, 3, 5},
                          { 2, 4, 1, 7, 0, 6, 3, 5},
                          { 2, 4, 1, 7, 5, 3, 6, 0},
                          { 2, 4, 6, 0, 3, 1, 7, 5},
                          { 2, 4, 7, 3, 0, 6, 1, 5},
                          { 2, 5, 1, 4, 7, 0, 6, 3},
                          { 2, 5, 1, 6, 0, 3, 7, 4},
                          { 2, 5, 1, 6, 4, 0, 7, 3},
                          { 2, 5, 3, 0, 7, 4, 6, 1},
                          { 2, 5, 3, 1, 7, 4, 6, 0},
                          { 2, 5, 7, 0, 3, 6, 4, 1},
                          { 2, 5, 7, 0, 4, 6, 1, 3},
                          { 2, 5, 7, 1, 3, 0, 6, 4},
                          { 2, 6, 1, 7, 4, 0, 3, 5},
                          { 2, 6, 1, 7, 5, 3, 0, 4},
                          { 2, 7, 3, 6, 0, 5, 1, 4},
                          { 3, 0, 4, 7, 1, 6, 2, 5},
                          { 3, 0, 4, 7, 5, 2, 6, 1},
                          { 3, 1, 4, 7, 5, 0, 2, 6},
                          { 3, 1, 6, 2, 5, 7, 0, 4},
                          { 3, 1, 6, 2, 5, 7, 4, 0},
                          { 3, 1, 6, 4, 0, 7, 5, 2},
                          { 3, 1, 7, 4, 6, 0, 2, 5},
                          { 3, 1, 7, 5, 0, 2, 4, 6},
                          { 3, 5, 0, 4, 1, 7, 2, 6},
                          { 3, 5, 7, 1, 6, 0, 2, 4},
                          { 3, 5, 7, 2, 0, 6, 4, 1},
                          { 3, 6, 0, 7, 4, 1, 5, 2},
                          { 3, 6, 2, 7, 1, 4, 0, 5},
                          { 3, 6, 4, 1, 5, 0, 2, 7},
                          { 3, 6, 4, 2, 0, 5, 7, 1},
                          { 3, 7, 0, 2, 5, 1, 6, 4},
                          { 3, 7, 0, 4, 6, 1, 5, 2},
                          { 3, 7, 4, 2, 0, 6, 1, 5},
                          { 4, 0, 3, 5, 7, 1, 6, 2},
                          { 4, 0, 7, 3, 1, 6, 2, 5},
                          { 4, 0, 7, 5, 2, 6, 1, 3},
                          { 4, 1, 3, 5, 7, 2, 0, 6},
                          { 4, 1, 3, 6, 2, 7, 5, 0},
                          { 4, 1, 5, 0, 6, 3, 7, 2},
                          { 4, 1, 7, 0, 3, 6, 2, 5},
                          { 4, 2, 0, 5, 7, 1, 3, 6},
                          { 4, 2, 0, 6, 1, 7, 5, 3},
                          { 4, 2, 7, 3, 6, 0, 5, 1},
                          { 4, 6, 0, 2, 7, 5, 3, 1},
                          { 4, 6, 0, 3, 1, 7, 5, 2},
                          { 4, 6, 1, 3, 7, 0, 2, 5},
                          { 4, 6, 1, 5, 2, 0, 3, 7},
                          { 4, 6, 1, 5, 2, 0, 7, 3},
                          { 4, 6, 3, 0, 2, 7, 5, 1},
                          { 4, 7, 3, 0, 2, 5, 1, 6},
                          { 4, 7, 3, 0, 6, 1, 5, 2},
                          { 5, 0, 4, 1, 7, 2, 6, 3},
                          { 5, 1, 6, 0, 2, 4, 7, 3},
                          { 5, 1, 6, 0, 3, 7, 4, 2},
                          { 5, 2, 0, 6, 4, 7, 1, 3},
                          { 5, 2, 0, 7, 3, 1, 6, 4},
                          { 5, 2, 0, 7, 4, 1, 3, 6},
                          { 5, 2, 4, 6, 0, 3, 1, 7},
                          { 5, 2, 4, 7, 0, 3, 1, 6},
                          { 5, 2, 6, 1, 3, 7, 0, 4},
                          { 5, 2, 6, 1, 7, 4, 0, 3},
                          { 5, 2, 6, 3, 0, 7, 1, 4},
                          { 5, 3, 0, 4, 7, 1, 6, 2},
                          { 5, 3, 1, 7, 4, 6, 0, 2},
                          { 5, 3, 6, 0, 2, 4, 1, 7},
                          { 5, 3, 6, 0, 7, 1, 4, 2},
                          { 5, 7, 1, 3, 0, 6, 4, 2},
                          { 6, 0, 2, 7, 5, 3, 1, 4},
                          { 6, 1, 3, 0, 7, 4, 2, 5},
                          { 6, 1, 5, 2, 0, 3, 7, 4},
                          { 6, 2, 0, 5, 7, 4, 1, 3},
                          { 6, 2, 7, 1, 4, 0, 5, 3},
                          { 6, 3, 1, 4, 7, 0, 2, 5},
                          { 6, 3, 1, 7, 5, 0, 2, 4},
                          { 6, 4, 2, 0, 5, 7, 1, 3},
                          { 7, 1, 3, 0, 6, 4, 2, 5},
                          { 7, 1, 4, 2, 0, 6, 3, 5},
                          { 7, 2, 0, 5, 1, 4, 6, 3},
                          { 7, 3, 0, 2, 5, 1, 6, 4}};

void generate();
int main()
{
    int k, x[8], col[8], up[15], down[15];

    n = 0;
    for( k = 0; k < 8; k++)
        col[k] = TRUE;
    for( k = 0; k < 15; k++)
        up[k] = down[k] = TRUE;
    generate( x, col, up, down);
    if ( errflg == FALSE)
        printf("SCQIH02  PASS.\n");
    else
        printf("SCQIH02  NG.\n");
exit (0);
}


void generate( x, col, up, down)
int x[8], col[8], up[15], down[15];
{
    int h, k;

    for( h = 0; h < 8; h++){
        if ((col[h] == TRUE) &&
            (up[n-h+7] == TRUE) &&
            (down[n+h] == TRUE) ){
            x[n] = h;
            col[h] = up[n-h+7] = down[n+h] = FALSE;
            n++;
            if ( n == 8){
                for (k = 0; k < 8; k++){
                    if ( res[colm][k] != x[k]){
                        printf("ERROR at RES[%3d][%3d]\n",
                               colm, k);
                        errflg = TRUE;
                    }
                }
                colm ++;
            }else
                generate( x, col, up, down);
            n--;
            col[h] = up[n-h+7] = down[n+h] = TRUE;
        }
    }
}
