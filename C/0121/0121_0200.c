#include <stdlib.h>
#include <stdio.h>
#include <math.h>
#include "000.h"
#define I10(i)    i10[i-1]
#define I11(i,j)  i11[i-1][j-1]
#define I12(i,j)  i12[i-1][j-1]
#define L10(i,j)  l10[i-1][j-1]
#define R10(i,j)  r10[i-1][j-1]
#define RD10(i,j) rd10[i-1][j-1]
#define C10(i,j)  c10[i-1][j-1]
#define C11(i,j)  c11[i-1][j-1]
#define C12(i,j)  c12[i-1][j-1]
#define CD10(i,j) cd10[i-1][j-1]
#define Q10(i,j)  q10[i-1][j-1]
#define Q11(i,j)  q11[i-1][j-1]
#define I20(i,j)  i20[i-1][j-1]
#define I21(i,j)  i21[i-1][j-1]
#define CD20(i,j) cd20[i-1][j-1]
#define CD21(i,j) cd21[i-1][j-1]
#define R20(i)    r20[i-1]
#define RD20(i,j)  rd20[i-1][j-1]
#define I31(i,j)  i31[i-1][j-1]
#define I32(i,j)  i32[i-1][j-1]
#define I33(i,j)  i33[i-1][j-1]
#define R30(i,j)  r30[i-1][j-1]
#define CD30(i,j) cd30[i-1][j-1]
#define CD31(i,j) cd31[i-1][j-1]
#define L30(i,j)  l30[i-1][j-1]
#define L31(i,j)  l31[i-1][j-1]
#define L32(i,j)  l32[i-1][j-1]
#define D30(i,j)  d30[i-1][j-1]
long int  i10[10],i11[10][10],
i12[10][10]={
	1,1,1,1,1,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5,
	                        5,5,5,5,5,5,5,5,5,5,8,8,8,8,8,8,8,8,8,8,
	                        8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,
	                        9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,
	                        2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2};
unsigned long int l10[10][10];
float       r10[10][10];
double      rd10[10][10],rd20[10][10] ;
COMPLEX8    c10[10][10],c11[10][10],c12[10][10];
COMPLEX16   cd10[10][10];
long double q10[10][10],
q11[10][10]={
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	                          2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,
	                          3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
	                          4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4};
long int    i20[8][8],i21[8][6];
COMPLEX16   cd20[8][8],
cd21[10][10]={
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	    0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,
	    1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,
	    2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,
	    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	    2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,
	    2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,
	    2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,
	    2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,
	    2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3};
float       r20[10]={
	100,0,50,200,39,10,20,101,99,98};
long int    i31[10][10],i32[10][10],i33[10][10];
float       r30[10][10];
COMPLEX16   cd30[10][10]={
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	    1,1,1,1,1,1,1,1,1,1,0,1,0,1,0,1,0,1,0,1,
	    0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,
	    0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,
	    1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,
	    1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,
	    1,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,
	    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
cd31[10][10]={
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	    1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,
	    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	    1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,
	    1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,
	    1,0,1,0,1,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,
	    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1};
unsigned long int l30[10][10],l31[10][10],l32[10][10];
double      d30[10][10]={
	1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,
	                          1.5,1.5,1.5,1.5,1.5,2.4,2.4,2.4,2.4,2.4,
	                          2.4,2.4,2.4,2.4,2.4,2.4,2.4,2.4,2.4,2.4,
	                          3.9,3.9,3.9,3.9,3.9,3.9,3.9,3.9,3.9,3.9,
	                          3.9,3.9,3.9,3.9,3.9,4.6,4.6,4.6,4.6,4.6,
	                          4.6,4.6,4.6,4.6,4.6,4.6,4.6,4.6,4.6,4.6,
	                          8.8,8.8,8.8,8.8,8.8,8.8,8.8,8.8,8.8,8.8,
	                          8.8,8.8,8.8,8.8,8.8,8.8,8.8,8.8,8.8,8.8,
	                          8.8,8.8,8.8,8.8,8.8,8.8,8.8,8.8,8.8,8.8,
	                          8.8,8.8,8.8,8.8,8.8,8.8,8.8,8.8,8.8,8.8};
int main()
{
	long int N5=5;
	long int N8=8;
	long int N10=10;
	double   RD10V=0,R10V=3;
	float    V=0;
	long int I20S=16;
	COMPLEX8 CS30={
		0,0	};
	long int I1,J=5,I2,I3,IX21=0,I21S=0,IS33=0,IV30=2;
	long int I,i,j;
	float    RS20=100,RS30=0;
	double   RD51=0,RD52=0;
	COMPLEX16 CDS30={
		0,0	};
	for(i=0;i< 10;i++){
		i10[i]=0;
	}
	for(j=0;j< 10;j++){
		for(i=0;i< 10;i++){
			i11[i][j]=j+1;
			l10[i][j]=(fmod(j,2))?1:0;
			r10[i][j]=0;
			c10[i][j].real=0;
			c10[i][j].imag=0;
			c11[i][j].real=(j<5)?4.:8.;
			c11[i][j].imag=(j<5)?12.:6.;
			c12[i][j].real=(j<5)?1.:1.;
			c12[i][j].imag=(j<5)?2.:2.;
			cd10[i][j].dreal=0;
			cd10[i][j].dimag=0;
			q10[i][j]=0;
		}
	}
	for(j=0;j< 8;j++){
		for(i=0;i< 8;i++){
			i20[i][j]=0;
		}
	}
	for(j=0;j< 6;j++){
		for(i=0;i< 8;i++){
			i21[i][j]=j+1;
		}
	}
	for(j=0;j< 8;j++){
		for(i=0;i< 8;i++){
			cd20[i][j].dreal=0;
			cd20[i][j].dimag=0;
		}
	}
	for(j=0;j< 10;j++){
		for(i=0;i< 10;i++){
			rd20[i][j]=0.;
			i31[i][j]=j+1;
			i32[i][j]=0;
			i33[i][j]=0;
			r30[i][j]=(j<5)?5.5:8.4;
			l30[i][j]=(fmod(j,2))?1:0;
			l31[i][j]=1;
			l32[i][j]=(fmod(j,2))?1:0;
			i33[i][j]=0;
		}
	}
	printf("  *****  *****  STAGE 1 TOTAL TEST\n");
	printf("  ----- NO. 1 -----\n");
	for(J=1;J<=N10;J++)
	{
		for(I1=1;I1<=N10;I1++)
		{
			I10(J)=I10(J)+I11(I1,J);
			if ( L10(J,I1) ){
				C10(I1,J).real=(C11(I1,J).real*C12(J,I1).real+
				    C11(I1,J).imag*C12(J,I1).imag)/
				    (C12(I1,J).real*C12(J,I1).real+
				    C12(I1,J).imag*C12(J,I1).imag);
				C10(I1,J).imag=(C11(I1,J).imag*C12(J,I1).real-
				    C11(I1,J).real*C12(J,I1).imag)/
				    (C12(I1,J).real*C12(J,I1).real+
				    C12(I1,J).imag*C12(J,I1).imag);
				R10(I1,J)=C10(I1,J).real*R10V;
			}
LBL_20:
			;
		}
		for(I2=1;I2<=N10;I2++)
		{
			Q10(I2,J)=Q11(I2,J);
LBL_30:
			;
		}
		for(I3=1;I3<=N10;I3+=2)
		{
			CD10(I3,J).dreal=(double)(C10(I3,J).real)/(double)(I3);
			CD10(I3,J).dimag=(double)(C10(I3,J).imag)/(double)(I3);
			if ((C11(J,J).real  !=  4.0) &&
			    (C11(J,J).imag  !=  8.0))goto LBL_41         ;
			RD10V=(RD10V > RD10(I3,I3)) ? RD10V:RD10(I3,I3);
LBL_41:
			;
			I11(I12(I3,J),I12(J,I3))=(int)(CD10(I3,J).dreal);
LBL_40:
			;
		}
LBL_10:
		;
	}
	for(i=1;i<=10;i++){
		printf(" I10 =  %ld \n",I10(i));
	}
	for(j=1;j<=10;j++){
		for(i=1;i<=10;i++){
			printf(" C10 =  %g %g ",C10(i,j).real,C10(i,j).imag);
			printf(" R10 =  %g    ",R10(i,j));
			printf(" Q10 =  %g \n",(double)Q10(i,j));
			printf(" CD10  =  %g %g ",CD10(i,j).dreal,CD10(i,j).dimag);
			printf(" I11   =  %ld \n",I11(i,j));
		}
	}
	printf(" RD10V =  %g ",RD10V);
	printf("  ----- NO. 2 -----\n");
	for(J =1;J <=N8;J +=2)
	{
		for(I1=1;I1<=N5;I1++)
		{
			I20(I1,J)=I20S/I21(J,I1);
LBL_200:
			;
		}
		for(I2=1;I2<=N8;I2++)
		{
			if (RS20 >  R20(I2)){
				IX21=I2;
				RS20=R20(I2);
			}
			I21S=I21S+I20(I2,J);
			CD20(I2,J).dreal=pow(CD21(I2,J).dreal,
			    (double)((I2 < 10) ? I2:10));
			CD20(I2,J).dimag=pow(CD21(I2,J).dimag,
			    (double)((I2 < 10) ? I2:10));
LBL_300:
			;
		}
		for(I3=1;I3<=N8;I3++)
		{
LBL_100:
			;
		}
	}
	for(j=1;j<= 8;j++){
		for(i=1;i<=8;i++){
			printf(" I20  =  %ld \n",I20(i,j));
		}
	}
	printf(" IX21 = %ld , RS20 =  %g \n",IX21,RS20);
	printf(" I21S = %ld ",I21S);
	for(j=1;j<=8;j++){
		for(i=1;i<=8;i++){
			printf(" CD20 =  %g %g \n",CD20(i,j).dreal,CD20(i,j).dimag);
		}
	}
	printf("  ----- NO. 3 -----\n");
	for(J=1;J<=N10;J+=2)
	{
		for(I1=1;I1<=N10;I1+=2)
		{
			RD20(I31(I1,J),J)=pow((double)I1,(double)IV30);
			CD30(I1,I1).dreal=fabs(R30(I1,I1));
			CD30(I1,I1).dimag=0;
LBL_2000:
			;
			if ( L30(I1,J)) L31(J,I1) = (!(L32(I31(J,J),I1)))?1:0;
		}
		for(I2=1;I2<=N10;I2+=3)
		{
			if (( CD30(I2,I2).dreal == CD31(I2,I2).dreal) &&
			    ( CD30(I2,I2).dimag == CD31(I2,I2).dimag)){
				RD51=RD51+CD30(I2,J).dreal;
			}
			else{
				RD52=(RD52>RD20(I2,I2)) ? RD52:RD20(I2,I2);
			}
LBL_3000:
			;
		}
		for(I3=1;I3<=N10;I3+=4)
		{
			I32(I3,J)=(int)(R30(J,I3))+(int)(0.5+D30(J,J))
			    +(int)(CD30(J,I3).dreal);
			IS33=I32(I3,J);
			RS30=IS33;
			CS30.real=RS30;
			CS30.imag=0;
			CDS30.dreal=CS30.real;
			CDS30.dimag=CS30.imag;
LBL_4000:
			;
			I33(I3,I3)=CDS30.dreal;
		}
LBL_1000:
		;
	}
	for(j=1;j<=10;j++){
		for(i=1;i<=10;i++){
			printf(" RD20 =  %g ",RD20(i,j));
			printf(" CD30 = %g %g ",CD30(i,j).dreal,CD30(i,j).dimag);
			printf(" L31 =  %lu \n",L31(i,j));
		}
	}
	printf(" RD51 = %g , RD52 =  %g \n",RD51,RD52);
	for(j=1;j<= 10;j++){
		for(i=1;i<=10;i++){
			printf(" I32 =  %ld ",I32(i,j));
			printf(" I33 =  %ld \n",I33(i,j));
		}
	}
	exit (0);
}
