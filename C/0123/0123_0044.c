#include <stdlib.h>
#include <float.h>
#include <stdio.h>
#include <math.h>

#define SIZE 100
#define TIMES 1000

double x0[SIZE] =
{
	  -16037.0,  -16253.0,   -5401.0,  -15293.0,
	   -4727.0,   -9266.0,    1212.0,   -9968.0,
	    6565.0,   14743.0,   -7379.0,   -1825.0,
	  -12812.0,    6496.0,    2109.0,  -15023.0,
	  -10971.0,   10338.0,    6080.0,    8664.0,
	   10736.0,   15058.0,   -9193.0,   -2398.0,
	   14831.0,   11126.0,   13869.0,   10188.0,
	   -1604.0,    3433.0,    5298.0,    3268.0,
	    1612.0,    7210.0,  -12649.0,   -3073.0,
	  -12404.0,    5612.0,    -822.0,    -291.0,
	    2106.0,   -5095.0,   12083.0,   -7719.0,
	  -10491.0,   -2520.0,    6383.0,  -11019.0,
	    1256.0,    4768.0,    4044.0,  -16283.0,
	    9412.0,   -7571.0,   -1275.0,   -3717.0,
	   -4036.0,    2659.0,    3391.0,   -7214.0,
	  -10794.0,   10000.0,   -6717.0,   -5442.0,
	   -2993.0,   -8505.0,   -2818.0,  -14604.0,
	    -193.0,   15850.0,  -16330.0,   -2954.0,
	  -14098.0,  -13961.0,   -8050.0,   15554.0,
	   -4747.0,   -3115.0,   -9923.0,   -9925.0,
	   -9447.0,   -8223.0,    8459.0,   12759.0,
	   13284.0,    7732.0,   -1267.0,    1035.0,
	  -15227.0,  -12104.0,   -1375.0,    -524.0,
	    3178.0,   -8086.0,  -12628.0,    6598.0,
	    4892.0,   12657.0,   12307.0,  -14982.0,
} ;

double Y0[SIZE] =
{
	    1754.0,     352.0,    3960.0,    8884.0,
	   -8071.0,   -9272.0,   -8650.0,   -5390.0,
	    2171.0,  -12030.0,    3743.0,  -15365.0,
	   14703.0,   -9413.0,   10101.0,    4231.0,
	    7048.0,    7616.0,    1703.0,    2347.0,
	  -10879.0,   -5492.0,   12109.0,   10632.0,
	    3760.0,   14863.0,   16101.0,   15797.0,
	    7785.0,     321.0,   -6704.0,    7145.0,
	   -7018.0,    4583.0,    -248.0,  -10643.0,
	    1940.0,   -3803.0,    8995.0,   -3647.0,
	    4944.0,  -12219.0,  -11635.0,   -5363.0,
	   13730.0,    5062.0,    4866.0,    6860.0,
	    5097.0,    5289.0,    7242.0,   16308.0,
	   -2584.0,    2039.0,   -4039.0,   15848.0,
	  -15903.0,   14487.0,   -1562.0,   -8607.0,
	    1520.0,    -178.0,    4139.0,    6809.0,
	    2730.0,    9495.0,   -2211.0,  -16262.0,
	   10998.0,    7078.0,   15949.0,   -1401.0,
	   -4821.0,   14391.0,    4735.0,    2122.0,
	    6506.0,   -9060.0,   -6231.0,   13053.0,
	  -14018.0,   14982.0,    3696.0,  -13700.0,
	   11379.0,    7443.0,    5726.0,   13930.0,
	    -204.0,   -7016.0,    5927.0,   -6237.0,
	   -4760.0,    8369.0,   15645.0,   13794.0,
	   -8370.0,   -2937.0,   13552.0,   -2636.0,
} ;

double x1[SIZE] =
{
	   -5289.0,   12642.0,  -11605.0,  -11620.0,
	   -5820.0,  -11409.0,    4076.0,   14728.0,
	   -7552.0,  -13102.0,   15716.0,   -8332.0,
	   -9280.0,  -13585.0,     911.0,   12381.0,
	   13273.0,   -7690.0,    3764.0,   12904.0,
	    5089.0,  -13651.0,     543.0,   10579.0,
	   11402.0,    7810.0,    3742.0,    1565.0,
	   15547.0,   15824.0,  -14279.0,   -4367.0,
	    7535.0,  -13199.0,    5943.0,   -5287.0,
	  -12589.0,   -3962.0,   -8114.0,     160.0,
	  -15717.0,   16259.0,  -16343.0,  -13688.0,
	   -8283.0,    1405.0,   -2528.0,   -9171.0,
	   -1326.0,  -11592.0,   -9677.0,   -2759.0,
	  -16095.0,   -1172.0,   -1465.0,  -10422.0,
	  -12532.0,   -2600.0,   15013.0,  -14432.0,
	   -3801.0,  -15734.0,    5552.0,    2315.0,
	  -13833.0,  -13588.0,  -10521.0,   -9708.0,
	   -9967.0,   -7661.0,   -4837.0,  -15509.0,
	    8052.0,  -11324.0,   12273.0,  -15727.0,
	   -8920.0,   11720.0,   13466.0,    7366.0,
	    9239.0,   12146.0,    3538.0,   -6603.0,
	   15402.0,    2926.0,    4887.0,    2398.0,
	    5288.0,   -6197.0,    2860.0,   -9532.0,
	   16077.0,  -14260.0,  -10803.0,    1241.0,
	   11687.0,  -12565.0,   -3916.0,  -10202.0,
} ;

double Y1[SIZE] =
{
	   14133.0,    -337.0,   -3124.0,  -13377.0,
	    4802.0,   -4944.0,   -8012.0,   14822.0,
	  -12162.0,    2919.0,   -7817.0,    9471.0,
	    1630.0,    -965.0,  -11638.0,    4276.0,
	   11831.0,    4938.0,   13319.0,   15209.0,
	   -3818.0,   -1675.0,   -8663.0,  -15390.0,
	   -9246.0,    6318.0,    5384.0,    1843.0,
	   14645.0,   16006.0,  -10347.0,  -15640.0,
	    3191.0,    8433.0,    1496.0,  -14474.0,
	   -5571.0,   12637.0,   14953.0,  -14623.0,
	   10721.0,   -5645.0,   -3282.0,    2991.0,
	   11361.0,     300.0,   -6829.0,    9230.0,
	   13437.0,   12184.0,    6287.0,  -12991.0,
	    3085.0,   -3093.0,    9621.0,   11088.0,
	   -3424.0,     329.0,   13272.0,    6384.0,
	    4443.0,  -15405.0,    4740.0,    7088.0,
	   -4080.0,   10098.0,    2233.0,  -14234.0,
	   10141.0,    3299.0,   14602.0,    9177.0,
	  -12920.0,    6404.0,   13366.0,  -13392.0,
	  -11048.0,  -13731.0,    5925.0,   -3173.0,
	   -8138.0,     242.0,  -12250.0,     704.0,
	  -16059.0,   -7096.0,   -6296.0,   -8856.0,
	    8510.0,  -11339.0,   -6474.0,    9962.0,
	    3792.0,  -13075.0,   15479.0,    2008.0,
	   -4809.0,   -2870.0,   13797.0,  -15255.0,
} ;

double u0[SIZE] =
{
	     155.0,   11867.0,   -4979.0,   12071.0,
	    5035.0,   -5071.0,  -15608.0,  -15399.0,
	   -3462.0,   10213.0,  -13064.0,   -2381.0,
	   13977.0,   11246.0,   15941.0,     956.0,
	    8310.0,    7073.0,   15769.0,  -13695.0,
	   -1547.0,   -6775.0,   13850.0,     504.0,
	   15948.0,    3050.0,    1127.0,  -12105.0,
	     804.0,   -4208.0,    6869.0,    5462.0,
	   -8466.0,    2269.0,   -1813.0,   -5343.0,
	  -14206.0,   15122.0,    4636.0,   14082.0,
	   11263.0,   11741.0,     -61.0,  -14162.0,
	   12511.0,   -9948.0,    6756.0,   -9201.0,
	   -4775.0,   12049.0,  -10718.0,    1778.0,
	     763.0,    4190.0,    -388.0,   -8462.0,
	   -8056.0,   -2334.0,   11596.0,   -7260.0,
	    9488.0,     605.0,    6401.0,   -1788.0,
	   -8114.0,  -11392.0,    5660.0,    -480.0,
	   11334.0,   -7872.0,   -6167.0,  -13309.0,
	   -9185.0,   13404.0,   15488.0,   10468.0,
	   15422.0,   13613.0,   -4101.0,   -1136.0,
	    8101.0,   -2130.0,   -3335.0,  -13547.0,
	   13962.0,   12747.0,   -4013.0,  -10576.0,
	   -5573.0,  -14354.0,    3614.0,  -11783.0,
	   14898.0,    7112.0,   -6687.0,    4429.0,
	  -10636.0,    2397.0,    4120.0,   12924.0,
} ;

double v0[SIZE] =
{
	   -3281.0,   15955.0,   -8471.0,    3508.0,
	    4499.0,  -10373.0,    9253.0,   -1362.0,
	   14832.0,   -3935.0,    7810.0,   13847.0,
	   -7406.0,    4752.0,   -5609.0,   -3263.0,
	     730.0,   11113.0,    4121.0,   -6646.0,
	    1054.0,    -730.0,    4564.0,  -12019.0,
	    7618.0,   11882.0,    2797.0,   -7160.0,
	  -14569.0,   -5749.0,  -14634.0,   -2418.0,
	  -14989.0,   13794.0,   -6766.0,   -5395.0,
	    3858.0,   -2222.0,   -5205.0,  -15006.0,
	    -211.0,  -16361.0,   -9871.0,  -15492.0,
	    5977.0,   -7984.0,    9588.0,     -50.0,
	  -13790.0,   -7472.0,   13892.0,   -4647.0,
	    2791.0,  -10079.0,   14184.0,   14904.0,
	    7928.0,   12506.0,   -6756.0,   -9459.0,
	   -5137.0,   -2269.0,   11856.0,   -9044.0,
	   16204.0,   12166.0,   15965.0,   13959.0,
	  -13484.0,   14328.0,   -9206.0,   13401.0,
	  -10965.0,   -9177.0,   10303.0,   16279.0,
	  -12240.0,    1926.0,    8968.0,    5396.0,
	   -7526.0,  -15977.0,    3917.0,   13043.0,
	    3920.0,   -8072.0,    4560.0,    2770.0,
	     269.0,    7601.0,   10087.0,  -15308.0,
	   12980.0,   -1731.0,  -12676.0,    6959.0,
	   -3855.0,    5846.0,     -62.0,   10072.0,
} ;

double u1[SIZE] =
{
	   -3822.0,     389.0,  -11719.0,    5868.0,
	   -1756.0,     362.0,   -6555.0,   10816.0,
	  -10926.0,   -4151.0,   -2870.0,   -1173.0,
	    5754.0,   13655.0,    7084.0,   -8655.0,
	  -10736.0,   -8509.0,  -14331.0,   -7117.0,
	   -1224.0,   -3193.0,  -10810.0,  -11947.0,
	   15647.0,   -1296.0,  -15533.0,    3184.0,
	   -8549.0,   -9365.0,    5177.0,  -10183.0,
	   -8445.0,      19.0,   16178.0,   -8079.0,
	    7248.0,   -3976.0,  -15525.0,   -6321.0,
	    8820.0,  -14670.0,  -16204.0,    7979.0,
	    9210.0,   12199.0,   12248.0,    -916.0,
	  -10272.0,   -7783.0,    5375.0,    2995.0,
	   14514.0,   13555.0,  -13775.0,    6216.0,
	   -7961.0,  -13484.0,   15564.0,   11974.0,
	     128.0,   -3876.0,   14905.0,  -14333.0,
	   10207.0,    9143.0,   10219.0,   10306.0,
	   -7195.0,   -4631.0,  -15719.0,   16028.0,
	   -6320.0,    -679.0,  -16196.0,    4268.0,
	   15699.0,    9759.0,   -2997.0,    -390.0,
	  -16009.0,   15122.0,  -14411.0,   -5462.0,
	  -10062.0,   -6003.0,   12832.0,    4838.0,
	   10181.0,    -638.0,    -287.0,    9352.0,
	  -15653.0,  -12605.0,    1084.0,   -9844.0,
	    4703.0,    8332.0,    9565.0,   10678.0,
} ;

double v1[SIZE] =
{
	   -5859.0,  -15788.0,   15254.0,   -9217.0,
	    1949.0,  -14124.0,  -15653.0,    1094.0,
	    2237.0,    4697.0,   -6789.0,   14644.0,
	   -3187.0,     327.0,  -15583.0,    3696.0,
	   -4496.0,    6382.0,    3850.0,    7941.0,
	  -12432.0,   -5998.0,   -7800.0,   13328.0,
	    1505.0,   -3915.0,  -10056.0,  -11346.0,
	    6458.0,   -4441.0,   -7040.0,  -15323.0,
	   14640.0,   14929.0,   -9780.0,  -12463.0,
	    6932.0,    8766.0,   10505.0,  -11695.0,
	    8302.0,   -3605.0,  -11295.0,   -6797.0,
	     731.0,    3664.0,    -455.0,   10334.0,
	     292.0,  -11090.0,   13929.0,    -386.0,
	  -13920.0,   10139.0,  -12101.0,  -14411.0,
	    7628.0,  -10676.0,   -3546.0,   -7873.0,
	   -5336.0,  -13789.0,    9803.0,   -1306.0,
	  -10924.0,    9849.0,    7345.0,    3176.0,
	   -4757.0,  -14675.0,   -5827.0,   -2266.0,
	    4768.0,  -14739.0,   -7179.0,    8206.0,
	   14360.0,      68.0,    1014.0,    3530.0,
	    3079.0,   11877.0,  -11853.0,  -10454.0,
	   15373.0,    6582.0,  -13200.0,   -4657.0,
	  -11565.0,     800.0,   -8450.0,    4377.0,
	   -5407.0,   13078.0,   16312.0,   -2733.0,
	   12995.0,   -9372.0,  -10306.0,   -5346.0,
} ;

double p[SIZE] ;

double q[SIZE] ;


void crosspt(
	double *x0,	
	double *Y0,	
	double *x1,	
	double *Y1,	
	double *u0,	
	double *v0,	
	double *u1,	
	double *v1,	
	double *p,	
	double *q,	
	int n)		
{
	double dx, dy, du, dv ;	
	double a ;
	int i ;

	for (i=0 ; i<n ; i++)
	{
		dx = x1[i] - x0[i] ;
		dy = Y1[i] - Y0[i] ;
		du = u1[i] - u0[i] ;
		dv = v1[i] - v0[i] ;
		a = dy * du - dv * dx ;
		if ( a> -DBL_EPSILON && a < DBL_EPSILON )
		{
			p[i] = DBL_MAX ;
			q[i] = DBL_MAX ;
		}
		else
		{
			p[i] = ((v0[i] * du - dv * u0[i]) * dx
			        - (Y0[i] * dx - dy * x0[i]) * du )
			       / a ;
			q[i] = ((u0[i] * dv - du * v0[i]) * dy
			        - (x0[i] * dy - dx * Y0[i]) * dv )
			       / a ;
		}
	}
}
int main()
{
	int i ;
	int n = SIZE ;

	for (i=0 ; i<TIMES ; i++)
	{
		crosspt(x0,Y0,x1,Y1,u0,v0,u1,v1,p,q,n) ;
	}
	for (i=0 ; i<n ; i++)
	{
		printf("p[%d] = %g, q[%d] = %g\n",i,p[i],i,q[i]) ;
	}
	exit(0);
}
