module m&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890

type x&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890
integer x1
end type
type,extends(x&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
):: x&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
x
integer x2
end type
contains
subroutine s1&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890
call s2&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890
contains
subroutine s2&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890
type,extends(x&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
x):: x&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
xx
end type
class(x&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
),pointer:: p
do kk=1,3
select case (kk) 
 case (1)
allocate(x&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
xx::p)
 case (2)
allocate(x&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
x::p)
 case (3)
allocate(x&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
::p)
end select

k=0
select type (p)
 type is(x&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
xx)
  k=1
 type is(x&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
x)
  k=2
 type is(x&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
)
  k=3
end select
select case (kk)
 case(1)
if (k/=1) print *,101
 case(2)
if (k/=2) print *,102
 case(3)
if (k/=3) print *,103
end select
end do
end subroutine
end subroutine
end 
use m&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890
call       s1&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890&
1234567890123456789012345678901234567890123456789012345678901234567890
print *,'pass'
end
