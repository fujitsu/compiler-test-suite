      DOUBLE PRECISION   DA(4),DB(2,2),DC,DD,DE,DFUNS,DFUN1,DFUN2,DFUN3,
     *         DFUN4,DDIF,DCOMP(5),DVAL,DANS,DX,DY,D1,D2
      COMMON        N,DE,DB,DC
      DFUNS(D1,D2)  =D1**2+D2-1.0D0
      DA(1)=1.0D0
      DA(2)=-2.0D0
      DA(3)=3.0D0
      DA(4)=-4.0D0
      DD   =2.0D-5
      WRITE (6,100)
      WRITE (6,110)
      DB(1,1) =1.111111111111111D0
      DB(2,1) =2.222222222222222D0
      DB(1,2) =-3.333333333333333D0
      DB(2,2) =-4.444444444444444D0
      DC =1.0D-5
      DE =-3.0D-5
C
      N=1
      DVAL     =DFUN1(2.0D0*2.0D0,DA,DB(2,N),DC*1.11111111D0)
     *      -2.22222222D0
      DANS     =DSQRT(1.11111111D-5)-4.765402107654322D0
      DANS     =-4.7620687743226553D0
      CALL     PRT(N,DVAL,DANS)
C
      N=2
      CALL     DSUB(DA(1),DD,DX,DY)
      DVAL     =DFUN2(DABS(DA(2)),DSIN(1.5D0),DFUNS(2.0D0,DA(N)),DX-DY,
     *          DFUN1(2.0D0*2.0D0,DA,DB(2,N-1),DC*1.11111111D0))
      DANS     =5.5398665543226553D0
      CALL     PRT(N,DVAL,DANS)
C
      N=3
      DVAL    =DFUN4(DA(N+1),DB,DC,N,DA)
      DANS     =16.946956685963535D0
      CALL     PRT(N,DVAL,DANS)
C
      N=4
      DCOMP(1) =123123123123123.1D0
      DCOMP(2) =-1111.222233334444D0
      DCOMP(3) =-11111111.99999999D0
      DCOMP(4) =987987000000000.9D0
      DCOMP(5) =2.00200200200D0
      M=0
      DO  1    I=1,4
      DDIF=DA(I)-DCOMP(I)
      M=M+1
      IF(DABS(DDIF)-1.0D-15*DABS(DCOMP(I)))  2,3,3
    2 WRITE (6,150) N,M,DA(I),DCOMP(I),DDIF
      GO TO 1
    3 WRITE (6,160) N,M,DA(I),DCOMP(I),DDIF
    1 CONTINUE
      M=M+1
      DDIF=DE-DCOMP(5)
      IF(DABS(DDIF)-1.0D-15*DABS(DCOMP(5)))  4,5,5
    4 WRITE (6,150) N,M,DE,DCOMP(5),DDIF
      GO TO 6
    5 WRITE (6,160) N,M,DE,DCOMP(5),DDIF
    6 WRITE (6,120)
  150 FORMAT (1H0,12X,7H*OK*   ,9X,1H(,I2,1H-,I1,1H),6X,D25.17,5X,D25.17
     *        ,5X,D25.17 )
  160 FORMAT (1H0,12X,7H*ERROR*,9X,1H(,I2,1H-,I1,1H),6X,D25.17,5X,D25.17
     *        ,5X,D25.17 )
  100 FORMAT (1H1 / 6X,24H*FORTRAN*          ENTER )
  110 FORMAT (1H0,10X,11H- JUSTICE -,5X,8H- ITEM -,9X,19H- COMPUTED RESU
     *LT -,12X,17H- COMPARE VALUE -,14X,14H- DIFFERENCE -  / )
  120 FORMAT (1H0 // 6X,23H*FORTRAN*          EXIT )
      STOP
      END
      DOUBLE PRECISION FUNCTION    DFUN1(D1,D2,D3,D4)
      DOUBLE PRECISION   D1,D2(4)  ,D3,D4,DDE,DDA(5),DDB,DDC
      COMMON   N,DDE
      DDA(5)  =0.0 D0
      DO  1    I=1,4
      DDA(I)  =(-1.0D0)**I
      DDA(5)  =DDA(I)+D2(I)+DDA(5)
    1 CONTINUE
      DDB =DDA(5)-D1+D3+1.234567890123456D0
      DDC =DSQRT(D4)-DDE
      DFUN1=DDB+DDC
      RETURN
      END
      DOUBLE PRECISION FUNCTION    DFUN2(D1,D2,D3,D4,D5)
      DOUBLE PRECISION   D1,D2,D3,D4,D5,DDA,DDB
      DDA =D1+D3-D5
      DDB =D2/DSIN(1.5D0)-D4
      DFUN2 =DDA-DDB
      RETURN
      END
      DOUBLE PRECISION FUNCTION    DFUN4(D1,D2,D3,D4,D5)
      DOUBLE PRECISION        D1,D2,D3,D5(4),DD1,DD2,DD3,DFUNSS,DDE
      INTEGER       D4
      COMMON   N,DDE
      DFUNSS(DD1,DD2,DD3)=DD1**2+DSIN(DD2)-DD3
      DFUN4=DFUNSS(D1,D2,D3)+DCOS(1.52D0)
      D5(1)=123123123123123.1D0
      D5(2)=-1111.222233334444D0
      D5(3)=-11111111.99999999D0
      D5(4)=987987000000000.9D0
      DDE =2.00200200200D0
      RETURN
      END
      SUBROUTINE    DSUB(D1,D2,DX,DY)
      DOUBLE PRECISION        D1,D2,DX,DY,DDB,DB(2,2),DC,DE
      COMMON        N,DE,DB,DC
      DDB =0.0
      DO  1    J=1,2
      DO  1    I=1,2
      DDB =DDB+DB(I,J)
    1 CONTINUE
      DX  =DDB+D1
      DY  =DDB-D2
      RETURN
      END
      SUBROUTINE    PRT(N,DVAL,DANS)
      DOUBLE PRECISION   DVAL,DANS,DDIF
      DDIF=DVAL-DANS
      IF(DABS(DDIF)-1.0E-15*DABS(DANS)) 1,2,2
    1 WRITE (6,100) N,DVAL,DANS,DDIF
      RETURN
    2 WRITE (6,110) N,DVAL,DANS,DDIF
      RETURN
  100 FORMAT (1H0,12X,7H*OK*   ,9X,1H(,I2,1H),8X,D25.17,5X,D25.17,5X,
     *         D25.17   )
  110 FORMAT (1H0,12X,7H*ERROR*,9X,1H(,I2,1H),8X,D25.17,5X,D25.17,5X,
     *         D25.17   )
      END
