C
      IMPLICIT INTEGER (I), REAL (R), REAL *8 (D), COMPLEX (C),
     1         COMPLEX *16 (P), LOGICAL (L)
C
      COMMON ITEM,GYOCNT
      DIMENSION IWH(6), IWY(2,3), RWH(6), RWY(2,3), DRWH(5), DRWY(2,3),
     1          CWH(5), CWY(2,2), PCWH(5), PCWY(2,2), LWH(6), LWY(2,2)
      DATA I1,I2,I3,I4,I5,I6,I7,I8,I9,I10/1,2,3,4,5,6,7,8,9,10/,IWH/6*2/
      DATA R1,R2,R3,R4,R5,R6,R7,R8,R9,R10/1.0,2.0,3.0,4.0,5.0,6.0,7.0,
     1    8.0,9.0,10.0/,RWH/6*3.0/
      DATA DR1,DR2,DR3,DR4,DR5,DR6/1.1000000,2.2000000,3.3000000,
     1     4.4000000,5.5000000,6.6000000/,DRWH/5*4.4000000/
      DATA C1,C2,C3,C4,C5,C6/(1.0,1.0),(2.0,2.0),(3.0,3.0),(4.0,4.0),
     1     (5.0,5.0),(6.0,6.0)/,CWH/5*(5.0,5.0)/
      DATA PCD1,PCD2,PCD3,PCD4,PCD5,PCD6/(1.0D0,1.0D0),(2.0D0,2.0D0),
     1     (3.0D0,3.0D0),(4.0D0,4.0D0),(5.0D0,5.0D0),(6.0D0,6.0D0)/,
     2     PCWH/5*(1.0D0,1.0D0)/
      DATA L1,L2,L3,L4,L5,L6,L7,L8/4*.TRUE.,4*.FALSE./,LWH/6*.TRUE./
C
      DATA IAA1,IAA2/2,5/,RAA1,RAA2/1.0,2.0/,DAA1,DAA2/3.3000000,4.4000
     1000/,CAA1,CAA2/(1.0,1.0),(4.0,4.0)/,PAA1,PAA2/(3.0D0,3.0D0),(4.0D0
     2,4.0D0)/
C
C
      CBK(CC1,CC2,CC3,CC4,CC5,CC6,CWK1,CWK2,CWK3,CWK4,CWK5,CWY1,CWY2,
     1    CWY3,CWY4,CSC1,CSC2,CSC3,CSC4,CSC5) = ((CC1+CC2+CC3)/CC6)+
     2     (CC5-CC4)+(CWK1*(CWK2+CWK3+CWK4-CWK5))+(CWY1+CWY2+CWY3-CWY4)+
     3    (CSC1+CSC2+CSC3-CSC4+CSC5)
C
C
      PDBK(PCD1,PCD2,PCD3,PCD4,PCD5,PCD6,PCWK1,PCWK2,PCWK3,PCWK4,PCWK5,
     1     PCWY1,PCWY2,PCWY3,PCWY4,PCS1,PCS2,PCS3,PCS4,PCS5) =
     2   (PCD1+PCD2+PCD3+PCD6)+(PCD5-PCD4)+(PCWK1+PCWK4+PCWK5+PCWK3+
     3   PCWK2)+(PCWY1+PCWY2+PCWY3+PCWY4)+(PCS2-PCS1+PCS5-PCS3+PCS4)
C
C
C
      IWY(1,1)=1
      IWY(1,2)=2
      IWY(1,3)=3
      IWY(2,1)=4
      IWY(2,2)=5
      IWY(2,3)=6
      RWY(1,1)=1.0
      RWY(1,2)=2.0
      RWY(1,3)=3.0
      RWY(2,1)=4.0
      RWY(2,2)=5.0
      RWY(2,3)=6.0
      DRWY(1,1)=1.1000000
      DRWY(1,2)=2.2000000
      DRWY(1,3)=3.3000000
      DRWY(2,1)=4.4000000
      DRWY(2,2)=5.5000000
      DRWY(2,3)=6.6000000
      CWY(1,1)=(1.0,1.0)
      CWY(1,2)=(2.0,2.0)
      CWY(2,1)=(3.0,3.0)
      CWY(2,2)=(4.0,4.0)
      PCWY(1,1)=(1.0D0,1.0D0)
      PCWY(1,2)=(2.0D0,2.0D0)
      PCWY(2,1)=(3.0D0,3.0D0)
      PCWY(2,2)=(4.0D0,4.0D0)
      LWY(1,1)=.TRUE.
      LWY(1,2)=.FALSE.
      LWY(2,1)=.TRUE.
      LWY(2,2)=.FALSE.
C
      CALL INJINT(7)
C
C
C
      IVAL=IBK(I1,I2,I3,I4,I5*IAA1,I6,I7,I8,I9,I10-IAA2,IWH(1),IWH(2)
     1  ,IWH(3),IWH(4),IWH(5),IWH(6),IWY(1,1),IWY(1,2),IWY(1,3),IWY(2,1)
     2   ,IWY(2,2)+1,IWY(2,3)-1,2,4,3*2,8/4)
C
C
      CALL INJI(1,IVAL,24,0.0,0.0,0.0D0,0.0D0,(0.0,0.0),(0.0,0.0),
     1         (0.0D0,0.0D0),(0.0D0,0.0D0),L1,L2,7)
C
C
      RVAL=RAA1*RAA2+RBK(R1,R2,R3,R4,R5,R6,R7,R8,R9,R10,RWH(1),RWH(2),
     1     RWH(3)+RAA1,RWH(4),RWH(5)-RAA2,RWY(1,1),RWY(1,2)+1.0,RWY(1,3)
     2     -1.0,RWY(2,1),RWY(2,2)+RWY(2,3),1.0,2.0/2.0,3.0,4.0)+10.0
C
C
      CALL INJI(2,0,0,RVAL,46.50000,0.0D0,0.0D0,(0.0,0.0),(0.0,0.0),
     1         (0.0D0,0.0D0),(0.0D0,0.0D0),L1,L2,7)
C
C
      DVAL=DRBK(DR1,DR2,DR3,DR4,DR5,DR6,DRWH(1),DRWH(2),DRWH(3),DRWH(4),
     1     DRWH(5),DRWY(1,1)+DAA1,DRWY(1,2),DRWY(2,3)-DRWY(1,3),DRWY(2,1
     2     ),DRWY(2,2),1.1D0,2.2D0,3.3D0,8.8D0/2.2D0,5.0D0)+123.556D0
C
C
      CALL INJI(3,0,0,0.,0.,DVAL,127.8287272727272D0,(0.0,0.0),(0.0,0.0)
     1        ,(0.0D0,0.0D0),(0.0D0,0.0D0),L1,L2,7)
C
C
      CVAL=CBK(C1,C2,C3,C4,C5,C6,CWH(1),CWH(2),CWH(3),CWH(4),CWH(5),
     1     CWY(1,1),CWY(1,2),CWY(2,1),CWY(2,2),(1.0,1.0)*CAA1,(2.0,2.0)+
     2     CAA2,(3.0,3.0),(4.0,4.0),(5.0,5.0))-CAA1
C
C
      CALL INJI(4,0,0,0.0,0.0,0.0D0,0.0D0,CVAL,(13.0,114.0),
     1     (0.0D0,0.0D0),(0.0D0,0.0D0),L1,L2,7)
C
C
      PVAL=PDBK(PCD1,PCD2,PCD3,PCD4,PCD5,PCD6,PCWH(1),PCWH(2),PCWH(3),
     1     PCWH(4),PCWH(5),PCWY(1,1),PCWY(1,2),PCWY(2,1),PCWY(2,2),
     2         (1.0D0,1.0D0),(2.0D0,2.0D0),(3.0D0,3.0D0),(4.0D0,4.0D0),
     3         (5.0D0,5.0D0))+(PAA1+PAA2)
C
      CALL INJI(5,0,0,0.0,0.0,0.0D0,0.0D0,(0.0,0.0),(0.0,0.0),PVAL,
     1         (42.0D0,42.0D0),L1,L2,7)
C
C
      LVAL=LBK(L1,L2,L3,L4,L5,L6,L7,L8,LWH(1),LWH(2),LWH(3),LWH(4),LWH(5
     1),LWH(6),LWY(1,1),LWY(1,2),LWY(2,1),LWY(2,2),.TRUE.,.TRUE.,.FALSE.
     2,.FALSE.).AND..TRUE.
C
C
      CALL INJI(6,0,0,0.0,0.0,0.0D0,0.0D0,(0.0,0.0),(0.0,0.0),
     1     (0.0D0,0.0D0),(0.0D0,0.0D0),LVAL,L1,7)
C
C
      DVAL1=IBK(I1,I2,I3,I4,I5,I6,I7,I8,I9,I10,IWH(1),IWH(2),IWH(3),IWH
     1      (4),IWH(5),IWH(6),IWY(1,1),IWY(1,2),IWY(2,1),IWY(2,1),IWY(2,
     22),IWY(2,3),1,2,3,4)+RBK(R1,R2,R3,R4,R5,R6,R7,R8,R9,R10,RWH(1),RWH
     3(2),RWH(3),RWH(4),RWH(5),RWY(1,1),RWY(1,2),RWY(1,3),RWY(2,1),RWY(2
     4,2),1.0,2.0,3.0,4.0)+DRBK(DR1,DR2,DR3,DR4,DR5,DR6,DRWH(1),DRWH(2),
     5DRWH(3),DRWH(4),DRWH(5),DRWY(1,1),DRWY(1,2),DRWY(1,3),DRWY(2,1),
     6DRWY(2,2),1.1D0,2.2D0,3.3D0,4.4D0,5.0D0)
C
C
      CALL INJI(3,0,0,0.,0.,DVAL1,39.21818564565577D0,
     1    (0.0,0.0),(0.0,0.0),(0.0D0,0.0D0),(0.0D0,0.0D0),L1,L2,7)
      STOP
      END
      INTEGER FUNCTION IBK (II1,II2,II3,II4,II5,II6,II7,II8,II9,I10,
     *                      IWK1,IWK2,IWK3,IWK4,IWK5,IWK6,
     *                      IWY1,IWY2,IWY3,IWY4,IWY5,IWY6,
     *                      ICS1,ICS2,ICS3,ICS4)
C
      IMPLICIT  REAL*8(D),LOGICAL(L)
C
C
          DATA  I5,I6,I9 /5,6,9 /
      IBK =((II1+II2+II3+II4)/I10)+((II7+II8)/I5)+I9-I6+((IWK1+IWK2+
     *       IWK3+IWK4)/(2*IWK5))+IWK6+((IWY1+IWY2+IWY3)/IWY5
     *       +(IWY6-IWY4))+(ICS1+ICS2+ICS3-ICS4)
      RETURN
C
C
      ENTRY RBK (RR1,RR2,RR3,RR4,RR5,RR6,RR7,RR8,RR9,R10,
     *           RWK1,RWK2,RWK3,RWK4,RWK5,
     *           RWY1,RWY2,RWY3,RWY4,RWY5,
     *           RCS1,RCS2,RCS3,RCS4 )
C
      RBK =((RR1+RR2+RR3)/RR6)+(RR4+RR5-RR9)*RR7+R10-RR8+((RWK1+RWK2+
     *       RWK3+RWK4)/RWK5)-((RWY3+RWY4)/(RWY1+RWY2))+RWY5
     *      +(RCS1+RCS2+RCS3+RCS4)
      RETURN
C
C
      ENTRY DRBK (DRR1,DRR2,DRR3,DRR4,DRR5,DRR6,DRWK1,DRWK2,DRWK3,DRWK4,
     *            DRWK5,DRWY1,DRWY2,DRWY3,DRWY4,DRWY5,
     *            DRCS1,DRCS2,DRCS3,DRCS4,DRCS5)
C
      DRBK =((DRR1+DRR2+DRR3)/DRR5)+(DRR6-DRR4)+((DRWK1+DRWK4)/DRWK2+
     *    (DRWK5-DRWK3))+(DRWY1+DRWY2+DRWY3+DRWY4)/DRWY5-((DRCS1+DRCS2
     *    +DRCS4+DRCS5)/DRCS3)
C
      RETURN
C
C
      ENTRY LBK (LL1,LL2,LL3,LL4,LL5,LL6,LL7,LL8,LWK1,LWK2,LWK3,LWK4,
     *           LWK5,LWK6,LWY1,LWY2,LWY3,LWY4,LCS1,LCS2,LCS3,LCS4 )
C
      LL5=.FALSE.
      LL8=.FALSE.
      LBK = (LL1.AND.LL2).OR.(.NOT.LL3.OR.(LL4.AND.LL5).OR.((LL6.OR.
     *       LL7).AND.LL8).OR.((LWK1.OR.LWK2).AND.(LWK3.AND.LWK4)).OR.
     *     ((.NOT.LWK5.OR.LWK6).AND.(LWY1.OR.LWY2)).OR.(LWY3.AND.LWY4)
     *       .OR.(LCS1.OR.LCS2.OR.LCS3.OR.LCS4))
C
      RETURN
      END
      SUBROUTINE INJINT(ITMMAX)
      COMMON ITEM,GYOCNT
      INTEGER      GYOCNT
      INTEGER  I1, I2, IDIFF, KATA, ITEM
      REAL     R1, R2, RDIFF, RWK1, RWK2, RWK3, RWK4, RWKWK
      REAL*8   DR1, DR2, DRDIFF, TEXT, DRWK1, DRWK2, DRWK3, DRWK4,
     1         DRWKWK,ERROR,OK
      COMPLEX  C1, C2
      COMPLEX*16    DC1, DC2
      LOGICAL  L1, L2
      DATA     ERROR, OK / '*ERROR* ', ' *OK*   '/
      WRITE(6,300)
      ITEM=1
      GO TO 999
      ENTRY    INJI(KATA,I1,I2,R1,R2,DR1,DR2,C1,C2,DC1,DC2,L1,L2,ITMMAX)
      TEXT=ERROR
      GO TO  (100, 101, 102, 103, 104, 105),KATA
  100 IDIFF=IABS(I1-I2)
      IF(IDIFF.EQ.0)  TEXT=OK
      WRITE(6,310)  ITEM, TEXT, I1, I2, IDIFF
  111 GYOCNT=GYOCNT+2
      GO TO 500
  101 RDIFF=ABS(R1-R2)
      IF(RDIFF.EQ.0.0)  TEXT=OK
      IF(R2.EQ.0.0)  GO TO 121
      IF(ABS(RDIFF/R2).LE.0.1D-4)  TEXT=OK
  121 WRITE(6,320)  ITEM, TEXT, R1, R2, RDIFF
      GO TO 111
  102 DRDIFF=DABS(DR1-DR2)
      IF(DRDIFF.EQ.0.0D00)  TEXT=OK
      IF(DR2.EQ.0.0D00)  GO TO 122
      IF(DABS(DRDIFF/DR2).LE.0.1D-4)   TEXT=OK
  122 DRDIFF=0.0d0
      WRITE(6,330)  ITEM, TEXT, DR1, DR2, DRDIFF
      GO TO 111
  103 RWK1=REAL(C1)
      RWK2=REAL(C2)
      RWK3=AIMAG(C1)
      RWK4=AIMAG(C2)
      RDIFF=ABS(RWK1-RWK2)
      RWKWK=ABS(RWK3-RWK4)
      IF(RDIFF.EQ.0.0)  GO TO 200
      IF(RWK2.EQ.0.0)  GO TO 222
      IF(ABS(RDIFF/RWK2).LE.0.1D-4)   GO TO 200
      GO TO 222
  200 IF(RWKWK.EQ.0.0)  TEXT=OK
      IF(RWK4.EQ.0.0)  GO TO 222
      IF(ABS(RWKWK/RWK4).LE.0.1D-4)   TEXT=OK
  222 WRITE(6,340)  RWK1, RWK2, RDIFF, ITEM, TEXT, RWK3, RWK4, RWKWK
  202 GYOCNT=GYOCNT+4
      GO TO 500
  104 DRWK1=DC1*1.0D0
      DRWK2=DC2*1.0D0
      DRWK3=DC1*(0.0D0,-1.0D0)
      DRWK4=DC2*(0.0D0,-1.0D0)
      DRDIFF=DABS(DRWK1-DRWK2)
      DRWKWK=DABS(DRWK3-DRWK4)
      IF(DRDIFF.EQ.0.0D00)  GO TO 201
      IF(DRWK2.EQ.0.0D00)  GO TO 223
      IF(DABS(DRDIFF/DRWK2).LE.0.1D-4)  GO TO 201
      GO TO 223
  201 IF(DRWKWK.EQ.0.0D00)  TEXT=OK
      IF(DRWK4.EQ.0.0D00)  GO TO 223
      IF(DABS(DRWKWK/DRWK4).LE.0.1D-4)  TEXT=OK
  223 WRITE(6,350) DRWK1,DRWK2,DRDIFF,ITEM,TEXT,DRWK3,DRWK4,DRWKWK
      GO TO 202
  105 IF(L1.AND.(.NOT.L2))  GO TO  333
      IF((.NOT.L1).AND.L2)  GO TO  333
      TEXT=OK
  333 WRITE(6,360)  ITEM, TEXT, L1,L2
      GO TO 111
  500 ITEM=ITEM+1
      IF(ITEM.LE.ITMMAX)  GO TO 700
      WRITE(6,390)
      STOP
  700 IF(GYOCNT.LE.50)  RETURN
      WRITE(6,400)
  999 WRITE(6,380)
      GYOCNT=0
      RETURN
  300 FORMAT(1H1,/ 7X,25H*FORTRAN*          ENTER , //// )
  310 FORMAT(1H+,6X,1H(,I2,1H),9X,A8,8X,3(27X,I5), // )
  320 FORMAT(1H+,6X,1H(,I2,1H),9X,A8,8X,3(18X,E14.7), // )
  330 FORMAT(1H+,6X,1H(,I2,1H),9X,A8,8X,3(9X,D23.16), // )
  340 FORMAT(1H+,36X,6HREAL =,11X,E14.7,2(18X,E14.7), / 7X,1H(,I2,1H),
     19X,A8, / 32X,11HIMAGINARY =,11X,E14.7,2(18X,E14.7), // )
  350 FORMAT(1H+,36X,6HREAL =,2X,D23.16,2(9X,D23.16), / 7X,1H(,I2,1H),
     19X,A8, / 32X,11HIMAGINARY =,2X,D23.16,2(9X,D23.16), // )
  360 FORMAT(1H+,6X,1H(,I2,1H),9X,A8,8X,2(31X,L1), //)
  380 FORMAT(1H+,4X,8H- ITEM -,5X,11H- JUSTICE -,21X,18H- COMPUTED VALUE
     1 -,15X,17H- COMPARE VALUE -,18X,14H- DIFFERENCE -, /// )
  390 FORMAT(1H0,6X,24H*FORTRAN*          EXIT )
  400 FORMAT(1H1,/////)
      END
