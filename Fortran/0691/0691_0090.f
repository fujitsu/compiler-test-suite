C
      DOUBLE PRECISION   DA1(3,4,5),DA2(4),D1,D2,D3,DW(60),DX
      INTEGER*4          DI1,DI2,DI3,DIK(500),DIW(500)
      INTEGER       BU,FU,I1,I2,I3,OK
      LOGICAL       L1,L2,L3,LW(3)
      REAL          R1,R2,R3
      COMPLEX*16    DCA(2,2,2),DC1,DC2,DCW(10)
      COMPLEX       C1,C2,C3,CW(10)
      WRITE(6,10)
   10 FORMAT(1H1 / 6X,24H*FORTRAN*          ENTER / )
      CALL    PTHEAD
C
C
      BU=1
      FU=2
      REWIND  BU
      REWIND  FU
      K=1
      DO 20 I3=1,5
      DO 20 I2=1,4
      DO 20 I1=1,3
      DA1(I1,I2,I3)=(-1)**K*K
   20 K=K+1
      R1=-0.415327E-11
      R2= 2.22222E+14
      I1=24396
      WRITE(BU)  R1,R2,I1
      WRITE(BU)  (((DA1(I,J,K),I=1,3),J=1,4),K=1,5)
      DO 30 I=1,500
   30 DIK(I)=(-1)**I*10*I
      I2=0
      D1= -3.3322105D-19
      D2=  0.10256512D-35
      D3=  0.72700737000747D+70
      I3= -328
      C1= ( -428.65,+3926054.2E00 )
      C2= ( -0.216039E-13,0.0 )
      DC1= ( 3.82459D+15,-0.813762540074D-49 )
      DC2= ( 0.0D0,+3.000200140007D-39)
      WRITE(BU) DC1
      DO 50 I=3,63,1
   50 WRITE(BU) (DIK(K),K=1,I)
      WRITE(BU) (((DA1(I,J,K),I=1,3),J=1,4),K=1,2),(DIK(I),I=1,13),DC2
      WRITE(BU) (DIK(I),I=1,61),I2,C1,C2
      ENDFILE BU
      REWIND  BU
      READ(BU)  RW1,RW2,IW1
      CALL    RCHECK(1,RW1,R1,1,OK)
      CALL    RCHECK(2,RW2,R2,1,OK)
      CALL    ICHECK(3,IW1,I1,1,OK)
      READ(BU)  DW
      DO 70 I=1,60
      DX=(-1)**I*I
      CALL    DCHECK(4,DW(I),DX,2,OK)
      IF (OK) 60,70,60
   70 CONTINUE
      WRITE(6,75)
      GO TO 90
   60 WRITE(6,65) I,DW(I),DX
   75 FORMAT(1H0,7X,7H*OK*   ,9X,4H( 4),21X,22HWRITE( 488BYTE DATA )  )
   65 FORMAT(1H0,7X,7H*ERROR*,9X,4H( 4),21X,22HWRITE( 448BYTE DATA ) /
     *       54X,3HDW(,I2,2H)=,D23.16,5X,3HDX=,D23.16 )
C
   90 READ(BU) DCW(BU)
      CALL    DCCHK(5,DCW(1),DC1,1,OK)
      IERROR=0
      DO 120 I=3,63
      READ (BU)  (DIW(K),K=1,I)
      IBT=4*I+8
      DO 100 K=1,I
      CALL    DICHK(6,DIW(K),DIK(K),2,OK)
      IF (OK) 95,100,95
  100 CONTINUE
      GO TO 120
   95 WRITE(FU,85) IBT,K,DIW(K),K,DIK(K)
      IERROR=IERROR+1
  120 CONTINUE
      IF (IERROR) 110,130,110
  130 WRITE(6,135)
      GO TO 150
  110 WRITE(6,115) IERROR
      DO 125 I=1,IERROR
      READ(FU,140) (DIW(J),J=1,30)
  125 WRITE(FU,140) (DIW(J),J=1,30)
   85 FORMAT(54X,2H* ,I3,7H DATA *,5X,4HDIW(,I2,2H)=,I6,5X,4HDIK(,I2,
     *       2H)=,I6 )
  135 FORMAT(1H0,7X,7H*OK*   ,9X,4H( 6),21X,23HREAD/WRITE (20-262BYTE) )
  115 FORMAT(1H0,7X,7H*ERROR*,9X,4H( 6),21X,23HREAD/WRITE (20-262BYTE),
     *       5X,14HERROR COUNT = ,I2 )
  140 FORMAT(30A4 )
C
  150 READ(BU) (DW(I),I=1,24),(DIW(I),I=1,13),DCW(2)
      CALL     DCCHK(7,DCW(2),DC2,1,OK )
      DO 160 I=1,24
      DX=(-1)**I*I
      CALL     DCHECK(8,DW(I),DX,2,OK)
      IF (OK) 170,160,170
  160 CONTINUE
      DO 165 I=1,13
      CALL     DICHK(8,DIW(I),DIK(I),2,OK )
      IF (OK) 175,165,175
  165 CONTINUE
      WRITE(6,180)
  180 FORMAT(1H0,7X,7H*OK*   ,9X,4H( 8),21X,23HREAD/WRITE (260BYTE)   )
      GO TO 200
  170 WRITE(6,185) I,DW(I),DX
      GO TO 200
  175 WRITE(6,190) I,DIW(I),I,DIK(I)
  185 FORMAT(1H0,7X,7H*ERROR*,9X,4H( 8),21X,23HREAD/WRITE (260BYTE)   /
     *       54X,3HDW(,I2,2H)=,D23.16,5X,3HDX=,D23.16 )
  190 FORMAT(1H0,7X,7H*ERROR*,9X,4H( 8),21X,23HREAD/WRITE (260BYTE)   /
     *       54X,4HDIW(,I2,2H)=,I6,5X,4HDIK(,I2,2H)=,I6 )
C
  200 READ(BU) (DIW(I),I=1,61),IWX1,CW(9),CW(10)
      CALL  ICHECK( 9,IWX1  ,I2,1,OK )
      CALL  CCHECK(10,CW(9)  ,C1,1,OK )
      CALL  CCHECK(11,CW(10),C2,1,OK )
      BACKSPACE BU
      REWIND FU
      READ(BU) (DIW(I),I=101,161,1),IWX1,(CW(I),I=3,4)
      CALL  ICHECK(12,IWX1,I2,1,OK)
      CALL  CCHECK(13,CW(3),C1,1,OK)
      CALL  CCHECK(14,CW(4),C2,1,OK)
      BACKSPACE BU
      BACKSPACE BU
      READ (BU) (DW(I),I=1,24),(DIW(I),I=1,13),DCW(3)
      CALL  DCCHK(15,DCW(3),DC2,1,OK)
      BACKSPACE BU
      IERROR=0
      I=63
  220 BACKSPACE BU
      READ(BU) (DIW(K),K=1,I)
      DO 230 K=1,I
      CALL  DICHK(16,DIW(K),DIK(K),2,OK)
      IF (OK) 240,230,240
  230 CONTINUE
      GO TO 250
  240 IBT=4*I+8
      WRITE(FU,85) IBT,K,DIW(K),K,DIK(K)
      IERROR=IERROR+1
  250 I=I-1
      BACKSPACE BU
      IF(I.GE.3) GO TO 220
      IF (IERROR) 260,255,260
  255 WRITE(6,254)
  254 FORMAT(1H0,7X,7H*OK*   ,9X,4H(16),21X,23HBACKSPACE (DATA RECORD ,
     *      17H.... 20-262 BYTE)  )
      GO TO 289
  260 WRITE(6,259) IERROR
  259 FORMAT(1H0,7X,7H*ERROR*,9X,4H(16),21X,23HBACKSPACE (DATA RECORD ,
     *      17H.... 20-252 BYTE),5X,14HERROR COUNT = ,I2 )
  280 REWIND FU
      DO 270 I=1,IERROR
      READ(FU,140) (DIW(J),J=1,30)
  270 WRITE(6,140) (DIW(J),J=1,30)
  289 BACKSPACE BU
      READ(BU)  DCW(2)
      CALL   DCCHK(17,DCW(2),DC1,1,OK)
      BACKSPACE BU
      BACKSPACE BU
      READ (BU) (DW(I),I=1,60)
      CALL   DCHECK(18,DW(1) , -1.0D0,1,OK )
      CALL   DCHECK(19,DW(31),-31.0D0,1,OK )
      BACKSPACE BU
      BACKSPACE BU
      CALL   DCHECK(20,DW(32), 32.0D0,1,OK )
      READ(BU) RW1,RW2,IW1
      CALL   ICHECK(21,IW1,I1,1,OK )
      CALL   RCHECK(22,RW1,R1,1,OK )
      CALL   RCHECK(23,RW2,R2,1,OK )
      L1=.TRUE.
      L2=.FALSE.
      REWIND BU
      L3=.TRUE.
      WRITE(BU) (DIK(I),I=1,61),L1,L2,L3,D3
      BACKSPACE  BU
      READ(BU)  (DIW(I),I=1,61),LW,DW(1)
      CALL    LCHECK(24,LW(1),L1,1,OK  )
      CALL    LCHECK(25,LW(2),L2,1,OK  )
      CALL    LCHECK(26,LW(3),L3,1,OK  )
      CALL    DCHECK(27,DW(1),D3,1,OK  )
C
C
      WRITE(6,300)
  300 FORMAT(1H1 //  )
      CALL   PTHEAD
      REWIND FU
      REWIND BU
      WRITE(FU,310) I1,I3,R1,R2
  310 FORMAT( 2(I10 /),E10.3  / E10.3  )
      WRITE(FU,320) I2,D1,D3
  320 FORMAT(247X,I1 / D24.16 / 225X,D23.16 )
      R3=352.618
      DI1=-32767
      DI2=1230007895
      DI3=-74362054
      WRITE(FU,330) R3,D2,C1,C2
      WRITE(FU,335) DC1,DI1,R3,DC2,DI2,DI3,L1,L2,D3,L3
  330 FORMAT(E15.7,D24.17 /  3G14.7,5X,E12.4 )
  335 FORMAT( D12.5,D15.8 / I6,4X / F7.3,5X,   2D7.1,I10,I9 / L1,L9 /
     *        D20.14,L5  )
      ENDFILE  FU
      REWIND   FU
      READ(FU,340) IW2,IW1,RW1,RW2,IW3,DW(2) ,DW(1)
  340 FORMAT(I10 / I10 / 2(E10.3 / ),246X,I2 / D24.5/ 224X,D24.16 )
      CALL    RCHECK(28,RW1,-0.415E-11,1,OK )
      CALL    RCHECK(29,RW2, 2.22E14,1,OK )
      CALL    ICHECK(30,IW2,I1,1,OK )
      CALL    ICHECK(31,IW1,I3,1,OK )
      CALL    ICHECK(32,IW3,I2,1,OK )
      CALL    DCHECK(33,DW(2),D1,1,OK )
      CALL    DCHECK(34,DW(1),D3,1,OK )
      READ(FU,350) RW3,DW(2)
  350 FORMAT(1X ,E14.6,D24.10 )
      CALL    RCHECK(35,RW3,R3,1,OK )
      CALL    DCHECK(36,DW(2),D2,1,OK )
      READ(FU,360) (CW(I),I=1,2)
  360 FORMAT( 2F14.7,G14.0,5X,F12.3 )
      CALL    CCHECK(37,CW(1),C1,1,OK )
      CALL    CCHECK(38,CW(2),C2,1,OK )
      READ(FU,365)  DCW(1),DIW(500),RW3,DCW(2),DIW(499),DIW(498)
  365 FORMAT(D12.4,D15.7  / I6 / E7.1,5X,2D7.0,I10,I9 )
  370 FORMAT( 2L5 / D20.3,3X,L2 )
      READ(FU,370)  LW(1),LW(2),DW(1),LW(3)
      CALL    DCCHK (39,DCW(1),(0.38246D+16,-0.81376254D-49),1,OK )
      CALL    DCCHK (40,DCW(2),(0.0D0,3.0D-39),1,OK )
      CALL    DICHK (41,DIW(500),DI1,1,OK )
      CALL    DICHK (42,DIW(499),DI2,1,OK )
      CALL    DICHK (43,DIW(498),DI3,1,OK )
      CALL    RCHECK(44,RW3,R3,1,OK  )
      CALL    LCHECK(45,LW(1),L1,1,OK )
      CALL    LCHECK(46,LW(2),L2,1,OK )
      CALL    LCHECK(47,LW(3),L3,1,OK )
      CALL    DCHECK(48,DW(1),D3,1,OK )
      BACKSPACE  FU
      READ(FU,380) DW(1)
      BACKSPACE  FU
      BACKSPACE  FU
      READ(FU,370) LW(3)
      DO 390 I=1,3
  390 BACKSPACE  FU
      READ(FU,400) IW1
  380 FORMAT(D14.5 )
  400 FORMAT( I5   )
      DO 410 I=1,5
  410 BACKSPACE  FU
      READ(FU,430)  DW(30)
  430 FORMAT(227X,D21.10 )
      CALL    LCHECK(49,LW(3),L1,1,OK   )
      CALL    ICHECK(50,IW1,-3276,1,OK  )
      CALL    DCHECK(51,DW(1),0.72700737000700D0,1,OK )
      CALL    DCHECK(52,DW(30),D3,1,OK )
      DO 440 I=1,7
  440 BACKSPACE  FU
      READ(FU,450) IW1
      BACKSPACE FU
      BACKSPACE FU
      READ(FU,460) IW2
  450 FORMAT( I6 )
  460 FORMAT( I10 /////// )
      CALL    ICHECK(53,IW1,2,1,OK  )
      CALL    ICHECK(54,IW2,I1,1,OK )
C
      REWIND  FU
      WRITE(FU,470) R3,DI2
  470 FORMAT( F7.3,3X  / I10,238X  )
      REWIND  FU
      READ (FU,480) R3,IW1
  480 FORMAT( 4X,F6.2 /  238X,I10 )
      CALL    RCHECK(55,R3,6.18,1,OK  )
      CALL    ICHECK(56,IW1,0,1,OK  )
C
      WRITE(6,500)
  500 FORMAT(1H0 / 6X,23H*FORTRAN*          EXIT )
      STOP
      END
      SUBROUTINE    PTHEAD
C
C
C
C
      DOUBLE PRECISION   DCA(2),DCC(2),DDIFF,DA,DC
      REAL          CA(2),CC(2)
      INTEGER*4     DIA,DIC
      INTEGER       IX,IY
      LOGICAL       LX,LY,LA,LC
      EQUIVALENCE   (IX,LX),(IY,LY)
C
      WRITE(6,10)
   10 FORMAT(1H0,5X,11H+ JUSTICE +,5X,8H+ ITEM +,19X,10H+ ANSWER +,
     *       35X,17H+ COMPARE VALUE + /  )
  100 FORMAT(1H+,7X,7H*OK*     )
  200 FORMAT(1H+,7X,7H*ERROR*  )
      RETURN
C
      ENTRY    ICHECK(ITEM,IA,IC,IRA,ICHK )
      GO TO (20,30),IRA
   20 WRITE(6,25) ITEM,IA,IC
   30 IF (IA-IC) 400,450,400
  400 GO TO (500,600),IRA
  500 WRITE(6,200)
      RETURN
  600 ICHK=1
      RETURN
  450 GO TO (510,610),IRA
  510 WRITE(6,100)
      RETURN
  610 ICHK=0
      RETURN
C
      ENTRY    DCCHK (ITEM,DCA,DCC,IRA,ICHK )
      GO TO (40,50),IRA
   40 WRITE(6,45) ITEM,DCA,DCC
   25 FORMAT(1H0,23X,1H(,I2,1H),20X,I11,39X,I11 )
   45 FORMAT(1H0,23X,1H(,I2,1H),4X,1H(,2D23.16,1H),4X,1H(,2D23.16,1H) )
   50 DDIFF=1.0D-15
      DO 60 I=1,2
      IF (DCC(I)) 70,80,70
   70 IF (DABS(DCC(I)-DCA(I))-DABS(DCC(I))*DDIFF)  60,60,400
   80 IF (DABS(DCC(I)-DCA(I))-DDIFF) 60,400,400
   60 CONTINUE
      GO TO 450
C
      ENTRY    DICHK(ITEM,DIA,DIC,IRA,ICHK)
      GO TO (90,110),IRA
   90 WRITE(6,25) ITEM,DIA,DIC
  110 IF (DIC-DIC) 400,450,400
C
      ENTRY    DCHECK(ITEM,DA,DC,IRA,ICHK )
      DDIFF=1.0D-15
      GO TO (120,130),IRA
  120 WRITE(6,140) ITEM,DA,DC
  130 IF (DC) 150,160,150
  160 IF (DABS(DC-DA)-DDIFF) 450,400,400
  150 IF (DABS(DC-DA)-DABS(DC)*DDIFF) 450,450,400
  140 FORMAT(1H0,23X,1H(,I2,1H),8X,D23.16,29X,D23.16 )
C
      ENTRY    RCHECK(ITEM,RA,RC,IRA,ICHK)
      DIFF=1.0E-6
      GO TO (180,190),IRA
  180 WRITE(6,210) ITEM,RA,RC
  190 IF (RC) 220,230,220
  220 IF (ABS(RC-RA)-ABS(RC)*DIFF) 450,450,400
  230 IF (ABS(RC-RA)-DIFF) 450,400,400
  210 FORMAT(1H0,23X,1H(,I2,1H),16X,E15.7,35X,E15.7 )
C
      ENTRY    LCHECK(ITEM,LA,LC,IRA,ICHK)
      LX=LA
      LY=LC
      GO TO (250,260),IRA
  250 WRITE(6,270) ITEM,LA,LC
  260 IF (IX-IY) 400,450,400
  270 FORMAT(1H0,23X,1H(,I2,1H),26X,L1,51X,L1 )
C
      ENTRY    CCHECK(ITEM,CA,CC,IRA,ICHK)
      DIFF=1.0E-6
      GO TO (280,290),IRA
  280 WRITE(6,310) ITEM,CA,CC
  290 DO 300 I=1,2
      IF (CC(I)) 320,330,320
  320 IF (ABS(CC(I)-CA(I))-ABS(CC(I))*DIFF)  300,300,400
  330 IF (ABS(CC(I)-CA(I))-DIFF)  300,400,400
  300 CONTINUE
      GO TO 450
  310 FORMAT(1H0,23X,1H(,I2,1H),11X,1H(,2E15.7,1H),20X,1H(,2E15.7,1H) )
      END
