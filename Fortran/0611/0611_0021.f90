MODULE m1
TYPE t1
  INTEGER,ALLOCATABLE:: x11
  CONTAINS
    PROCEDURE:: t_prc=>prc
    GENERIC:: ASSIGNMENT(=) => t_prc
END TYPE
CONTAINS
SUBROUTINE   prc(x,y)
  CLASS(t1),INTENT(OUT)::x
  CLASS(t1),INTENT(IN)::y
  ALLOCATE(x%x11)
  x%x11 = y%x11+100
END SUBROUTINE
END MODULE



MODULE m2
USE m1
TYPE t2
  INTEGER:: x21
  TYPE(t1):: x22
END TYPE
END MODULE
 


PROGRAM MAIN
USE m2
TYPE(t2):: v21,v22
v21%x21=11
ALLOCATE(v21%x22%x11)
v21%x22%x11=12
CALL s1(v21,v22)
IF (v22%x21 .EQ. 11)PRINT *,'pass1/2'
IF (v22%x22%x11 .EQ. 112)PRINT *,'pass2/2'
CONTAINS
SUBROUTINE s1(dmy1,dmy2)
  TYPE(t2):: dmy1,dmy2
  dmy2=dmy1
END SUBROUTINE
END
