MODULE m1
TYPE t1
  INTEGER,POINTER:: x11(:,:,:)
  CONTAINS
    PROCEDURE:: t_prc=>prc
    GENERIC:: ASSIGNMENT(=) => t_prc
END TYPE
CONTAINS
SUBROUTINE   prc(x,y)
  CLASS(t1),INTENT(OUT)::x
  CLASS(t1),INTENT(IN)::y
  x%x11 = y%x11+100
END SUBROUTINE
END MODULE



MODULE m2
USE m1
TYPE t2
  INTEGER:: x21
  TYPE(t1):: x22
END TYPE
END MODULE
 


PROGRAM MAIN
USE m2
TYPE(t2),POINTER:: v21(:),v22(:)
ALLOCATE(v21(4),v22(4))
v21(1)%x21=11
v21(2)%x21=12
ALLOCATE(v21(1)%x22%x11(2,1,3))
ALLOCATE(v21(2)%x22%x11(2,1,3))
v21(1)%x22%x11(1,1,1)=1
v21(1)%x22%x11(1,1,2)=2
v21(1)%x22%x11(1,1,3)=3
v21(1)%x22%x11(2,1,1)=4
v21(1)%x22%x11(2,1,2)=5
v21(1)%x22%x11(2,1,3)=6
v21(2)%x22%x11(1,1,1)=10
v21(2)%x22%x11(1,1,2)=20
v21(2)%x22%x11(1,1,3)=30
v21(2)%x22%x11(2,1,1)=40
v21(2)%x22%x11(2,1,2)=50
v21(2)%x22%x11(2,1,3)=60
CALL s1(v21,v22)
IF (v22(4)%x21 .EQ. 12)PRINT *,'pass1/3'
IF (v22(3)%x22%x11(1,1,3) .EQ. 103)PRINT *,'pass2/3'
IF (v22(4)%x22%x11(1,1,3) .EQ. 130)PRINT *,'pass3/3'
CONTAINS
SUBROUTINE s1(dmy1,dmy2)
  TYPE(t2),POINTER:: dmy1(:),dmy2(:)
  dmy2(3:4)=dmy1(1:2)
END SUBROUTINE
END
