MODULE MOD_A
  IMPLICIT NONE
  INTEGER, PARAMETER, PRIVATE :: String_Length = 100
  CHARACTER(LEN=String_Length) :: String
!$OMP THREADPRIVATE (String)
  REAL :: Var_A
END MODULE MOD_A

MODULE MOD_B
  USE MOD_A, ONLY: Var_A, String
  IMPLICIT NONE
  private
  public   String
END MODULE MOD_B

MODULE SUB_WRAPPER

  USE MOD_B
  USE MOD_A

  IMPLICIT NONE

CONTAINS

SUBROUTINE SUB

  IMPLICIT NONE

  Var_A = 100.0
  String = 'Hello'
  
  WRITE(1,*) 'Var_A ',Var_A
  WRITE(1,*) TRIM(String)

  RETURN

END SUBROUTINE SUB

END MODULE SUB_WRAPPER
PROGRAM MAIN

USE SUB_WRAPPER

IMPLICIT NONE

CALL Sub
if (Var_A/=100) print *,202
if (String/='Hello') print *,303

print *,'pass'
END
