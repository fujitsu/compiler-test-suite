      REAL*8 A1(20), B1(20), C1(20)
      REAL*8 A2(20,20), B2(20,20), C2(20,20)
      REAL*8 A3(20,20,20), B3(20,20,20), C3(20,20,20)
      INTEGER*4 L(20)
      INTEGER NN
      PARAMETER (NN = 16)
      DATA A1/20*1.D0/ 
      DATA B1/20*2.D0/ 
      DATA C1/20*3.D0/ 
      DATA A2/400*2.1D0/ 
      DATA B2/400*1.2D0/ 
      DATA C2/400*4.D0/ 
      DATA A3/8000*0.2D0/ 
      DATA B3/8000*0.1D0/ 
      DATA C3/8000*0.3D0/ 
      INTEGER J1, K1, I1
      DOUBLE PRECISION DD1
      DO I1=1,17,4
       L(I1) = 21 - I1
       L(I1+1) = 20 - I1
       L(I1+2) = 19 - I1
       L(I1+3) = 18 - I1
      END DO
      DO J1=2,13,4

       DO K1=2,12,5
        A2(K1,J1) = B2(K1,J1) * 2.
        A2(K1+1,J1) = B2(K1+1,J1) * 2.
        A2(K1+2,J1) = B2(K1+2,J1) * 2.
        A2(K1+3,J1) = B2(K1+3,J1) * 2.
        A2(K1+4,J1) = B2(K1+4,J1) * 2.
        A2(K1,J1+1) = B2(K1,J1+1) * 2.
        A2(K1+1,J1+1) = B2(K1+1,J1+1) * 2.
        A2(K1+2,J1+1) = B2(K1+2,J1+1) * 2.
        A2(K1+3,J1+1) = B2(K1+3,J1+1) * 2.
        A2(K1+4,J1+1) = B2(K1+4,J1+1) * 2.
        A2(K1,J1+2) = B2(K1,J1+2) * 2.
        A2(K1+1,J1+2) = B2(K1+1,J1+2) * 2.
        A2(K1+2,J1+2) = B2(K1+2,J1+2) * 2.
        A2(K1+3,J1+2) = B2(K1+3,J1+2) * 2.
        A2(K1+4,J1+2) = B2(K1+4,J1+2) * 2.
        A2(K1,J1+3) = B2(K1,J1+3) * 2.
        A2(K1+1,J1+3) = B2(K1+1,J1+3) * 2.
        A2(K1+2,J1+3) = B2(K1+2,J1+3) * 2.
        A2(K1+3,J1+3) = B2(K1+3,J1+3) * 2.
        A2(K1+4,J1+3) = B2(K1+4,J1+3) * 2.
       END DO
      END DO
      DO J1=14,16,1

       DO K1=2,12,5
        A2(K1,J1) = B2(K1,J1) * 2.
        A2(K1+1,J1) = B2(K1+1,J1) * 2.
        A2(K1+2,J1) = B2(K1+2,J1) * 2.
        A2(K1+3,J1) = B2(K1+3,J1) * 2.
        A2(K1+4,J1) = B2(K1+4,J1) * 2.
       END DO
      END DO

      DO K1=2,16
       DO J1=2,16
        DO I1=2,12,5
         A3(K1,J1,I1) = A3(I1,J1,K1) + B3(K1,I1,J1) * C3(K1,J1,I1)
         A3(K1,J1,I1+1) = A3(I1+1,J1,K1) + B3(K1,I1+1,J1) * C3(K1,J1,I1+
     X     1)
         A3(K1,J1,I1+2) = A3(I1+2,J1,K1) + B3(K1,I1+2,J1) * C3(K1,J1,I1+
     X     2)
         A3(K1,J1,I1+3) = A3(I1+3,J1,K1) + B3(K1,I1+3,J1) * C3(K1,J1,I1+
     X     3)
         A3(K1,J1,I1+4) = A3(I1+4,J1,K1) + B3(K1,I1+4,J1) * C3(K1,J1,I1+
     X     4)
        END DO
        B3(J1,2,K1) = A2(K1,J1) - C2(J1,K1) + A1(J1)
       END DO
       A1(L(K1)) = B1(K1) + C1(K1)
      END DO

      DO K1=2,16
       B1(L(K1)) = FLOAT (K1)
       DD1 = A1(K1)
       DO J1=2,12,5
        C2(K1,J1) = B2(K1,J1) * 2. + B1(J1)
        A3(J1,2,K1) = A2(K1,J1) - C2(J1,K1) * DD1
        C2(K1,J1+1) = B2(K1,J1+1) * 2. + B1(J1+1)
        A3(J1+1,2,K1) = A2(K1,J1+1) - C2(J1+1,K1) * DD1
        C2(K1,J1+2) = B2(K1,J1+2) * 2. + B1(J1+2)
        A3(J1+2,2,K1) = A2(K1,J1+2) - C2(J1+2,K1) * DD1
        C2(K1,J1+3) = B2(K1,J1+3) * 2. + B1(J1+3)
        A3(J1+3,2,K1) = A2(K1,J1+3) - C2(J1+3,K1) * DD1
        C2(K1,J1+4) = B2(K1,J1+4) * 2. + B1(J1+4)
        A3(J1+4,2,K1) = A2(K1,J1+4) - C2(J1+4,K1) * DD1
       END DO
       A1(K1) = B1(K1) + C1(K1)
      END DO
      K = 17

      WRITE (6, *) ' A1= ', A1
      WRITE (6, *) ' A2= ', ((A2(I,J), I=1,15), J=1,15)
      WRITE (6, *) ' A3= ', (((A3(I,J,K), I=1,10), J=1,10), K=1,10)
      STOP 
      END
