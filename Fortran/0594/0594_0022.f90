MODULE M1
  TYPE TY
   INTEGER :: JJ
   INTEGER,ALLOCATABLE :: ALC
  END TYPE
  TYPE TY1
   INTEGER :: II
   TYPE(TY), ALLOCATABLE :: NODE2
  END TYPE
 END MODULE

 SUBROUTINE S1(AAA)
  USE M1
  TYPE(TY1),INTENT(IN) :: AAA
 interface
   FUNCTION FUN2(D1,D2)
   import TY1
   INTEGER::FUN2
   integer,optional::D1
   TYPE(TY1) :: D2
   END
 end interface
 
 PROCEDURE(FUN2)::FUN
 II1= FUN(D2=TY1(6,AAA%NODE2))
 if(II1 /= 6) print*,101
 print*,"PASS"
 END



 FUNCTION FUN(D1,D2)
 USE M1
 INTEGER::FUN
 integer,optional::D1
 TYPE(TY1) :: D2
 FUN=D2%II
 END

 FUNCTION FUN2(D1,D2)
 USE M1
 INTEGER::FUN2
 integer,optional::D1
 TYPE(TY1) :: D2
 FUN2=D2%II
 END

 USE M1
 INTERFACE
 SUBROUTINE S1(AAA)
 USE M1
  TYPE(TY1),INTENT(IN) :: AAA
 END
 END INTERFACE
 TYPE(TY1):: ACT
 ALLOCATE(ACT%NODE2)
 ACT%II =6
 CALL S1(ACT)
END
