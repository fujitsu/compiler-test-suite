MODULE M
  TYPE TY
    INTEGER :: X=9
     REAL :: Y=8
  CONTAINS
    PROCEDURE :: WFORM
     GENERIC :: WRITE(FORMATTED) => WFORM
  END TYPE
  INTEGER::A
CONTAINS
    SUBROUTINE WFORM(DTV, UNIT,IOTYPE,V_LIST, IOSTAT, IOMSG)
     CLASS(TY), INTENT(IN)            :: DTV
    INTEGER, INTENT(IN)            :: UNIT
    CHARACTER(LEN=*), INTENT(IN)    :: IOTYPE
    INTEGER, INTENT(IN)             :: V_LIST (:)
    INTEGER, INTENT(OUT)            :: IOSTAT
    CHARACTER(LEN=*), INTENT(INOUT) :: IOMSG 
      A=DTV%X+1
    IF(SIZE(V_LIST)/=0) THEN
        WRITE(UNIT,*,IOSTAT=IOSTAT,IOMSG=IOMSG)V_LIST(1),IOTYPE,DTV%X+1
      ELSE
        WRITE(UNIT,*,IOSTAT=IOSTAT,IOMSG=IOMSG)DTV%X+1,IOTYPE
      END IF 
    END SUBROUTINE
END MODULE
PROGRAM MAIN
  USE M

  INTERFACE
  FUNCTION FUN(D)
  IMPORT TY
  TYPE (TY) :: D,FUN
  END FUNCTION
  END INTERFACE

  TYPE (TY) :: T1
  CALL SS(FUN)

  CONTAINS

  SUBROUTINE SS(DFUN)
  INTERFACE
  FUNCTION DFUN(DD)
  IMPORT TY
  TYPE (TY) :: DD,DFUN
  END FUNCTION
  END INTERFACE
  OPEN(UNIT =70,FILE='fort.53',FORM='FORMATTED')
  

  WRITE(UNIT=70,FMT="(DT'LINKLIST'(10))")DFUN(T1)
  
CLOSE(UNIT=70,status='delete')
    IF(A==20)PRINT*,'PASS'
    END SUBROUTINE
END PROGRAM

 FUNCTION FUN(D)
  USE M
  TYPE (TY) :: D,FUN
  FUN=D
  FUN%X = FUN%X+10
  FUN%Y = FUN%Y+10
 END FUNCTION

