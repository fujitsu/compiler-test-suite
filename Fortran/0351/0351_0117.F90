program main

  use, intrinsic :: ieee_arithmetic

  real(kind=4),dimension(1:196) :: a,b,c,res
  call init(b,c,res)
  do i=1,2
     call test(a,b,c)
  enddo
  do i=1,196
    select case(i)
    case (10)
       if (((abs(a(i) -  res(i))/abs(a(i))) .gt. 1.0e-5_4)) then
           print *, "NG"
       endif
    case (11,31,44,46)
       if (((abs(a(i) -  res(i))/abs(a(i))) .gt. 1.0e-6_4)) then
           print *, "NG"
       endif
    case (85:)
       if (((a(i) .ne.  res(i)) .and. .not.(ieee_is_nan(a(i)) .and. ieee_is_nan( res(i))))) then
           print *, "NG"
       endif
    case default
       if (((abs(a(i) -  res(i))/abs(a(i))) .gt. 1.0e-6_4)) then
           print *, "NG"
       endif
    end select
  enddo
  print *, "OK"
end program main

subroutine init(b, c, res)
  real(kind=4),dimension(1:196) :: b, c, res
  real(kind=4),parameter :: pzero=z'0'
  real(kind=4),parameter :: mzero=z'80000000'
  real(kind=4),parameter :: pinf =z'7f800000'
  real(kind=4),parameter :: minf =z'ff800000'
  real(kind=4),parameter :: pnan =z'7fc00000'
  real(kind=4),parameter :: mnan =z'ffc00000'


  
  b(1) =   1.01_4; c(1) =               1.0_4; res(1) =                      1.009999990e+00_4;
  b(2) =   2.0_4; c(2) =                1.0_4; res(2) =                      2.000000000e+00_4;
  b(3) =   2.0_4; c(3) =                2.0_4; res(3) =                      4.000000000e+00_4;
  b(4) =   0.1_4; c(4) =                1.1_4; res(4) =                      7.943282276e-02_4;
  b(5) =   2.1_4; c(5) =                1.1_4; res(5) =                      2.261732340e+00_4;
  b(6) =   2.1_4; c(6) =                100.1_4; res(6) =                    1.795349235e+32_4;
  b(7) =   100.1_4; c(7) =              10.1_4; res(7) =                     1.600976187e+20_4;
  b(8) =   1.1e30_4; c(8) =             1.000001_4; res(8) =                 1.100072552e+30_4;
  b(9) =   1.1e10_4; c(9) =             3.001_4; res(9) =                    1.362130722e+30_4;
  b(10) =  1.1e1_4; c(10) =              29.888_4; res(10) =                   1.333966951e+31_4;
  b(11) =  1.1234e2_4; c(11) =           12.3456_4; res(11) =                  2.065750565e+25_4;
  b(12) =  1.1e-10_4; c(12) =           -3.228_4; res(12) =                    1.400824224e+32_4;
  b(13) =  1.1e-10_4; c(13) =           -3.001_4; res(13) =                    7.687405904e+29_4;
  b(14) =  1.1e-30_4; c(14) =           -1.00001_4; res(14) =                  9.097190971e+29_4;
  b(15) =  1.1_4; c(15) =                7272.54_4; res(15) =                               pinf;
  b(16) =  1.00001_4; c(16) =            6.2e17_4; res(16) =                                pinf;
  b(17) =  1.00001_4; c(17) =            100.1_4; res(17) =                    1.001002908e+00_4;
  b(18) =  1.1e30_4; c(18) =             1.000001_4; res(18) =                 1.100072552e+30_4;
						              
  		              
  b(19) =  1.1_4; c(19) =                1.1_4; res(19) =                      1.110534310e+00_4;
  b(20) =  0.0_4; c(20) =                1.1_4; res(20) =                      0.000000000e+00_4;
  b(21) =  -1.1_4; c(21) =               1.1_4; res(21) =                                   pnan;
						              
  	              
  b(22) =  1.1_4; c(22) =                2.0_4; res(22) =                      1.210000038e+00_4;
  b(23) =  0.0_4; c(23) =                2.0_4; res(23) =                      0.000000000e+00_4;
  b(24) =  -1.1_4; c(24) =               2.0_4; res(24) =                      1.210000038e+00_4;
			          		              
  	              
  b(25) =  1.1_4; c(25) =                3.0_4; res(25) =                      1.331000090e+00_4;
  b(26) =  0.0_4; c(26) =                3.0_4; res(26) =                      0.000000000e+00_4;
  b(27) =  -1.1_4; c(27) =               3.0_4; res(27) =                     -1.331000090e+00_4;
			          		              
     		              
  b(28) =  1.1_4; c(28) =                0.0_4; res(28) =                      1.000000000e+00_4;
  b(29) =  0.0_4; c(29) =                0.0_4; res(29) =                      1.000000000e+00_4;
  b(30) =  -1.1_4; c(30) =               0.0_4; res(30) =                      1.000000000e+00_4;
			          		              
  		              
  b(31) =  1.1_4; c(31) =               -1.1_4; res(31) =                      9.004674554e-01_4;
  
  b(32) =  0.0_4; c(32) =               -1.1_4; res(32) =                                   pinf;
  b(33) =  -1.1_4; c(33) =              -1.1_4; res(33) =                                   pnan;
			          		              
  	              
  b(34) =  1.1_4; c(34) =               -2.0_4; res(34) =                      8.264462352e-01_4;
  b(35) =  0.0_4; c(35) =               -2.0_4; res(35) =                                   pinf;
  b(36) =  -1.1_4; c(36) =              -2.0_4; res(36) =                      8.264462352e-01_4;
			          		              
  	              
  b(37) =  1.1_4; c(37) =               -3.0_4; res(37) =                      7.513147593e-01_4;
  b(38) =  0.0_4; c(38) =               -3.0_4; res(38) =                                   pinf;
  b(39) =  -1.1_4; c(39) =              -3.0_4; res(39) =                     -7.513147593e-01_4;
			          			      
  		      
  b(40) =  -2.1_4; c(40) =               1._4; res(40) =                      -2.099999905e+00_4;
  b(41) =  -2.1_4; c(41) =               2._4; res(41) =                       4.409999371e+00_4;
  b(42) =  -2.1_4; c(42) =               50._4; res(42) =                      1.291111515e+16_4;
  b(43) =  -2.1_4; c(43) =               51._4; res(43) =                     -2.711334041e+16_4;
  b(44) =  -2.1_4; c(44) =              -1._4; res(44) =                      -4.761904776e-01_4;
  b(45) =  -2.1_4; c(45) =              -2._4; res(45) =                       2.267573923e-01_4;
  b(46) =  -2.1_4; c(46) =              -50._4; res(46) =                      7.745264637e-17_4;
  b(47) =  -2.1_4; c(47) =              -51._4; res(47) =                     -3.688221335e-17_4;
  b(48) =  -1.0_4; c(48) =               9007199254740992.-1_4; res(48) =      1.000000000e+00_4;
  b(49) =  -1.0_4; c(49) =              -9007199254740992.+1_4; res(49) =      1.000000000e+00_4;
  b(50) =  -1.0_4; c(50) =               9007199254740992._4; res(50) =        1.000000000e+00_4;
  b(51) =  -1.0_4; c(51) =              -9007199254740992._4; res(51) =        1.000000000e+00_4;
  b(52) =  -1.0_4; c(52) =               9007199254740992.*2_4; res(52) =      1.000000000e+00_4;
  b(53) =  -1.0_4; c(53) =              -9007199254740992.*2_4; res(53) =      1.000000000e+00_4;
  b(54) =  -1.0_4; c(54) =               1e20_4; res(54) =                     1.000000000e+00_4;
  b(55) =  -1.0_4; c(55) =              -1e20_4; res(55) =                     1.000000000e+00_4;
			          
  b(56) =  -1.0_4; c(56) =               9007199254740992./2-1.5_4; res(56) =  1.000000000e+00_4;
  b(57) =  -1.0_4; c(57) =              -9007199254740992./2+1.5_4; res(57) =  1.000000000e+00_4;
			          
  b(58) =  -1.0_4; c(58) =               9007199254740992./2_4; res(58) =      1.000000000e+00_4;
  b(59) =  -1.0_4; c(59) =              -9007199254740992./2_4; res(59) =      1.000000000e+00_4;
			          			       
  b(60) =  +1.1_4; c(60) =               1.e38_4; res(60) =                                 pinf;
  b(61) =  -1.1_4; c(61) =               1.e38_4; res(61) =                                 minf;
  b(62) =  -1.1_4; c(62) =               2.0_4; res(62) =                      1.210000038e+00_4;
  b(63) =  -1.1_4; c(63) =               1e10_4; res(63) =                                  minf;
  b(64) =  -1.1_4; c(64) =               1e20_4; res(64) =                                  minf;
  b(65) =  -1.1_4; c(65) =               1e30_4; res(65) =                                  minf;

  b(66) =  -1.00000000000001_4; c(66) =  9007199254740992.*2_4; res(66) =      1.000000000e+00_4;
  b(67) =  -1.00000000000001_4; c(67) =  1e19_4; res(67) =                     1.000000000e+00_4;
  b(68) =  -1.00000000000001_4; c(68) =  1e20_4; res(68) =                     1.000000000e+00_4;
  b(69) =   1.001_4; c(69) =             1.0_4; res(69) =                      1.001000047e+00_4;

  
  
  b(70) =   1.0_4; c(70) =      0.0_4; res(70) =      1.0_4;
  b(71) =   1.0_4; c(71) =      0.0_4; res(71) =      1.0_4;
  b(72) =   1.0_4; c(72) =      0.0_4; res(72) =      1.0_4;
  b(73) =   1.0_4; c(73) =      0.0_4; res(73) =      1.0_4;
  b(74) =   1.0_4; c(74) =      0.0_4; res(74) =      1.0_4;
  b(75) =   1.0_4; c(75) =      0.0_4; res(75) =      1.0_4;
  b(76) =   1.0_4; c(76) =      0.0_4; res(76) =      1.0_4;
  b(77) =   1.0_4; c(77) =      0.0_4; res(77) =      1.0_4;
  b(78) =   1.0_4; c(78) =      0.0_4; res(78) =      1.0_4;
  b(79) =   1.0_4; c(79) =      0.0_4; res(79) =      1.0_4;
  b(80) =   1.0_4; c(80) =      0.0_4; res(80) =      1.0_4;
  b(81) =   1.0_4; c(81) =      0.0_4; res(81) =      1.0_4;
  b(82) =   1.0_4; c(82) =      0.0_4; res(82) =      1.0_4;
  b(83) =   1.0_4; c(83) =      0.0_4; res(83) =      1.0_4;
  b(84) =   1.0_4; c(84) =      0.0_4; res(84) =      1.0_4;

  
  b(85) =   pzero; c(85) =      -3.0_4; res(85) =      pinf;







  b(86) =   1.0_4; c(86) =      0.0_4; res(86) =      1.0_4;

  b(87) =   pzero; c(87) =      -4.0_4; res(87) =      pinf;
  b(88) =   mzero; c(88) =      -4.0_4; res(88) =      pinf;
  b(89) =   pzero; c(89) =      5.0_4; res(89) =      pzero;
  b(90) =   mzero; c(90) =      5.0_4; res(90) =      mzero;
  b(91) =   pzero; c(91) =      6.0_4; res(91) =      pzero;
  b(92) =   mzero; c(92) =      6.0_4; res(92) =      pzero;

  b(93) =   1.0_4; c(93) =      0.0_4; res(93) =      1.0_4;
  b(94) =   1.0_4; c(94) =      0.0_4; res(94) =      1.0_4;

  b(95) =   1.0_4; c(95) =      -1.0_4; res(95) =     1.0_4;
  b(96) =   1.0_4; c(96) =      10.2_4; res(96) =     1.0_4;

  b(97) =   1.0_4; c(97) =      0.0_4; res(97) =      1.0_4;
  b(98) =   1.0_4; c(98) =      0.0_4; res(98) =      1.0_4;

  b(99) =   1.0_4; c(99) =      0.0_4; res(99) =      1.0_4;

  b(100) =   1.0_4; c(100) =     0.0_4; res(100) =      1.0_4;

  b(101) =   2.1_4; c(101) =      pzero; res(101) =  	  1.0_4;
  b(102) =   -4.3_4; c(102) =     pzero; res(102) =  	  1.0_4;
  b(103) =   pzero; c(103) =      pzero; res(103) =     1.0_4;
  b(104) =   mzero; c(104) =      pzero; res(104) =     1.0_4;
  b(105) =    pinf; c(105) =      pzero; res(105) =  	  1.0_4;
  b(106) =    minf; c(106) =      pzero; res(106) =  	  1.0_4;
  b(107) =    pnan; c(107) =      pzero; res(107) =  	  1.0_4;
  b(108) =    mnan; c(108) =      pzero; res(108) =  	  1.0_4;
  b(109) =   2.1_4; c(109) =      mzero; res(109) =  	  1.0_4;
  b(110) =   -4.3_4; c(110) =     mzero; res(110) =  	  1.0_4;
  b(111) =   pzero; c(111) =      mzero; res(111) =  	  1.0_4;
  b(112) =   mzero; c(112) =      mzero; res(112) =  	  1.0_4;
  b(113) =   pinf; c(113) =       mzero; res(113) =  	  1.0_4;
  b(114) =   minf; c(114) =       mzero; res(114) =  	  1.0_4;
  b(115) =   pnan; c(115) =       mzero; res(115) =  	  1.0_4;
  b(116) =   mnan; c(116) =       mzero; res(116) =  	  1.0_4;






  b(117) =   -1.0_4; c(117) =     2.1_4; res(117) =       pnan;
  b(118) =   -1.1_4; c(118) =     -1000.1_4; res(118) =   pnan;
  b(119) =   -1000.0_4; c(119) =  -4.3_4; res(119) =      pnan;

  b(128) =  minf; c(128) =       -7.0_4; res(128) =      mzero;
  b(129) =  minf; c(129) =       -8.0_4; res(129) =      pzero;

  b(120) =  1.0_4; c(120) =      0.0_4; res(120) =       1.0_4;
  b(121) =  1.0_4; c(121) =      0.0_4; res(121) =       1.0_4;
  b(122) =  1.0_4; c(122) =      0.0_4; res(122) =       1.0_4;
  b(123) =  1.0_4; c(123) =      0.0_4; res(123) =       1.0_4;
  b(124) =  1.0_4; c(124) =      0.0_4; res(124) =       1.0_4;
  b(125) =  1.0_4; c(125) =      0.0_4; res(125) =       1.0_4;
  b(126) =  1.0_4; c(126) =      0.0_4; res(126) =       1.0_4;
  b(127) =  1.0_4; c(127) =      0.0_4; res(127) =       1.0_4;

  b(128) =  minf; c(128) =       -7.0_4; res(128) =      mzero;
  b(129) =  minf; c(129) =       -8.0_4; res(129) =      pzero;



  b(130) =  1.0_4; c(130) =      0.0_4; res(130) =       1.0_4;


  b(131) =  minf; c(131) =       10.0_4; res(131) =       pinf;







  b(132) =  1.0_4; c(132) =      0.0_4; res(132) =       1.0_4;

  b(133) =  pinf; c(133) =       -1.0_4; res(133) =      pzero;
  b(134) =  pinf; c(134) =       -1000.9_4; res(134) =   pzero;







  b(135) =  1.0_4; c(135) =      0.0_4; res(135) =       1.0_4;

  b(136) =  pinf; c(136) =       1.0_4; res(136) =        pinf;
  b(137) =  pinf; c(137) =       1000.9_4; res(137) =     pinf;
  


  do i=138,196
     b(i) = 1._4
     c(i) = 1._4
     res(i) = 1._4
  enddo
end subroutine init


subroutine test(a,b,c)
  real(kind=4), dimension(1:196) :: a,b,c

  do i=1,196
     a(i) = b(i)**c(i)
  enddo
end subroutine test
