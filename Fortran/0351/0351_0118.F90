program main

  use, intrinsic :: ieee_arithmetic

  real(kind=8),dimension(1:196) :: a,b,c,res
  call init(b,c,res)
  do i=1,2
     call test(a,b,c)
  enddo
  do i=1,196
    select case(i)
    case (7,8,11,13,43,44,47,48)
       if (((abs(a(i) -  res(i))/abs(a(i))) .gt. 1.0D-14)) then
          print *, "NG"
       endif
    case (12)
       if (((abs(a(i) -  res(i))/abs(a(i))) .gt. 1.0D-13)) then
          print *, "NG"
       endif
    case (16,17,67)
       if (((abs(a(i) -  res(i))/abs(a(i))) .gt. 1.0D-12)) then
          print *, "NG"
       endif
    case (85:)
       if (((a(i) .ne.  res(i)) .and. .not.(ieee_is_nan(a(i)) .and. ieee_is_nan( res(i))))) then
          print *, "NG"
       endif
    case default
       if (((abs(a(i) -  res(i))/abs(a(i))) .gt. 1.0D-15)) then
          print *, "NG"
       endif
    end select
  enddo
  print *, "OK"
end program main

subroutine init(b, c, res)
  real(kind=8),dimension(1:196) :: b, c, res
  real(kind=8),parameter :: pzero=z'0'
  real(kind=8),parameter :: mzero=z'8000000000000000'
  real(kind=8),parameter :: pinf=z'7ff0000000000000'
  real(kind=8),parameter :: minf=z'fff0000000000000'
  real(kind=8),parameter :: pnan=z'7ff8000000000000'
  real(kind=8),parameter :: mnan=z'fff8000000000000'


  
  b(1) =   1.001_8; c(1) = 	      	1.0_8; res(1) =    	    		 1.00099999999999989D+0;
  b(2) =   1.01_8; c(2) =      	      	1.0_8; res(2) =    	    		 1.01000000000000001D+0;
  b(3) =   2.0_8; c(3) =       	      	1.0_8; res(3) =    	    		 2.00000000000000000D+0;
  b(4) =   2.0_8; c(4) =       	      	2.0_8; res(4) =    	    		 4.00000000000000000D+0;
  b(5) =   0.1_8; c(5) =       	      	1.1_8; res(5) =    	    		 7.94328234724281379D-2;
  b(6) =   2.1_8; c(6) =       	      	1.1_8; res(6) =    	    		 2.26173242463916280D+0;
  b(7) =   2.1_8; c(7) =       	      	100.1_8; res(7) =  	    		 1.79535941231914077D+32;
  b(8) =   100.1_8; c(8) =     	      	10.1_8; res(8) =   	    		 1.60097364447227871D+20;
  b(9) =   1.1D+300; c(9) =   	      	1.000001_8; res(9) =  	    		 1.10076022049867194D+300;
  b(10) =   1.1D+100; c(10) =   	      	3.001_8; res(10) =     	    		 1.67578943527916565D+300;
  b(11) =  1.1D+10; c(11) =    	      	29.888_8; res(11) =    	    		 1.30961781430034723D+300;
  b(12) =  1.1234D+2; c(12) =  	      	123.456_8; res(12) =   	    		 1.41506796317377440D+253;
  b(13) =  1.1D-10; c(13) =   	      	-30.228_8; res(13) =   	    		 1.06851817334168471D+301;
  b(14) =  1.1D-100; c(14) =  	      	-3.001_8; res(14) =    	    		 9.45759150341588108D+299;
  b(15) =  1.1D-300; c(15) =  	      	-1.00001_8; res(15) =  	    		 9.15391553767202741D+299;
  b(16) =  1.1_8; c(16) =                7272.54_8; res(16) =   	    		 1.07141696947417245D+301;
  b(17) =  1.000000000000001_8; c(17) =  6.2D+17; res(17) =    	    		 8.74006437648668332D+298;
  b(18) =  1.000000000000001_8; c(18) =  100.1_8; res(18) =     	    		 1.00000000000011124D+0;
  b(19) =  1.1D+300; c(19) = 	      	1.000001_8; res(19) =  	    		 1.10076022049867194D+300;
  b(20) =  1.1_8; c(20) =     	      	1.1_8; res(20) =       	    		 1.11053424105457577D+0;
  b(21) =  0.0_8; c(21) =     	      	1.1_8; res(21) =       	    		 0.00000000000000000D+0;
  b(22) =  -1.1_8; c(22) =    	        1.1; res(22) =       	    		 pnan;
  b(23) =  1.1_8; c(23) =     	      	2.0_8; res(23) =       	    		 1.21000000000000019D+00;
  b(24) =  0.0_8; c(24) =     	      	2.0_8; res(24) =       	    		 0.00000000000000000D+00;
  b(25) =  -1.1_8; c(25) =    	      	2.0_8; res(25) =       	    		 1.21000000000000019D+00;
  b(26) =  1.1_8; c(26) =     	      	3.0_8; res(26) =       	    		 1.33100000000000041D+00;
  b(27) =  0.0_8; c(27) =     	      	3.0_8; res(27) =       	    		 0.00000000000000000D+00;
  b(28) =  -1.1_8; c(28) =    	      	3.0_8; res(28) =       	    		 -1.33100000000000041D+00;
  b(29) =  1.1_8; c(29) =     	      	0.0_8; res(29) =       	    		 1.00000000000000000D+00;
  b(30) =  0.0_8; c(30) =     	      	0.0_8; res(30) =       	    		 1.00000000000000000D+00;
  b(31) =  -1.1_8; c(31) =    	      	0.0_8; res(31) =       	    		 1.00000000000000000D+00;
  b(32) =  1.1_8; c(32) =     	      	-1.1_8; res(32) =      	    		 9.00467507467746953D-01;
  b(33) =  0.0_8; c(33) =     	      	-1.1_8; res(33) =      	    		 pinf;
  b(34) =  -1.1_8; c(34) =    	      	-1.1_8; res(34) =      	    		 pnan;
  b(35) =  1.1_8; c(35) =     	      	-2.0_8; res(35) =      	    		 8.26446280991735449D-01;
  b(36) =  0.0_8; c(36) =     	      	-2.0_8; res(36) =      	    		 pinf;
  b(37) =  -1.1_8; c(37) =    	      	-2.0_8; res(37) =      	    		 8.26446280991735449D-01;
  b(38) =  1.1_8; c(38) =     	      	-3.0_8; res(38) =      	    		 7.51314800901577540D-01;
  b(39) =  0.0_8; c(39) =     	      	-3.0_8; res(39) =      	    		 pinf;
  b(40) =  -1.1_8; c(40) =    	      	-3.0_8; res(40) =      	    		 -7.51314800901577540D-01;
  b(41) =  -2.1_8; c(41) =    	      	1._8; res(41) =        	    		 -2.10000000000000009D+00;
  b(42) =  -2.1_8; c(42) =    	      	2._8; res(42) =        	    		 4.41000000000000014D+00;
  b(43) =  -2.1_8; c(43) =    	      	50._8; res(43) =       	    		 1.29111443505072180D+16;
  b(44) =  -2.1_8; c(44) =    	      	51._8; res(44) =       	    		 -2.71134031360651600D+16;
  b(45) =  -2.1_8; c(45) =    	      	-1._8; res(45) =       	    		 -4.76190476190476164D-01;
  b(46) =  -2.1_8; c(46) =    	      	-2._8; res(46) =       	    		 2.26757369614512455D-01;
  b(47) =  -2.1_8; c(47) =    	      	-50._8; res(47) =      	    		 7.74524684142900783D-17;
  b(48) =  -2.1_8; c(48) =    	      	-51._8; res(48) =      	    		 -3.68821278163286070D-17;
  b(49) =  -1.0_8; c(49) =    	      	 9007199254740992._8-1._8; res(49) =  	 -1.00000000000000000D+00;
  b(50) =  -1.0_8; c(50) =    	      	-9007199254740992._8+1._8; res(50) =  	 -1.00000000000000000D+00;
  b(51) =  -1.0_8; c(51) =    	      	 9007199254740992._8; res(51) =       	 1.00000000000000000D+00;
  b(52) =  -1.0_8; c(52) =    	      	-9007199254740992._8; res(52) =       	 1.00000000000000000D+00;
  b(53) =  -1.0_8; c(53) =    	      	 9007199254740992._8*2._8; res(53) =  	 1.00000000000000000D+00;
  b(54) =  -1.0_8; c(54) =    	      	-9007199254740992._8*2._8; res(54) =  	 1.00000000000000000D+00;
  b(55) =  -1.0_8; c(55) =    	      	 1D+100; res(55) =                          1.00000000000000000D+00;
  b(56) =  -1.0_8; c(56) =    	      	-1D+100; res(56) =                          1.00000000000000000D+00;
  b(57) =  -1.0_8; c(57) =    	      	 9007199254740992._8/2._8-1.5_8; res(57) =  pnan;
  b(58) =  -1.0_8; c(58) =    	      	-9007199254740992._8/2._8+1.5_8; res(58) =  pnan;
  b(59) =  -1.0_8; c(59) =    	      	 9007199254740992._8/2._8; res(59) =        1.00000000000000000D+00;
  b(60) =  -1.0_8; c(60) =    	      	-9007199254740992._8/2._8; res(60) =        1.00000000000000000D+00;
  b(61) =  +1.1_8; c(61) =    	      	1D+38; res(61) =                  	  	 pinf;
  b(62) =  -1.1_8; c(62) =    	      	1D+38; res(62) =                  	  	 pinf;
  b(63) =  -1.1_8; c(63) =    	      	2.0_8; res(63) =                     	 1.21000000000000019D+00;
  b(64) =  -1.1_8; c(64) =    	      	1D+10; res(64) =                  	  	 pinf;
  b(65) =  -1.1_8; c(65) =    	      	1D+20; res(65) =                  	  	 pinf;
  b(66) =  -1.1_8; c(66) =    	      	1D+30; res(66) =                  	  	 pinf;
  b(67) =  -1.00000000000001_8; c(67) =  9007199254740992._8*2._8; res(67) =  	 1.48938420078049906D+78;
  b(68) =  -1.00000000000001_8; c(68) =  1D+19; res(68) =                  		 pinf;
  b(69) =  -1.00000000000001_8; c(69) =  1D+20; res(69) =                  		 pinf;
  b(70) =  2.1_8; c(70) = 	      	pnan; res(70) =                		 pnan;
  b(71) =  2.1_8; c(71) = 	      	mnan; res(71) =                		 pnan;
  b(72) =  2.1_8; c(72) = 	      	pinf; res(72) =                		 pnan;
  b(73) =  2.1_8; c(73) = 	      	minf; res(73) =                		 pnan;
  b(74) =  2.1_8; c(74) = 	      	mzero; res(74) =               		 1.00000000000000000D+00;
  b(75) =  pnan; c(75) =  	      	2.1_8; res(75) =                   	 pnan;
  b(76) =  mnan; c(76) =  	      	2.1_8; res(76) =                   	 pnan;
  b(77) =  pinf; c(77) =  	      	2.1_8; res(77) =                   	 pnan;
  b(78) =  minf; c(78) =  	      	2.1_8; res(78) =                   	 pnan;
  b(79) =  mzero; c(79) = 	      	2.1_8; res(79) =                   	 0.00000000000000000D+00;
  b(80) =  pnan; c(80) =  	      	pnan; res(80) =                		 pnan;
  b(81) =  mnan; c(81) =  	      	mnan; res(81) =                		 pnan;
  b(82) =  pinf; c(82) =  	      	pinf; res(82) =                		 pnan;
  b(83) =  minf; c(83) =  	      	minf; res(83) =                		 pnan;
  b(84) =  mzero; c(84) = 	      	mzero; res(84) =               		 1.00000000000000000D+00;
  
  
  b(85) =   pzero; c(85) =      -3.0_8; res(85) =     pinf;







  b(86) =   1.0_8; c(86) =      0.0_8; res(86) =      1.0_8;

  b(87) =   pzero; c(87) =      -4.0_8; res(87) =     pinf;
  b(88) =   mzero; c(88) =      -4.0_8; res(88) =     pinf;
  b(89) =   pzero; c(89) =      5.0_8; res(89) =      pzero;
  b(90) =   mzero; c(90) =      5.0_8; res(90) =      mzero;
  b(91) =   pzero; c(91) =      6.0_8; res(91) =      pzero;
  b(92) =   mzero; c(92) =      6.0_8; res(92) =      pzero;

  b(93) =   1.0_8; c(93) =      0.0_8; res(93) =      1.0_8;
  b(94) =   1.0_8; c(94) =      0.0_8; res(94) =      1.0_8;

  b(95) =   1.0_8; c(95) =      -1.0_8; res(95) =     1.0_8;
  b(96) =   1.0_8; c(96) =      10.2_8; res(96) =     1.0_8;

  b(97) =   1.0_8; c(97) =      0.0_8; res(97) =      1.0_8;
  b(98) =   1.0_8; c(98) =      0.0_8; res(98) =      1.0_8;

  b(99) =   1.0_8; c(99) =      0.0_8; res(99) =      1.0_8;

  b(100) =   1.0_8; c(100) =     0.0_8; res(100) =      1.0_8;

  b(101) =  2.1_8; c(101) =      pzero; res(101) =  	  1.0_8;
  b(102) =  -4.3_8; c(102) =     pzero; res(102) =  	  1.0_8;
  b(103) =  pzero; c(103) =      pzero; res(103) =  	  1.0_8;
  b(104) =  mzero; c(104) =      pzero; res(104) =  	  1.0_8;
  b(105) =  pinf; c(105) =       pzero; res(105) =  	  1.0_8;
  b(106) =  minf; c(106) =       pzero; res(106) =  	  1.0_8;
  b(107) =  pnan; c(107) =       pzero; res(107) =  	  1.0_8;
  b(108) =  mnan; c(108) =       pzero; res(108) =  	  1.0_8;
  b(109) =  2.1_8; c(109) =      mzero; res(109) =  	  1.0_8;
  b(110) =  -4.3_8; c(110) =     mzero; res(110) =  	  1.0_8;
  b(111) =  pzero; c(111) =      mzero; res(111) =  	  1.0_8;
  b(112) =  mzero; c(112) =      mzero; res(112) =  	  1.0_8;
  b(113) =  pinf; c(113) =       mzero; res(113) =  	  1.0_8;
  b(114) =  minf; c(114) =       mzero; res(114) =  	  1.0_8;
  b(115) =  pnan; c(115) =       mzero; res(115) =  	  1.0_8;
  b(116) =  mnan; c(116) =       mzero; res(116) =  	  1.0_8;






  b(117) =  -1.0_8; c(117) =     2.1_8; res(117) =      pnan;
  b(118) =  -1.1_8; c(118) =     -1000.1_8; res(118) =  pnan;
  b(119) =  -1000.0_8; c(119) =  -4.3_8; res(119) =     pnan;

  b(120) =  -0.999_8; c(120) =   minf; res(120) =   	  pinf;
  b(121) =  0.999_8; c(121) =    minf; res(121) =   	  pinf;
  b(122) =  -1.0001_8; c(122) =  minf; res(122) =   	  pzero;
  b(123) =  1.0001_8; c(123) =   minf; res(123) =   	  pzero;
  b(124) =  -0.999_8; c(124) =   pinf; res(124) =   	  pzero;
  b(125) =  0.999_8; c(125) =    pinf; res(125) =   	  pzero;
  b(126) =  -1.0001_8; c(126) =  pinf; res(126) =   	  pinf;
  b(127) =  1.0001_8; c(127) =   pinf; res(127) =   	  pinf;
  b(128) =  minf; c(128) =       -7.0_8; res(128) =     mzero;
  b(129) =  minf; c(129) =       -8.0_8; res(129) =     pzero;



  b(130) =   1.0_8; c(130) =     0.0_8; res(130) =      1.0_8;

  b(131) =  minf; c(131) =       10.0_8; res(131) =     pinf;



  b(132) =   1.0_8; c(132) =     0.0_8; res(132) =      1.0_8;

  b(133) =  pinf; c(133) =       -1.0_8; res(133) =     pzero;
  b(134) =  pinf; c(134) =       -1000.9_8; res(134) =  pzero;



  b(135) =   1.0_8; c(135) =     0.0_8; res(135) =      1.0_8;

  b(136) =  pinf; c(136) =       1.0_8; res(136) =      pinf;
  b(137) =  pinf; c(137) =       1000.9_8; res(137) =   pinf;
  


  do i=138,196
     b(i) = 1._8
     c(i) = 1._8
     res(i) = 1._8
  enddo
end subroutine init


subroutine test(a,b,c)
  real(kind=8), dimension(1:196) :: a,b,c

  do i=1,196
     a(i) = b(i)**c(i)
  enddo
end subroutine test
