  Program Main
  complex*32 :: d
 logical, parameter :: mask = .true.
  complex*32, dimension(2,3,2,1) :: a
  a = reshape((/(0.0_16,0.0_16),(-30.0_16,-30.0_16),(-100.0_16,-100.0_16),(-50.0_16,-50.0_16),&
               (4.0_16,4.0_16), (5.0_16,5.0_16),(8.0_16,8.0_16),(-11.0_16,-11.0_16),(6.0_16,6.0_16),&
              (-3.0_16,-3.0_16),(2.0_16, 2.0_16),(-400.0_16, -400.0_16)/), (/2,3,2,1/))
  d =  product(a,mask = mask)
  write(1,*)  d
  d =  product(a)
  write(1,*) d
  write(1,*) (0.0_16,0.0_16) * (-30.0_16,-30.0_16)  * (-100.0_16,-100.0_16)* (-50.0_16,-50.0_16) * (4.0_16,4.0_16)* (5.0_16,5.0_16) * (8.0_16,8.0_16) &
          * (-11.0_16,-11.0_16) * (6.0_16,6.0_16)* (-3.0_16,-3.0_16) * (2.0_16, 2.0_16) * (-400.0_16, -400.0_16)

call chk
print *,'pass'
  end
subroutine chk
complex(16)::x1,x2
rewind 1
rewind 2
read(1,*) x1
if (x1/=0)print *,101
read(1,*) x1
if (x1/=0)print *,102
read(1,*) x1
if (x1/=0)print *,103
end
