integer,parameter::WP=8
REAL (KIND=WP), DIMENSION(:,:), ALLOCATABLE ::  AFACT, ACOPY
M=5
N=5
ALLOCATE (AFACT(M,N), ACOPY(M,N))
AFACT=reshape((/(i,i=1,N*M)/),(/M,N/))
ACOPY=AFACT
ACOPY = MATMUL(TRANSPOSE(ACOPY), AFACT)
if (any(abs((/ACOPY/)-(/&
55,130,205,280,355,130,330,530,730,930,205,530,855,1180,1505,280,730,1180,1630,2080,355,930,1505,2080,2655&
/))>0.0001_WP))print *,'error'
print *,'pass'
end
