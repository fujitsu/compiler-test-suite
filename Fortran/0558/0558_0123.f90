MODULE mod1
IMPLICIT NONE

PUBLIC :: rsub
PRIVATE :: msub

CONTAINS
SUBROUTINE msub(dd1)
  INTEGER :: dd1
  dd1 = 2
END SUBROUTINE

SUBROUTINE rsub(dd1,dd2)
  INTEGER :: dd1,dd2
  dd1 = 2 + dd2
END SUBROUTINE

END MODULE

MODULE mod2
USE mod1,ONLY : rsub
USE mod1, pp => rsub
IMPLICIT NONE

INTERFACE gnr
  MODULE PROCEDURE msub
END INTERFACE

PRIVATE :: msub

CONTAINS
SUBROUTINE msub(dd1)
  REAL :: dd1
  dd1 = 5.0
END SUBROUTINE

END MODULE


PROGRAM main
USE mod2
IMPLICIT NONE

REAL :: kk

INTERFACE gnr
   PROCEDURE pp
END INTERFACE

CALL gnr(kk)

IF(kk .EQ. 5.0) THEN
  PRINT*,"PASS"
ELSE
  PRINT*,"ERROR"
END IF

END PROGRAM
