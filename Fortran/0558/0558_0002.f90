MODULE mod1
IMPLICIT NONE

CHARACTER(LEN = 3) :: ch1,ch2

CONTAINS
SUBROUTINE qsub(dd1,dd2)
  CHARACTER(LEN = 3) :: dd1,dd2
  dd1 = "abc" 
  dd2 = "def"
END SUBROUTINE

END MODULE


MODULE mod2
USE mod1
IMPLICIT NONE

INTERFACE 
SUBROUTINE psub(d1)
  CHARACTER(LEN = 1) :: d1
END SUBROUTINE
END INTERFACE

END MODULE


PROGRAM main
USE mod2
IMPLICIT NONE

INTERFACE gnr
  PROCEDURE psub
  MODULE PROCEDURE :: qsub
END INTERFACE

CALL gnr(ch1,ch2)

IF(ch1 .EQ. "abc" .AND. ch2 .EQ. "def") THEN
  PRINT*,"PASS"
ELSE
  PRINT*,"ERROR"
END IF

END PROGRAM

SUBROUTINE psub(d1)
CHARACTER(LEN = 1) :: d1
  d1 = "c"
END SUBROUTINE


