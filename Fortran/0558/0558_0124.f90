MODULE mod1
IMPLICIT NONE

INTERFACE gnr
  MODULE PROCEDURE msub
END INTERFACE

PRIVATE :: msub
PUBLIC :: mfun

CONTAINS
SUBROUTINE msub(dd1)
  INTEGER :: dd1
  dd1 = 2
END SUBROUTINE

INTEGER FUNCTION mfun(dd1)
  INTEGER :: dd1
  dd1 = 2
  mfun = dd1
END FUNCTION

END MODULE

MODULE mod2
USE mod1
IMPLICIT NONE

INTERFACE gnr
  MODULE PROCEDURE msub
END INTERFACE

PRIVATE :: msub

CONTAINS
SUBROUTINE msub(dd1)
  REAL :: dd1
  dd1 = 5.0
END SUBROUTINE

END MODULE


PROGRAM main
USE mod2,ONLY : mfun,pp => mfun
IMPLICIT NONE

INTEGER :: rr,res

INTERFACE gnr
  MODULE PROCEDURE pp
END INTERFACE

res = gnr(rr)

IF(res .EQ. 2) THEN
  PRINT*,"PASS"
ELSE
  PRINT*,"ERROR"
END IF

END PROGRAM
