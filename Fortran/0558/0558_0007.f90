MODULE mod1
IMPLICIT NONE

REAL :: num1,num2

CONTAINS
SUBROUTINE msub(dd1,dd2)
  REAL :: dd1,dd2
  dd1 = dd1 * 2.0
  dd2 = dd2 * 3.0
END SUBROUTINE
SUBROUTINE intsub(d1,d2)
INTEGER :: d1,d2
d1 = d1 + d2
d2 = 2
END SUBROUTINE
END MODULE


MODULE mod2
USE mod1
IMPLICIT NONE

INTERFACE
SUBROUTINE extsub(d1,d2)
INTEGER :: d1
REAL :: d2
END SUBROUTINE
SUBROUTINE esub(d1)
INTEGER :: d1
END SUBROUTINE
END INTERFACE

INTERFACE gnr
  MODULE PROCEDURE msub
  PROCEDURE extsub
END INTERFACE

END MODULE

PROGRAM main
USE mod2
IMPLICIT NONE

INTERFACE gnr
Module PROCEDURE intsub
END INTERFACE

num1 = 5.0
num2 = 7.0

CALL gnr(num1,num2)

IF(num1 .EQ. 10.0 .AND. num2 .EQ. 21.0) THEN
  PRINT*,"PASS"
ELSE
  PRINT*,"ERROR"
END IF
END PROGRAM

SUBROUTINE extsub(d1,d2)
INTEGER :: d1
REAL :: d2
d1 = d1 + 2
d2 = d2 + 2.0
ENTRY esub(d1)
d1 = d1 * 5
END SUBROUTINE
