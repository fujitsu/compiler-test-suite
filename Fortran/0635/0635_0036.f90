MODULE FT
  TYPE FTYPE
     REAL(KIND=8),DIMENSION(65) :: F
  END TYPE FTYPE
END MODULE FT

SUBROUTINE TEST_1(P1,N,M)
  USE FT
  TYPE(FTYPE),POINTER :: P1
  INTEGER(KIND=4) :: I
  INTEGER(KIND=4),INTENT(IN) :: N,M
  DO I=1,N
    P1%F(I)=P1%F(I)+P1%F(M)
  END DO
END SUBROUTINE TEST_1

SUBROUTINE TEST_2(P1,N)
  USE FT
  TYPE(FTYPE),POINTER :: P1
  INTEGER(KIND=4) :: I
  INTEGER(KIND=4),INTENT(IN) :: N
  DO I=1,N
    P1%F(I)=P1%F(I)+P1%F(N+1)
  END DO
END SUBROUTINE TEST_2

PROGRAM MAIN
  USE FT
  TYPE(FTYPE),TARGET :: D1
  TYPE(FTYPE),POINTER :: P1
  INTERFACE 
     SUBROUTINE TEST_1(P1,N,M)
       USE FT
       TYPE(FTYPE),POINTER :: P1
       INTEGER(KIND=4),INTENT(IN) :: N,M
     END SUBROUTINE TEST_1
     SUBROUTINE TEST_2(P1,N)
       USE FT
       TYPE(FTYPE),POINTER :: P1
       INTEGER(KIND=4),INTENT(IN) :: N
     END SUBROUTINE TEST_2
  END INTERFACE
  D1%F=1.0_8
  P1=>D1
  CALL TEST_1(P1,64_4,65_4)
  IF (ANSWER_CHECK(D1,2.0_8).NE.0) THEN
     PRINT *, "NG"
  ELSE
     PRINT *, "OK"
  END IF  
  CALL TEST_2(P1,64_4)
  IF (ANSWER_CHECK(D1,3.0_8).NE.0) THEN
     PRINT *, "NG"
  ELSE
     PRINT *, "OK"
  END IF  
END PROGRAM MAIN

FUNCTION ANSWER_CHECK(RES,MASTER)
  USE FT
  TYPE(FTYPE) :: RES
  REAL(KIND=8) :: MASTER
  ANSWER_CHECK = 0
  DO I=1,64
     IF (RES%F(I).NE.MASTER) THEN
        ANSWER_CHECK = 1
        PRINT *, RES%F(I),MASTER,I
        RETURN
     END IF
  END DO
END FUNCTION ANSWER_CHECK
