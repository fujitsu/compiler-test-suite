SUBROUTINE TEST_1(D1,D2,D3,B,N,X)
  REAL(KIND=8),DIMENSION(1:N) :: D1,D2,D3,B,X
  INTEGER(KIND=4) :: I,N
  DO I=1,N
    D1(I)=D1(I)+B(I)
  END DO
  X(1) = 1
  I=1
  DO WHILE(I.LE.N)
    D2(I)=D2(I)+D1(I)
    I=I+1
  END DO
  X(2) = 2
  DO I=1,N
    D3(I)=D3(I)+B(I)
  END DO
END SUBROUTINE TEST_1

PROGRAM MAIN
  REAL(KIND=8),DIMENSION(64) :: D1/64*1.0_8/,D3/64*1.0_8/,D2/64*1.0_8/,B/64*1.0_8/,X/64*1_8/
  REAL(KIND=8),DIMENSION(64) :: TEMP1,TEMP2,TEMP3
  TEMP1=D1+1.0_8
  TEMP2=D2+2.0_8
  TEMP3=D3+1.0_8
  CALL TEST_1(D1,D2,D3,B,64_4,X)
  IF (ANSWER_CHECK(D1,TEMP1).NE.0 .OR. &
      ANSWER_CHECK(D2,TEMP2).NE.0 .OR. &
      ANSWER_CHECK(D3,TEMP3).NE.0) THEN
     PRINT *, "NG"
  ELSE
     PRINT *, "OK"
  END IF  
END PROGRAM MAIN

FUNCTION ANSWER_CHECK(RES,MASTER)
  REAL(KIND=8),DIMENSION(64) :: RES,MASTER
  ANSWER_CHECK = 0
  DO I=1,64
     IF (RES(I).NE.MASTER(I)) THEN
        ANSWER_CHECK = 1
        PRINT *, RES(I),MASTER(I),I
        RETURN
     END IF
  END DO
END FUNCTION ANSWER_CHECK
