SUBROUTINE TEST_1(D1,D2,D3,B,N,X)
  REAL(KIND=8),DIMENSION(1:N,1:N) :: D1,D2,D3,B
  REAL(KIND=8),DIMENSION(1:2) :: X
  INTEGER(KIND=4) :: I,N
  DO I=1,N
    B = MOD(I,3)
    DO J=1,N
      D1(J,I)=D1(J,I)+B(J,I)
   END DO
  END DO
  X(1) = 1
  DO I=1,N
    B = MOD(I,3)
    DO J=1,N
      D2(J,I)=D2(J,I)+B(J,I)
   END DO
  END DO
  X(2) = 2
  DO I=1,N
    B = MOD(I,3)
    DO J=1,N
      D3(J,I)=D3(J,I)+B(J,I)
   END DO
  END DO
END SUBROUTINE TEST_1

PROGRAM MAIN
  REAL(KIND=8),DIMENSION(2) :: X/2*1.0_8/
  REAL(KIND=8),DIMENSION(64,64) :: D1/4096*1.0_8/,D3/4096*1.0_8/,D2/4096*1.0_8/,B/4096*1.0_8/
  CALL TEST_1(D1,D2,D3,B,64_4,X)
  IF (ANSWER_CHECK(D1).NE.0 .OR. &
      ANSWER_CHECK(D2).NE.0 .OR. &
      ANSWER_CHECK(D3).NE.0) THEN
     PRINT *, "NG"
  ELSE
     PRINT *, "OK"
  END IF  
END PROGRAM MAIN

FUNCTION ANSWER_CHECK(RES)
  REAL(KIND=8),DIMENSION(64,64) :: RES
  REAL(KIND=8) :: MASTER
  ANSWER_CHECK = 0
  DO I=1,64
    DO J=1,64
       MASTER=1.0_8+MOD(I,3)
       IF (RES(J,I).NE.MASTER) THEN
          ANSWER_CHECK = 1
          PRINT *, RES(J,I),MASTER,J,I
          RETURN
       END IF
    END DO
  END DO
END FUNCTION ANSWER_CHECK
