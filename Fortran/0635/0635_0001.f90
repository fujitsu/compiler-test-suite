SUBROUTINE TEST(DATA1,DATA2,DATA3,B,N)
  REAL(KIND=8),DIMENSION(1:N,1:N,1:N) :: DATA1,DATA2,DATA3,B
  INTEGER(KIND=4) :: I,J,K,N
  DO I=2,N
     DO J=1,N
        DO K=1,N
           DATA1(K,J,I)=DATA1(K,J,I-1)+B(K,J,I)
        END DO
     END DO
  END DO
  DO I=2,N
     DO J=1,N
        DO K=1,N
           DATA2(K,J,I)=DATA2(K,J,I-1)+B(K,J,I)
        END DO
     END DO
  END DO
  DO I=2,N
     DO J=1,N
        DO K=1,N
           DATA3(K,J,I)=DATA3(K,J,I-1)+B(K,J,I)
        END DO
     END DO
  END DO
END SUBROUTINE TEST

PROGRAM MAIN
  REAL(KIND=8),DIMENSION(64,64,64) :: DATA1,DATA2,DATA3,B
  REAL(KIND=8),DIMENSION(64) :: TEMP1,TEMP2,TEMP3
  B=1.0_8
  DATA1=RESHAPE((/(I,I=1,262144)/),(/64,64,64/))
  DATA2=DATA1+1.0_8
  DATA3=DATA2+1.0_8
  TEMP1=RESHAPE((/(I,I=1,64)/),(/64/))
  TEMP2=TEMP1+1.0_8
  TEMP3=TEMP2+1.0_8
  CALL TEST(DATA1,DATA2,DATA3,B,64)
  IF (ANSWER_CHECK(DATA1,TEMP1).NE.0 .OR. &
      ANSWER_CHECK(DATA2,TEMP2).NE.0 .OR. &
      ANSWER_CHECK(DATA3,TEMP3).NE.0) THEN
     PRINT *, "NG"
  ELSE
     PRINT *, "OK"
  END IF  
END PROGRAM MAIN

FUNCTION ANSWER_CHECK(RES,MASTER)
  REAL(KIND=8),DIMENSION(64,64,64) :: RES
  REAL(KIND=8),DIMENSION(64) :: MASTER
  REAL(KIND=8) :: TEMP
  ANSWER_CHECK = 0
  DO I=2,64
     TEMP=MASTER(I)
     DO J=1,64
        DO K=1,64
           IF (RES(K,J,I).NE.TEMP) THEN
              ANSWER_CHECK = 1
              PRINT *, RES(K,J,I),TEMP,K,J,I
              RETURN
           END IF
           TEMP=TEMP+1.0_8
        END DO
     END DO
  END DO
END FUNCTION ANSWER_CHECK
