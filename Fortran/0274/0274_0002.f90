MODULE M
  TYPE TY
     REAL(2)::RR2
     COMPLEX(2)::CC2
  CONTAINS
    PROCEDURE :: WUNFORM
    PROCEDURE :: RUNFORM
     GENERIC :: READ(UNFORMATTED) => RUNFORM
     GENERIC :: WRITE(UNFORMATTED) => WUNFORM
  END TYPE
CONTAINS
    SUBROUTINE WUNFORM(DTV, UNIT, IOSTAT, IOMSG)
      CLASS(TY), INTENT(IN) :: DTV
      INTEGER, INTENT(IN) :: UNIT
      INTEGER, INTENT(OUT) :: IOSTAT
      CHARACTER(*), INTENT(INOUT) :: IOMSG
      WRITE(UNIT,IOSTAT=IOSTAT,IOMSG=IOMSG) DTV%RR2+1,DTV%CC2+1
    END SUBROUTINE
    SUBROUTINE RUNFORM(DTV, UNIT, IOSTAT, IOMSG)
      CLASS(TY), INTENT(INOUT) :: DTV 
      INTEGER, INTENT(IN) :: UNIT
      INTEGER, INTENT(OUT) :: IOSTAT
      CHARACTER(*), INTENT(INOUT) :: IOMSG
      READ (UNIT=UNIT, IOSTAT=IOSTAT, IOMSG=IOMSG) DTV%RR2,DTV%CC2
       DTV%RR2= DTV%RR2+1
       DTV%CC2= DTV%CC2+1
    END SUBROUTINE
END MODULE
PROGRAM MAIN
  USE M
  TYPE RT
    TYPE (TY) :: T1(5)
  END TYPE

  TYPE BT
    TYPE(RT) :: OBJ(5)
  END TYPE

  TYPE(BT) :: KK1,KK2
  KK1%OBJ(2)%T1(2) = TY( 1.5_2,(2.5_2,3.5_2))
  KK1%OBJ(2)%T1(3) = TY( 10.5_2,(20.5_2,30.5_2))
  KK1%OBJ(2)%T1(4) = TY( 15.5_2,(25.5_2,35.5_2))
  KK1%OBJ(2)%T1(5) = TY( 20.5_2,(30.5_2,40.5_2))
  KK1%OBJ(1)%T1(1) = TY( 20.5_2,(30.5_2,40.5_2))
  KK1%OBJ(1)%T1(2) = TY( 20.5_2,(30.5_2,40.5_2))
  KK1%OBJ(1)%T1(3) = TY( 20.5_2,(30.5_2,40.5_2))

  OPEN(2,FILE ='FORT.16',FORM="UNFORMATTED")
  WRITE(2) KK1%OBJ(2)%T1(2:5)
  WRITE(2) KK1%OBJ(1)%T1(1:3)
  CLOSE(2)
  OPEN(22,FILE ='FORT.16',FORM="UNFORMATTED")
  READ(22) KK2%OBJ(2)%T1(2:5)
  READ(22) KK2%OBJ(1)%T1(1:3)
  CLOSE(22,STATUS="DELETE")
  IF(KK2%OBJ(2)%T1(2)%RR2 /= KK1%OBJ(2)%T1(2)%RR2+2)PRINT*,"101" 
  IF(KK2%OBJ(2)%T1(4)%RR2 /= KK1%OBJ(2)%T1(4)%RR2+2)PRINT*,"102" 
  IF(KK2%OBJ(2)%T1(5)%RR2 /= KK1%OBJ(2)%T1(5)%RR2+2)PRINT*,"103" 
  IF(KK2%OBJ(1)%T1(2)%RR2 /= KK1%OBJ(1)%T1(2)%RR2+2)PRINT*,"104" 
  IF(KK2%OBJ(1)%T1(2)%CC2 /= KK1%OBJ(1)%T1(2)%CC2+2)PRINT*,"105" 

PRINT*,"PASS"   

END PROGRAM

