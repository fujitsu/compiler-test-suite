PROGRAM main
IMPLICIT NONE

INTEGER,POINTER :: num 
INTEGER,TARGET :: tgt = 10
num => fun()

IF(num .EQ. 10) THEN
  PRINT*,'pass'
ELSE
  PRINT*,101
END IF

CONTAINS

FUNCTION fun()
IMPLICIT NONE
INTEGER,POINTER :: fun
ASSOCIATE(aa => tgt)
  fun => aa
END ASSOCIATE
END FUNCTION

END PROGRAM
