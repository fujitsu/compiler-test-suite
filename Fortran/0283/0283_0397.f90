MODULE mod1
IMPLICIT NONE

TYPE t1
  REAL(KIND = 8) :: r1
END TYPE

TYPE,EXTENDS(t1) :: t2
  REAL(KIND = 8) :: r2
END TYPE

END MODULE

PROGRAM main
USE mod1
IMPLICIT NONE

INTEGER :: res
CLASS(*),ALLOCATABLE :: obj1

ALLOCATE(t2 :: obj1)
res = fun(obj1)

IF(res .EQ. 1) THEN
  PRINT*,'pass'
ELSE
  PRINT*,101
END IF

CONTAINS

FUNCTION fun(dd1)
IMPLICIT NONE
CLASS(*),ALLOCATABLE :: dd1
INTEGER :: fun
SELECT TYPE(dd1)
TYPE IS(t2)
  dd1%r2 = 123546.927400
  ASSOCIATE(aa => dd1)
    IF(aa%r2 .EQ. 123546.927400) THEN
      fun = 1
    ELSE
      fun = 0
    END IF
  END ASSOCIATE
END SELECT
END FUNCTION

END PROGRAM
