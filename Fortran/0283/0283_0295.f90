MODULE mod1
IMPLICIT NONE

INTEGER,DIMENSION(:),ALLOCATABLE :: arr1 , arr2

INTERFACE
FUNCTION fun_1(dd)
IMPLICIT NONE
INTEGER,DIMENSION(:),POINTER :: fun_1
INTEGER,DIMENSION(:),ALLOCATABLE,TARGET :: dd
END FUNCTION
FUNCTION fun_2(dd2)
IMPLICIT NONE
INTEGER,DIMENSION(:),POINTER :: fun_2
INTEGER,DIMENSION(:),ALLOCATABLE,TARGET :: dd2
END FUNCTION
END INTERFACE

END MODULE

PROGRAM main
USE mod1
IMPLICIT NONE

ALLOCATE(arr1(5),arr2(5))
arr1 = (/1,2,3,4,5/)
arr2 = (/11,12,13,14,15/)
ASSOCIATE(aa => fun_1(arr1) + fun_2(arr2))   
  IF(aa(3) .EQ. 16) PRINT*,'pass'
END ASSOCIATE

END PROGRAM

FUNCTION fun_1(dd)
IMPLICIT NONE
INTEGER,DIMENSION(:),POINTER :: fun_1
INTEGER,DIMENSION(:),ALLOCATABLE,TARGET :: dd
fun_1 => dd
END FUNCTION

FUNCTION fun_2(dd2)
IMPLICIT NONE
INTEGER,DIMENSION(:),POINTER :: fun_2
INTEGER,DIMENSION(:),ALLOCATABLE,TARGET :: dd2
fun_2 => dd2
END FUNCTION
