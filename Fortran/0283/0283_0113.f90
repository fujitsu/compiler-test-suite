PROGRAM main
IMPLICIT NONE

INTERFACE
SUBROUTINE sub(f1,pt)
INTEGER,POINTER :: pt
INTEGER,TARGET :: f1
END SUBROUTINE

INTEGER FUNCTION fun(ff)
INTEGER :: ff
END FUNCTION
END INTERFACE

INTEGER,POINTER :: ptr
INTEGER :: num = 2

ASSOCIATE(bb => num)
  CALL sub(fun(bb),ptr)
END ASSOCIATE

IF(ptr .EQ. 2) THEN
   PRINT*,'pass'
ELSE
  PRINT*,101
END IF

END PROGRAM

SUBROUTINE sub(f1,pt)
INTEGER,POINTER :: pt
INTEGER,TARGET :: f1
pt => f1
END SUBROUTINE

INTEGER FUNCTION fun(ff)
INTEGER :: ff
fun = ff
END FUNCTION
