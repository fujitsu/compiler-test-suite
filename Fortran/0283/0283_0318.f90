MODULE mod1
IMPLICIT NONE

TYPE t1
  INTEGER :: r
  CONTAINS
  PROCEDURE,PASS(d1) :: proc => proc_m
END TYPE

CONTAINS

INTEGER FUNCTION proc_m(d1,d2)
IMPLICIT NONE
INTEGER,INTENT(IN) :: d2
CLASS(t1) :: d1
proc_m = d1%r + d2
END FUNCTION

END MODULE

PROGRAM main
USE mod1
IMPLICIT NONE

INTEGER :: n = 5
CLASS(t1),ALLOCATABLE :: obj
ALLOCATE(obj)
obj%r = 10

ASSOCIATE(aa => obj%proc(n))
  SELECTCASE(aa)
  CASE(15)
    PRINT*,'pass'
  END SELECT 
END ASSOCIATE

END PROGRAM
