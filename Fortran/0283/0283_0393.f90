MODULE mod1
IMPLICIT NONE

INTEGER,PRIVATE :: a = 2,b = 3

CONTAINS

INTEGER FUNCTION fun()
IMPLICIT NONE
ASSOCIATE(aa => a * b)
  SELECT CASE(aa)
    CASE (6)
    fun = aa
  END SELECT
END ASSOCIATE
END FUNCTION

END MODULE

PROGRAM main
USE mod1
IMPLICIT NONE

INTEGER :: res

res = fun()

IF(res .EQ. 6) THEN
  PRINT*,'pass'
ELSE
  PRINT*,101
END IF

END PROGRAM
