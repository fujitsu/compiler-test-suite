MODULE mod1
IMPLICIT NONE

INTERFACE
FUNCTION fun_1(dd1)
IMPLICIT NONE
INTEGER,DIMENSION(3,3,2,2,3,3,5) :: fun_1
INTEGER,DIMENSION(3,3,2,2,3,3,5) :: dd1
END FUNCTION
FUNCTION fun_2(dd2)
IMPLICIT NONE
INTEGER,DIMENSION(:,:,:,:,:,:,:),POINTER :: fun_2
INTEGER,DIMENSION(3,3,2,2,3,3,5),TARGET :: dd2
END FUNCTION
END INTERFACE

END MODULE

PROGRAM main
USE mod1
IMPLICIT NONE

INTEGER,DIMENSION(:,:,:,:,:,:,:),ALLOCATABLE :: arr1
INTEGER,DIMENSION(:,:,:,:,:,:,:),ALLOCATABLE :: arr2
INTEGER,DIMENSION(:,:,:,:,:,:,:),ALLOCATABLE :: num

ALLOCATE(arr1(5,6,4,2,7,9,10),arr2(5,6,4,2,7,9,10))

ASSOCIATE(aa => fun_1(arr1(2:4,2:6:2,1:4:2,1:2,2:6:2,1:9:3,2:10:2)) * &
                fun_2(arr2(2:4,2:6:2,1:4:2,1:2,2:6:2,1:9:3,2:10:2)) + 10)
  ALLOCATE(num(3,3,2,2,3,3,5),SOURCE = aa)
END ASSOCIATE

IF(num(2,2,2,2,2,2,2) .EQ. 22) THEN
  PRINT*,'pass'
ELSE
  PRINT*,101
END IF

END PROGRAM

FUNCTION fun_1(dd1)
IMPLICIT NONE
INTEGER,DIMENSION(3,3,2,2,3,3,5) :: fun_1
INTEGER,DIMENSION(3,3,2,2,3,3,5) :: dd1
dd1 = 3
fun_1 = dd1
END FUNCTION

FUNCTION fun_2(dd2)
IMPLICIT NONE
INTEGER,DIMENSION(:,:,:,:,:,:,:),POINTER :: fun_2
INTEGER,DIMENSION(3,3,2,2,3,3,5),TARGET :: dd2
dd2 = 4
fun_2 => dd2
END FUNCTION
