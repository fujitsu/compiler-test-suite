MODULE mod1
IMPLICIT NONE

TYPE t1
  CHARACTER(LEN = 5) :: ch
END TYPE

TYPE,EXTENDS(t1) :: t2
  CHARACTER(LEN = 6) :: ch2
END TYPE

INTERFACE
FUNCTION fun_2(dd2)
CHARACTER :: fun_2,dd2
END FUNCTION
END INTERFACE

END MODULE

PROGRAM main
USE mod1
IMPLICIT NONE

CLASS(t2),ALLOCATABLE :: allc
ALLOCATE(allc) 
allc%ch2 ='xxax'

ASSOCIATE(aa => fun_1(allc))
  IF('xax' .EQ. aa%ch2(2:4)) THEN 
    PRINT*,'pass'
  ELSE
   PRINT*,101
 END IF
END ASSOCIATE

CONTAINS

FUNCTION fun_1(dd1)
IMPLICIT NONE
CLASS(t2),ALLOCATABLE :: dd1,fun_1
ALLOCATE(fun_1)
fun_1%ch2 = TRIM(dd1%ch2)
END FUNCTION

END PROGRAM
