MODULE mod1
IMPLICIT NONE

TYPE t1
  INTEGER(KIND = 8) :: r1
END TYPE

TYPE,EXTENDS(t1) :: t2
  INTEGER(KIND = 8) :: r2
END TYPE

END MODULE

PROGRAM main
USE mod1
IMPLICIT NONE

INTEGER :: res
CLASS(*),DIMENSION(:),ALLOCATABLE :: obj1

ALLOCATE(t2 :: obj1(3:8))
res = fun(obj1)

IF(res .EQ. 1.0) THEN
  PRINT*,'pass'
ELSE
  PRINT*,101
END IF

CONTAINS

FUNCTION fun(dd1)
IMPLICIT NONE
CLASS(*),DIMENSION(:),ALLOCATABLE :: dd1
INTEGER :: fun
SELECT TYPE(dd1)
TYPE IS(t2)
  dd1%r2 = 123.2700
  ASSOCIATE(aa => dd1)
    IF(ALL(INT(aa(3:8)%r2) .EQ. 123)) THEN
      fun = 1.0
    ELSE
      fun = 0.0
    END IF
  END ASSOCIATE
END SELECT
END FUNCTION

END PROGRAM
