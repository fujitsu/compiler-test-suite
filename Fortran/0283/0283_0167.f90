MODULE mod1
IMPLICIT NONE

TYPE t1
  REAL :: rr
END TYPE

TYPE,EXTENDS(t1) :: t2
  REAL :: rr1
END TYPE

END MODULE

PROGRAM main
USE mod1
IMPLICIT NONE

CLASS(t2),ALLOCATABLE :: acc
ALLOCATE(acc)
acc%rr1 = 10.0
CALL sub()

CONTAINS

SUBROUTINE sub()
IMPLICIT NONE
ASSOCIATE(aa => acc)
  SELECT TYPE(aa)  
    TYPE IS(t2)
    PRINT*,'pass'
  END SELECT
END ASSOCIATE
END SUBROUTINE

END PROGRAM
