subroutine test1(res,arg,n)
  real(4) :: res(n)
  real(4) :: arg(n)
  do i=1,n
     res(i) = gamma(arg(i))
  enddo
end

subroutine test2(res,arg,n)
  real(8) :: res(n)
  real(8) :: arg(n)
  do i=1,n
     res(i) = gamma(arg(i))
  enddo
end

subroutine init(fres,farg,dres,darg,n)
  real(4) :: fres(n)
  real(4) :: farg(n)
  real(8) :: dres(n)
  real(8) :: darg(n)
  do i=1,n
     fres(i) = 0
     farg(i) = i
     dres(i) = 0
     darg(i) = i
  enddo
end

program main
  parameter(n=35)
  real(8),parameter::eps=1.0E-15_8
  real(4),parameter::feps=1.0E-6_4
  integer::i
  real(4) :: fres(n)
  real(4) :: farg(n)
  real(8) :: dres(n)
  real(8) :: darg(n)

  real(4) :: fmaster(n)
  real(8) :: dmaster(n)
  data fmaster/ &
  1.00000000_4,1.00000000_4,2.00000000_4,6.00000000_4,24.0000000_4,  &
  120.000000_4,720.000000_4,5040.00000_4,40320.0000_4,362880.000_4,  &
  3628800.00_4,39916800.0_4,479001600._4,6.22702080E+09_4,8.71782892E+10_4, &
  1.30767441E+12_4,2.09227906E+13_4,3.55687415E+14_4,6.40237353E+15_4,1.21645105E+17_4, &
  2.43290202E+18_4,5.10909408E+19_4,1.12400072E+21_4,2.58520174E+22_4,6.20448383E+23_4, &
  1.55112099E+25_4,4.03291463E+26_4,1.08888692E+28_4,3.04888353E+29_4,8.84176187E+30_4, &
  2.65252851E+32_4,8.22283845E+33_4,2.63130830E+35_4,8.68331788E+36_4,2.95232803E+38_4/

  data dmaster/ &
  1.000000000000000_8,1.000000000000000_8,2.000000000000000_8,6.000000000000000_8,24.00000000000000_8, &
  120.0000000000000_8,720.0000000000000_8,5040.000000000000_8,40320.00000000000_8,362880.0000000000_8, &
  3628800.000000000_8,39916800.00000000_8,479001600.0000000_8,6227020800.000000_8,87178291200.00000_8, &
  1307674368000.000_8,20922789888000.00_8,355687428096000.0_8,6402373705728001._8,1.216451004088320E+17_8, &
  2.432902008176640E+18_8,5.109094217170944E+19_8,1.124000727777608E+21_8,2.585201673888498E+22_8,6.204484017332395E+23_8, &
  1.551121004333099E+25_8,4.032914611266056E+26_8,1.088886945041835E+28_8,3.048883446117139E+29_8,8.841761993739703E+30_8, &
  2.652528598121911E+32_8,8.222838654177924E+33_8,2.631308369336936E+35_8,8.683317618811887E+36_8,2.952327990396042E+38_8/

  call init(fres,farg,dres,darg,n) 
  call test1(fres,farg,n)
  
  do i=1, n
     if ( abs((fres(i) - fmaster(i))/fres(i)) .ge. feps ) then
        print *, "NG @float:", i
     end if
  end do

  call init(fres,farg,dres,darg,n) 
  call test2(dres,darg,n)
  
  do i=1, n
     if ( abs((dres(i) - dmaster(i))/dres(i)) .ge. eps ) then
        print *, "NG @double:", i
     end if
  end do

  print *, "OK"
end program main
