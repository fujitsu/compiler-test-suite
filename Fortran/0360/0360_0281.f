      call test_ctan
      call test_cdtan
      call test_ctanh
      call test_cdtanh
      end

      subroutine test_ctan()
      complex*8 a(16),b(16),res(16)
      data b/(-1,16),(-2,15),(-3,14),(-4,13),(-5,12),(-6,11),
     +       (7,-10),(8,-9),(9,-8),(10,-7),(11,-6),(12,-5),
     +     (-13,-4),(14,3),(-15,-2),(16,1)/
      data res/(-2.3030983E-14,1.),(1.4163743E-13,.9999999),
     +     (3.8639813E-13,1.),(-1.010944E-11,1.0000001),
     +     (4.1075056E-11,1.),(2.993506E-10,1.),(4.083588E-09,-1.),
     +     (-8.769523E-09,-1.),(-1.6902491E-07,-.99999976),
     +     (1.5182792E-06,-.9999993),(-1.0876998E-07,-1.0000123),
     +     (-8.2223225E-05,-.9999616),(-5.1139766E-04,-.9995659),
     +     (1.3494481E-03,1.0047827),(3.5977505E-02,-.9937163),
     +     (0.11996876,0.78906214)/

      do i=1,16
         a(i) = tan(b(i))
      enddo
      call check(a,res)
      write(6,*)
      end

      subroutine test_cdtan()
      complex*16 a(16),b(16)
      data b/(-1,16),(-2,15),(-3,14),(-4,13),(-5,12),(-6,11),
     +       (7,-10),(8,-9),(9,-8),(10,-7),(11,-6),(12,-5),
     +       (-13,-4),(14,3),(-15,-2),(16,1)/

      do i=1,16
         a(i) = tan(b(i))
      enddo
      write(6,*) a
      write(6,*)
      end


      subroutine test_ctanh()
      complex*8 a(16),b(16),res(16)
      data b/(-1,16),(-2,15),(-3,14),(-4,13),(-5,12),(-6,11),
     +       (7,-10),(8,-9),(9,-8),(10,-7),(11,-6),(12,-5),
     +     (-13,-4),(14,3),(-15,-2),(16,1)/
      data res/(-0.78906214,0.11996876),(-0.9937163,-3.5977505E-02),
     +     (-1.0047827,1.3494481E-03),(-0.9995659,5.1139766E-04),
     +     (-0.9999616,-8.2223225E-05),(-1.0000123,-1.0876998E-07),
     +     (.9999993,-1.5182792E-06),(.99999976,1.6902491E-07),
     +     (1.,8.769523E-09),(1.,-4.083588E-09),(1.,2.993506E-10),
     +     (1.,4.1075056E-11),(-1.0000001,-1.010944E-11),
     +     (1.,-3.8639813E-13),(-.9999999,1.4163743E-13),
     +     (1.,2.3030983E-14)/

      do i=1,16
         a(i) = tanh(b(i))
      enddo
      call check(a,res)
      write(6,*)
      end

      subroutine test_cdtanh()
      complex*16 a(16),b(16)
      data b/(-1,16),(-2,15),(-3,14),(-4,13),(-5,12),(-6,11),
     +       (7,-10),(8,-9),(9,-8),(10,-7),(11,-6),(12,-5),
     +       (-13,-4),(14,3),(-15,-2),(16,1)/

      do i=1,16
         a(i) = tanh(b(i))
      enddo
      write(6,*) a
      end

#define IS_EQUAL(a,b) ((a==b).or.(a==0.and.abs(b)<10E-6).or.(abs(a-b)/abs(a)<10E-6))
      subroutine check(calc,res)
      complex*8 calc(16),res(16)
      real*4 re1,im1,re2,im2
      logical ngcheck/.FALSE./
      do i=1,16
         re1 = real(calc(i))
         im1 = imag(calc(i))
         re2 = real(res(i))
         im2 = imag(res(i))
         if (IS_EQUAL(re1, re2)) then
         else
            ngcheck = .TRUE.
         endif
         if (IS_EQUAL(im1, im2)) then
         else
            ngcheck = .TRUE.
         endif
      enddo
      if (ngcheck) write(6,*) calc
      end
