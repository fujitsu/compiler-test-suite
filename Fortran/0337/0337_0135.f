      DOUBLE PRECISION  R,L2,L10,A(9),X,Y,B,D,C,Z,DIFF,DI
      N=0
      R=1.414213562373095D0
      L2=0.6931471805599453D0
      L10=2.302585092994046D0
      DIFF=1.0D-14
      A(1)=2.885390081777927D0
      A(2)=0.9617966939259755D0
      A(3)=0.5770780163556935D0
      A(4)=0.4121985830734861D0
      A(5)=0.3205989045353651D0
      A(6)=0.2623075480640132D0
      A(7)=0.2219890761494066D0
      A(8)=0.1911392479842068D0
      A(9)=0.1913317120226657D0
      K=1
      ITEM=1
      IIW=1
   10 N=N+1
      IF(N-1)11,12,11
   11 CONTINUE
C
  210 FORMAT(1H1 / )
   12 CONTINUE
      L=0
   20 DI=K
      IF(ITEM-1) 270,300,270
  300 X=DI/1000.0D0
      GO TO 350
  270 X=DI/100.0D0
  350 Y=DLOG10(X)
      B=0.5D0
      IF(X-1.0D0)30,40,40
   30 D=1.0D0/X
      M=0
      GO TO 50
   40 D=X
      M=1
   50 IF(D-2.0D0)70,70,60
   60 D=D*0.5D0
      B=B+1.0D0
      GO TO 50
   70 C=(D-R)/(D+R)
      Z=0.0D0
      DO 100 I=1,9
      Z=Z+A(I)*C**(2*I-1)
  100 CONTINUE
      Z=Z+B
      IF(M)80,90,80
   90 Z=-Z
   80 Z=L2/L10*Z
      CALL DPRTN(L,DIFF,X,Y,Z)
      L=L+1
      GO TO(400,500,550),ITEM
  400 IF(K-1000)16,15,15
   16 K=K+1
      IF(L-50)20,10,10
   15 ITEM=2
      K=101
      GO TO 10
  500 IF(K-1000) 18,17,17
   18 K=K+1
      IF(L-50)20,10,10
   17 ITEM=3
      K=1100
      GO TO 10
  550 IF(K-10000) 21,21,19
   21 K=K+100
      IF(L-50)20,10,10
   19 CONTINUE
      STOP
      END
C
      SUBROUTINE    DPRTN (L,D,A,R,V)
      DOUBLE PRECISION A,R,V,DIFF,D
      DIFF = V - R
      IF(DABS(R)-1.0D0)80,80,90
   80 IF(DABS(DIFF)-D) 100,120,120
   90 IF(DABS(DIFF)-D*DABS(V)) 100,120,120
  100 CONTINUE
C
    1 FORMAT(1H ,5X,8H*OK*    ,4(5X,D24.17) )
      GO TO 130
  120 WRITE (6,2) A,R,V,DIFF
    2 FORMAT(1H ,5X,8H*ERROR* ,4(5X,D24.17) )
  130 IF (L- 9) 200,190,140
  140 IF (L-19) 200,190,150
  150 IF (L-29) 200,190,160
  160 IF (L-39) 200,190,200
  190 CONTINUE
C
    3 FORMAT (1H )
  200 RETURN
      END
