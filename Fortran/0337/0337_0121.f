       INTRINSIC DEXP,CEXP,DLOG,CLOG,DLOG10,DSIN,CSIN,DCOS,CCOS,DSQRT,
     *CSQRT,DATAN,DATAN2,DMOD,CABS
      REAL*8   DEXP,DLOG,DSIN,DCOS,DSQRT,DATAN,DMOD,DLOG10,DATAN2
      COMPLEX  CEXP,CLOG,CSIN,CCOS,CSQRT,CABS
      DOUBLE PRECISION ANS,X,X2,DIF,D
      COMPLEX P,ANSC,Y
      COMMON X2,Y,ITM,D
      WRITE(6,101)
      ITM=1
      X=0.12345678D2
      P=(3.9,4.8)
      X2=0.25D1
  101 FORMAT(1H0 // 10X,44H- JUSTICE -     - ITEM -          - COMPUTED
     *9H RESULT -13X,17H- COMPARE VALUE -15X,14H- DIFFERENCE -/)
  102 FORMAT(1H0,12X,7H*ERROR*,7X,2H( I2,2H )7X,D24.17,7X,D24.17,7X,
     *D24.17)
  103 FORMAT(1H0 12X,4H*OK*10X,2H( I2,2H )7X,D24.17,7X,D24.17,7X,D24.17)
  104 FORMAT(1H0,8X,15H*ERROR* *ERROR*3X,2H( I2,2H )5X,2E14.7,
     *2(3X,2E14.7))
  105 FORMAT(1H0 11X,12H*OK*    *OK*3X,2H( I2,2H )5X,2E14.7,
     *2(3X,2E14.7))
  106 FORMAT(1H0,8X,15H*ERROR*    *OK*,3X,2H( I2,2H )5X,2E14.7,
     *2(3X,2E14.7))
  107 FORMAT(1H0,11X,12H*OK* *ERROR*3X,2H( I2,2H )5X,2E14.7,
     *2(3X,2E14.7))
  108 FORMAT(1H0,11X,12HREAL    IMAG,6X,3(13X,4HREAL,10X,4HIMAG)//)

    1 CALL SUB(DEXP,X)
      ANS =DEXP(X)
      GO TO 700
    2 CALL SUB(DLOG,X)
      ANS =DLOG(X)
      GO TO 700
    3 CALL SUB(DLOG10,X)
      ANS =DLOG10(X)
      GO TO 700
    4 CALL SUB(DSIN,X)
      ANS =DSIN(X)
      GO TO 700
    5 CALL SUB(DCOS,X)
      ANS =DCOS(X)
      GO TO 700
    6 CALL SUB(DSQRT,X)
      ANS =DSQRT(X)
      GO TO 700
    7 CALL SUB(DATAN,X)
      ANS =DATAN(X)
      GO TO 700
    8 CALL SUB(DATAN2,X)
      ANS =DATAN2(X,X2)
      GO TO 700
    9 CALL SUB(DMOD,X)
      ANS =DMOD(X,X2)
      GO TO 700
   10 CALL SUB1(CEXP,P)
      ANSC=CEXP(P)
      GO TO 800
   11 CALL SUB1(CLOG,P)
      ANSC=CLOG(P)
      GO TO 800
   12 CALL SUB1(CSIN,P)
      ANSC=CSIN(P)
      GO TO 800
   13 CALL SUB1(CCOS,P)
      ANSC=CCOS(P)
      GO TO 800
   14 CALL SUB1(CSQRT,P)
      ANSC=CSQRT(P)
      GO TO 800
   15 CALL SUB2(CABS,P)
      S =CABS(P)
      ANSC=CMPLX(S,S)
      GO TO 800
  700 DIF=D-ANS
      IF(ANS)40,41,40
   40 IF(DABS(DIF)-1.0D-15*DABS(ANS))701,702,702
   41 IF(DABS(DIF)-1.0D-15)701,702,702
  701 WRITE(6,103)ITM
      GO TO 70
  702 WRITE(6,102)ITM,D,ANS,DIF
      GO TO 70
  800 RL  =REAL(ANSC)
      AG  =AIMAG(ANSC)
      DIFR=REAL(Y)-RL
      DIFI=AIMAG(Y)-AG
      IF(RL)50,51,50
   50 IF(ABS(DIFR)-1.0E-5*ABS(RL))703,704,704
   51 IF(ABS(DIFR)-1.0E-6)703,704,704
  703 IF(AG)52,53,52
   52 IF(ABS(DIFI)-1.0E-5*ABS(AG))705,706,706
   53 IF(ABS(DIFI)-1.0E-6)705,706,706
  704 IF(AG)54,55,54
   54 IF(ABS(DIFI)-1.0E-5*ABS(AG))707,708,708
   55 IF(ABS(DIFI)-1.0E-6)707,708,708
  705 WRITE(6,105)ITM
      GO TO 70
  706 WRITE(6,107)ITM
      GO TO 70
  707 WRITE(6,106)ITM,Y,ANSC,DIFR,DIFI
      GO TO 70
  708 WRITE(6,104)ITM,Y,ANSC,DIFR,DIFI
   70 ITM=ITM+1
      IF(ITM-10)72,71,72
   71 WRITE(6,108)
   72 GO TO (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16),ITM
   16 CONTINUE
      STOP
      END
      SUBROUTINE SUB(F,X)
      DOUBLE PRECISION D,F,X,X2,U
      COMMON X2,U,ITM,D
      IF(ITM-8)1,2,2
    1 D   =F(X)
      RETURN
    2 D   =F(X,X2)
      RETURN
      END
      SUBROUTINE SUB1(F,X)
      COMPLEX X,F,Y,F1
      COMMON F1,Y,ITM
    1 Y=F(X)
      RETURN
      END
      SUBROUTINE SUB2(F,X)
      COMPLEX Y,F1,X
      COMMON F1,Y,ITM
      S=F(X)
      Y=CMPLX(S,S)
      RETURN
      END
