      WRITE (6,10)
   10 FORMAT('1',5X,'====== FORTRAN ====== ...= TEST ='/)
      IP=0
      CALL F02103(IP)
      IF (IP.NE.0) GO TO 30
      WRITE (6,20)
   20 FORMAT(' ',20X,'= TEST =     OK')
   30 WRITE(6,40)
   40 FORMAT (1H ,20X,'END RUN UNIT')
      STOP
      END
      SUBROUTINE F02103 (IP)
      COMMON /LABEL2/ IB5,IB6
      R00=F02104(IP)
      RETURN
      E N D
      FUNCTION F02104 (IP)
      COMMON /LABEL/ IB5,IB6
      EQUIVALENCE (IB7,IB8)
      JCONT=0
      ASSIGN 0010 TO IB5
      GO TO IB5,(10,9,19,29)
   50 JCONT=JCONT-1
   10 CONTINUE
      JCONT=JCONT+1
      ASSIGN 1 1 TO IB7
      GO TO IB7,(11,9,19,29)
   60 JCONT=JCONT-1
  1 1 CONTINUE
      JCONT=JCONT+1
      ASSIGN 2 2 TO IB6
      GO TO IB6,(22,9,19,29)
   70 JCONT=JCONT-1
 2 2  CONTINUE
      JCONT=JCONT+1
      F02104 =1.0
   99 IF(JCONT.EQ.3) RETURN
    9 CONTINUE
   19 CONTINUE
   29 CONTINUE
      IP=IP+1
      WRITE(6,100) JCONT
  100 FORMAT(1H0,20X,'==TEST==',3X,'NG',5X, 5H3 ' ,I1)
      RETURN
      E N D
