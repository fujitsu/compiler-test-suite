      program main
        use omp_lib
        integer*8 :: count, res
        count=0
!$omp parallel
!$omp   master
          res = omp_get_num_threads()
!$omp   end master     
!$omp   critical(A123456789b123456789c123456789D123456789e123456789F123456789g123456789&
!$omp H123456789i123456789J123456789k123456789L123456789m123456789N123456789&
!$omp o123456789P123456789q123456789R123456789s123456789T123456789u123456789V123456789w123456789X123456789)
          count = count + 1
!$omp   end critical(A123456789b123456789c123456789D123456789e123456789F123456789g123456789&
!$omp H123456789i123456789J123456789k123456789L123456789m123456789N123456789&
!$omp o123456789P123456789q123456789R123456789s123456789T123456789u123456789V123456789w123456789X123456789)
!$omp end parallel
        if( count == res ) then
          print *,'OK'
        else
          print *,'NG(',res,'):',count
        end if
      end program main
