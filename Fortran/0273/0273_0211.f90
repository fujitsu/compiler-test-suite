TYPE TY
 INTEGER :: II=5
END TYPE

TYPE,EXTENDS(TY) :: TTY
INTEGER :: JJ
END TYPE
REAL(2) :: R2(4)
COMPLEX(KIND=2) :: C2(4)
R2=5
C2=(6,7)
CALL S1(R2)
CALL S1(C2)
rewind 13
read(13,*) k
if (k/=1) print *,1001
read(13,*) k
if (k/=2) print *,1002
PRINT*,"PASS"
CONTAINS
SUBROUTINE S1(D1)
 CLASS(*):: D1(:)
 SELECT TYPE(D1)
 TYPE IS(TY)
 PRINT*,D1%II
 TYPE IS(REAL(2))
 write(13,*) 1
 TYPE IS(COMPLEX(2))
 write(13,*) 2
 CLASS DEFAULT
 PRINT*,"121"
 END SELECT
END
END
