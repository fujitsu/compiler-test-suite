USE ISO_C_BINDING, ONLY:  C_LOC
REAL*2,POINTER::ACT1,ACT3(:)
COMPLEX(KIND=2),POINTER::ACT2,ACT4(:)
ALLOCATE(ACT1,ACT2)
ALLOCATE(ACT3(4),ACT4(5))
 CALL SUB(ACT1,ACT2,ACT3,ACT4)
 PRINT*,"PASS"
CONTAINS
SUBROUTINE SUB(A,B,R2ARR,C2ARR)
  USE ISO_C_BINDING 
  REAL(2), POINTER :: A,R2ARR(:)
  COMPLEX(KIND=2), POINTER :: B,C2ARR(:)
  REAL(2), POINTER :: A2, A22(:)
  COMPLEX(2), POINTER :: B2,B22(:)
  REAL(2), TARGET:: T2=44.5_2
  COMPLEX(KIND=2), TARGET:: T3= (5.5_2,6.5_2)
  REAL(2), TARGET:: T2ARR(4)=66.5_2
  COMPLEX(KIND=2), TARGET:: T3ARR(5)=(7.5_2,8.5_2)
  A=>T2
  B=>T3
  R2ARR=>T2ARR
  C2ARR=>T3ARR
   
  CALL C_F_POINTER(C_LOC(A), A2)
  CALL C_F_POINTER(C_LOC(B), B2)
  CALL C_F_POINTER(C_LOC(R2ARR),A22,[4])
  CALL C_F_POINTER(C_LOC(C2ARR), B22,[5])
 IF(A2 /= 44.5_2)PRINT*,"101"
 IF(B2 /= (5.5_2,6.5_2))PRINT*,"102"
 IF(ANY(A22 /= 66.5_2))PRINT*,"103"
 IF(ANY(B22 /= (7.5_2,8.5_2)))PRINT*,"104"
END SUBROUTINE 
END


