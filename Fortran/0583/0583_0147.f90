TYPE TY
TYPE (TT), ALLOCATABLE :: OBJTT
END TYPE

TYPE TT
CHARACTER(LEN=:),ALLOCATABLE :: MSG
END TYPE

TYPE(TY) :: OBJ1
TYPE(TY) :: OBJ2

ALLOCATE(OBJ1%OBJTT)
ALLOCATE(CHARACTER(LEN=5)::OBJ1%OBJTT%MSG)

ALLOCATE(OBJ2%OBJTT)
ALLOCATE(CHARACTER(LEN=5)::OBJ2%OBJTT%MSG)

OBJ1%OBJTT%MSG = "HELLO"
OBJ2%OBJTT%MSG = "WORLD"

OBJ1 = OBJ2

OBJ2%OBJTT%MSG = "NIGHT"

if (.NOT.ALLOCATED(OBJ1%OBJTT%MSG)) print*, 101
if (OBJ1%OBJTT%MSG /= "WORLD") print*, 102
if (LEN(OBJ1%OBJTT%MSG) /= 5) print*, 103

print*,"PASS"
END
