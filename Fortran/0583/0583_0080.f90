TYPE TY0
INTEGER,ALLOCATABLE :: JJ
TYPE(TY1),ALLOCATABLE :: NODE2
END TYPE

TYPE TY1
INTEGER,ALLOCATABLE :: II
CHARACTER(LEN=:),ALLOCATABLE :: MSG
TYPE(TY0), ALLOCATABLE :: NODE1
END TYPE

TYPE(TY1),ALLOCATABLE :: OBJ
TYPE(TY1),ALLOCATABLE :: OBJ2

ALLOCATE(OBJ)
ALLOCATE(OBJ%II)
ALLOCATE(CHARACTER(LEN=5)::OBJ%MSG)
ALLOCATE(OBJ%NODE1)
ALLOCATE(OBJ%NODE1%JJ)
ALLOCATE(OBJ%NODE1%NODE2)
ALLOCATE(OBJ%NODE1%NODE2%II)
ALLOCATE(CHARACTER(LEN=5)::OBJ%NODE1%NODE2%MSG)
ALLOCATE(OBJ%NODE1%NODE2%NODE1)
ALLOCATE(OBJ%NODE1%NODE2%NODE1%JJ)
ALLOCATE(OBJ%NODE1%NODE2%NODE1%NODE2)
ALLOCATE(OBJ%NODE1%NODE2%NODE1%NODE2%II)
ALLOCATE(CHARACTER(LEN=5)::OBJ%NODE1%NODE2%NODE1%NODE2%MSG)
ALLOCATE(OBJ%NODE1%NODE2%NODE1%NODE2%NODE1)
ALLOCATE(OBJ%NODE1%NODE2%NODE1%NODE2%NODE1%JJ)

OBJ%II = 11
OBJ%MSG = "HELLO"
OBJ%NODE1%JJ = 12
OBJ%NODE1%NODE2%II = 13
OBJ%NODE1%NODE2%MSG = "WORLD"
OBJ%NODE1%NODE2%NODE1%JJ = 14
OBJ%NODE1%NODE2%NODE1%NODE2%II = 15
OBJ%NODE1%NODE2%NODE1%NODE2%MSG = "NIGHT"
OBJ%NODE1%NODE2%NODE1%NODE2%NODE1%JJ = 16

ALLOCATE(OBJ2)
ALLOCATE(OBJ2%II)
ALLOCATE(CHARACTER(LEN=6)::OBJ2%MSG)
ALLOCATE(OBJ2%NODE1)
ALLOCATE(OBJ2%NODE1%JJ)
ALLOCATE(OBJ2%NODE1%NODE2)
ALLOCATE(OBJ2%NODE1%NODE2%II)
ALLOCATE(OBJ2%NODE1%NODE2%NODE1)
ALLOCATE(OBJ2%NODE1%NODE2%NODE1%JJ)
ALLOCATE(OBJ2%NODE1%NODE2%NODE1%NODE2)
ALLOCATE(OBJ2%NODE1%NODE2%NODE1%NODE2%II)
ALLOCATE(CHARACTER(LEN=6)::OBJ2%NODE1%NODE2%NODE1%NODE2%MSG)
ALLOCATE(OBJ2%NODE1%NODE2%NODE1%NODE2%NODE1)
ALLOCATE(OBJ2%NODE1%NODE2%NODE1%NODE2%NODE1%JJ)

OBJ2%II = 21
OBJ2%MSG = "HELLOO"
OBJ2%NODE1%JJ = 22
OBJ2%NODE1%NODE2%II = 23
OBJ2%NODE1%NODE2%NODE1%JJ = 24
OBJ2%NODE1%NODE2%NODE1%NODE2%II = 25
OBJ2%NODE1%NODE2%NODE1%NODE2%MSG = "NIGHTT"
OBJ2%NODE1%NODE2%NODE1%NODE2%NODE1%JJ = 26

OBJ=OBJ2

OBJ2%II = 31
OBJ2%MSG = "OOLLEH"
OBJ2%NODE1%JJ = 32
OBJ2%NODE1%NODE2%II = 33
OBJ2%NODE1%NODE2%NODE1%JJ = 34
OBJ2%NODE1%NODE2%NODE1%NODE2%II = 35
OBJ2%NODE1%NODE2%NODE1%NODE2%MSG = "TTGHIN"
OBJ2%NODE1%NODE2%NODE1%NODE2%NODE1%JJ = 36

if (OBJ%II /= 21) print*, 101
if (OBJ%MSG /= "HELLOO") print*, 102
if (OBJ%NODE1%JJ /= 22) print*, 103
if (OBJ%NODE1%NODE2%II /= 23) print*, 104
if (OBJ%NODE1%NODE2%NODE1%JJ /= 24) print*, 105
if (OBJ%NODE1%NODE2%NODE1%NODE2%II /= 25) print*, 106
if (OBJ%NODE1%NODE2%NODE1%NODE2%MSG /= "NIGHTT") print*, 107
if (OBJ%NODE1%NODE2%NODE1%NODE2%NODE1%JJ /= 26) print*, 108
print*,"PASS"
END
