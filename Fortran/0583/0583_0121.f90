MODULE MOD1
TYPE TY0
INTEGER,ALLOCATABLE :: II(:)
TYPE(TY0),ALLOCATABLE :: NODE0(:)
TYPE(TY),ALLOCATABLE :: NODE4(:)
INTEGER :: JJ
TYPE(TY1),ALLOCATABLE :: NODE7(:)
END TYPE

TYPE TY1
INTEGER,ALLOCATABLE :: II(:)
TYPE(TY1), ALLOCATABLE :: NODE1(:)
TYPE(TY0) :: NODE2(5)
TYPE(TY0) :: NODE5(3,3)
INTEGER :: JJ
END TYPE

TYPE TY
INTEGER,ALLOCATABLE :: II(:)
TYPE(TY1):: NODE3(4)
INTEGER :: JJ
TYPE(TY),ALLOCATABLE :: NODE6(:)
END TYPE

TYPE BASE
TYPE(TY) :: OBJ(3)
TYPE(TY) :: OBJ2(6)
END TYPE

TYPE(BASE):: OBJ_BASE

CONTAINS
SUBROUTINE SUB1()
ALLOCATE(OBJ_BASE%OBJ2(4)%II(3))

ALLOCATE(OBJ_BASE%OBJ2(4)%NODE6(4))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE6(3)%II(3))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%II(3))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE1(4))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE1(3)%II(3))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE1(3)%NODE1(4))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE1(3)%NODE1(3)%II(3))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE1(3)%NODE2(3)%II(3))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE1(3)%NODE5(3,3)%II(3))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE2(3)%II(3))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE5(3,3)%II(3))

ALLOCATE(OBJ_BASE%OBJ2(4)%NODE6(3)%NODE6(4))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE6(3)%NODE6(3)%II(3))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE6(3)%NODE6(3)%NODE6(4))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE6(3)%NODE6(3)%NODE6(3)%II(3))

ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%II(3))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(4))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%II(3))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE1(5))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE1(3)%II(3))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE2(3)%II(3))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE2(3)%NODE0(4))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE2(3)%NODE0(3)%II(3))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE2(3)%NODE0(3)%NODE0(4))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE2(3)%NODE0(3)%NODE0(3)%II(3))

ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE2(3)%II(3))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE2(3)%NODE0(5))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE2(3)%NODE0(4)%II(3))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE2(3)%NODE0(4)%NODE0(5))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE2(3)%NODE0(4)%NODE0(4)%II(3))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE2(3)%NODE0(4)%NODE0(4)%NODE0(5))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE2(3)%NODE0(4)%NODE0(4)%NODE0(4)%II(3))

OBJ_BASE%OBJ2(4)%II = 20
OBJ_BASE%OBJ2(4)%NODE3(3)%II = 21
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%II = 22
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE1(3)%II = 23
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE2(3)%II = 24
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE2(3)%NODE0(3)%II = 25
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE2(3)%NODE0(3)%NODE0(3)%II = 26

OBJ_BASE%OBJ2(4)%NODE3(3)%NODE2(3)%II = 27
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE2(3)%NODE0(4)%II = 28
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE2(3)%NODE0(4)%NODE0(4)%II = 29
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE2(3)%NODE0(4)%NODE0(4)%NODE0(4)%II = 299

OBJ_BASE%OBJ2(4)%NODE6(3)%II = 121
OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%II = 122
OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE1(3)%II = 123
OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE1(3)%NODE1(3)%II = 124
OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE1(3)%NODE2(3)%II = 125
OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE1(3)%NODE5(3,3)%II = 126
OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE2(3)%II = 127
OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE5(3,3)%II = 128


CALL SUB2(OBJ_BASE%OBJ)

OBJ_BASE%OBJ2(4)%II = 30
OBJ_BASE%OBJ2(4)%NODE3(3)%II = 31
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%II = 32
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE1(3)%II = 33
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE2(3)%II = 34
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE2(3)%NODE0(3)%II = 35
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE2(3)%NODE0(3)%NODE0(3)%II = 36

OBJ_BASE%OBJ2(4)%NODE3(3)%NODE2(3)%II = 37
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE2(3)%NODE0(4)%II = 38
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE2(3)%NODE0(4)%NODE0(4)%II = 39
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE2(3)%NODE0(4)%NODE0(4)%NODE0(4)%II = 399

OBJ_BASE%OBJ2(4)%NODE6(3)%II = 131
OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%II = 132
OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE1(3)%II = 133
OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE1(3)%NODE1(3)%II = 134
OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE1(3)%NODE2(3)%II = 135
OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE1(3)%NODE5(3,3)%II = 136
OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE2(3)%II = 137
OBJ_BASE%OBJ2(4)%NODE6(3)%NODE3(3)%NODE5(3,3)%II = 138

IF (OBJ_BASE%OBJ(2)%II(3) /= 20) print*, 102
IF (OBJ_BASE%OBJ(2)%NODE3(3)%II(3) /= 21) print*, 103
IF (OBJ_BASE%OBJ(2)%NODE3(3)%NODE1(3)%II(3) /= 22) print*, 104
IF (OBJ_BASE%OBJ(2)%NODE3(3)%NODE1(3)%NODE1(3)%II(3) /= 23) print*, 105
IF (OBJ_BASE%OBJ(2)%NODE3(3)%NODE1(3)%NODE2(3)%II(3) /= 24) print*, 106
IF (OBJ_BASE%OBJ(2)%NODE3(3)%NODE1(3)%NODE2(3)%NODE0(3)%II(3) /= 25) print*, 107
IF (OBJ_BASE%OBJ(2)%NODE3(3)%NODE1(3)%NODE2(3)%NODE0(3)%NODE0(3)%II(3) /= 26) print*, 108

IF (OBJ_BASE%OBJ(2)%NODE3(3)%NODE2(3)%II(3) /= 27) print*, 109
IF (OBJ_BASE%OBJ(2)%NODE3(3)%NODE2(3)%NODE0(4)%II(3) /= 28) print*, 110
IF (OBJ_BASE%OBJ(2)%NODE3(3)%NODE2(3)%NODE0(4)%NODE0(4)%II(3) /= 29) print*, 111
IF (OBJ_BASE%OBJ(2)%NODE3(3)%NODE2(3)%NODE0(4)%NODE0(4)%NODE0(4)%II(3) /= 299) print*, 112

IF (OBJ_BASE%OBJ(2)%NODE6(3)%II(3)  /= 121) print*, 913
IF (OBJ_BASE%OBJ(2)%NODE6(3)%NODE3(3)%II(3)  /= 122) print*, 914
IF (OBJ_BASE%OBJ(2)%NODE6(3)%NODE3(3)%NODE1(3)%II(3)  /= 123) print*, 915
IF (OBJ_BASE%OBJ(2)%NODE6(3)%NODE3(3)%NODE1(3)%NODE1(3)%II(3)  /= 124) print*, 916
IF (OBJ_BASE%OBJ(2)%NODE6(3)%NODE3(3)%NODE1(3)%NODE2(3)%II(3)  /= 125) print*, 917
IF (OBJ_BASE%OBJ(2)%NODE6(3)%NODE3(3)%NODE1(3)%NODE5(3,3)%II(3)  /= 126) print*, 918
IF (OBJ_BASE%OBJ(2)%NODE6(3)%NODE3(3)%NODE2(3)%II(3)  /= 127) print*, 919
IF (OBJ_BASE%OBJ(2)%NODE6(3)%NODE3(3)%NODE5(3,3)%II(3)  /= 128) print*, 920

print*,"PASS"
END SUBROUTINE

SUBROUTINE SUB2 (ARG)
TYPE(TY), INTENT(OUT) :: ARG(:)
TYPE(TY) :: OBJ1(3)

OBJ1 = OBJ_BASE%OBJ2(3:5)
ARG  = OBJ1
END SUBROUTINE
END MODULE

USE MOD1

CALL SUB1()
END
