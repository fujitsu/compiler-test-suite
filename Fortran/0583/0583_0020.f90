TYPE TY0
INTEGER,ALLOCATABLE:: II(:)
TYPE(TY2),ALLOCATABLE :: NODE0
END TYPE

TYPE TY1
INTEGER,ALLOCATABLE:: JJ(:)
TYPE(TY0), ALLOCATABLE :: NODE1
END TYPE

TYPE TY2
INTEGER,ALLOCATABLE:: KK(:)
TYPE(TY1), ALLOCATABLE :: NODE2(:)
END TYPE

TYPE TY
TYPE(TY2),ALLOCATABLE :: OBJ(:)
TYPE(TY2),ALLOCATABLE :: OBJ2(:)
END TYPE

TYPE(TY)::BASE

ALLOCATE(BASE%OBJ2(2))
ALLOCATE(BASE%OBJ2(2)%KK(4))
ALLOCATE(BASE%OBJ2(2)%NODE2(3))
ALLOCATE(BASE%OBJ2(2)%NODE2(3)%JJ(5))
ALLOCATE(BASE%OBJ2(2)%NODE2(3)%NODE1)
ALLOCATE(BASE%OBJ2(2)%NODE2(3)%NODE1%II(6))
ALLOCATE(BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0)
ALLOCATE(BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%KK(4))
ALLOCATE(BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(4))
ALLOCATE(BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%JJ(5))
ALLOCATE(BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1)
ALLOCATE(BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%II(6))
ALLOCATE(BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0)
ALLOCATE(BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%KK(4))
ALLOCATE(BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%NODE2(5))
ALLOCATE(BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%NODE2(3)%JJ(5))
ALLOCATE(BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1)
ALLOCATE(BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%II(6))
ALLOCATE(BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0)

BASE%OBJ2(2)%KK = 20
BASE%OBJ2(2)%NODE2(3)%JJ = 21
BASE%OBJ2(2)%NODE2(3)%NODE1%II = 22
BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%KK = 23
BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%JJ = 24
BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%II = 25
BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%KK = 26
BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%NODE2(3)%JJ = 27
BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%II = 28

ALLOCATE(BASE%OBJ, SOURCE=BASE%OBJ2)

BASE%OBJ2(2)%KK = 30
BASE%OBJ2(2)%NODE2(3)%JJ = 31
BASE%OBJ2(2)%NODE2(3)%NODE1%II = 32
BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%KK = 33
BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%JJ = 34
BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%II = 35
BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%KK = 36
BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%NODE2(3)%JJ = 37
BASE%OBJ2(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%II = 38

if (SIZE(BASE%OBJ) /= 2)  print*, 910
if (SIZE(BASE%OBJ(2)%KK) /= 4)  print*, 911
if (SIZE(BASE%OBJ(2)%NODE2(3)%JJ) /= 5)  print*, 912
if (SIZE(BASE%OBJ(2)%NODE2(3)%NODE1%II) /= 6)  print*, 913
if (SIZE(BASE%OBJ(2)%NODE2(3)%NODE1%NODE0%KK) /= 4)  print*, 914
if (SIZE(BASE%OBJ(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%JJ) /= 5)  print*, 915
if (SIZE(BASE%OBJ(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%II) /= 6)  print*, 916
if (SIZE(BASE%OBJ(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%KK) /= 4)  print*, 917
if (SIZE(BASE%OBJ(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%NODE2(3)%JJ) /= 5)  print*, 918
if (SIZE(BASE%OBJ(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%II) /= 6)  print*, 919

if (BASE%OBJ(2)%KK(1) /= 20) print*, 101
if (BASE%OBJ(2)%NODE2(3)%JJ(2) /= 21) print*, 102
if (BASE%OBJ(2)%NODE2(3)%NODE1%II(3) /= 22) print*, 103
if (BASE%OBJ(2)%NODE2(3)%NODE1%NODE0%KK(3) /= 23) print*, 104
if (BASE%OBJ(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%JJ(2) /= 24) print*, 105
if (BASE%OBJ(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%II(1) /= 25) print*, 106
if (BASE%OBJ(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%KK(2) /= 26) print*, 107
if (BASE%OBJ(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%NODE2(3)%JJ(1) /= 27) print*, 108
if (BASE%OBJ(2)%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%NODE0%NODE2(3)%NODE1%II(2) /= 28) print*, 109

print*,"PASS"
END
