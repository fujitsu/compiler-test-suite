TYPE TY0
INTEGER,ALLOCATABLE :: II
TYPE(TY0),ALLOCATABLE :: NODE0(:)
END TYPE

TYPE TY1
INTEGER,ALLOCATABLE :: II
TYPE(TY1), ALLOCATABLE :: NODE1
TYPE(TY0),ALLOCATABLE :: NODE2
END TYPE

TYPE TY
INTEGER,ALLOCATABLE :: II
TYPE(TY1) :: NODE3
END TYPE

TYPE BASE
TYPE(TY) :: OBJ2(6)
END TYPE

TYPE(BASE):: OBJ_BASE

ALLOCATE(OBJ_BASE%OBJ2(4)%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE1)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE1%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE1%NODE1)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE1%NODE1%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE1%NODE2)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE1%NODE2%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE1%NODE2%NODE0(4))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE1%NODE2%NODE0(3)%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE1%NODE2%NODE0(3)%NODE0(4))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE1%NODE2%NODE0(3)%NODE0(3)%II)

ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE2)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE2%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE2%NODE0(5))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE2%NODE0(4)%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE2%NODE0(4)%NODE0(5))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE2%NODE0(4)%NODE0(4)%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE2%NODE0(4)%NODE0(4)%NODE0(5))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3%NODE2%NODE0(4)%NODE0(4)%NODE0(4)%II)

OBJ_BASE%OBJ2(4)%II = 20
OBJ_BASE%OBJ2(4)%NODE3%II = 21
OBJ_BASE%OBJ2(4)%NODE3%NODE1%II = 22
OBJ_BASE%OBJ2(4)%NODE3%NODE1%NODE1%II = 23
OBJ_BASE%OBJ2(4)%NODE3%NODE1%NODE2%II = 24
OBJ_BASE%OBJ2(4)%NODE3%NODE1%NODE2%NODE0(3)%II = 25
OBJ_BASE%OBJ2(4)%NODE3%NODE1%NODE2%NODE0(3)%NODE0(3)%II = 26
OBJ_BASE%OBJ2(4)%NODE3%NODE2%II = 27
OBJ_BASE%OBJ2(4)%NODE3%NODE2%NODE0(4)%II = 28
OBJ_BASE%OBJ2(4)%NODE3%NODE2%NODE0(4)%NODE0(4)%II = 29
OBJ_BASE%OBJ2(4)%NODE3%NODE2%NODE0(4)%NODE0(4)%NODE0(4)%II = 299

IF (FUN(OBJ_BASE%OBJ2) /= 1) PRINT*, 101

OBJ_BASE%OBJ2(4)%II = 30
OBJ_BASE%OBJ2(4)%NODE3%II = 31
OBJ_BASE%OBJ2(4)%NODE3%NODE1%II = 32
OBJ_BASE%OBJ2(4)%NODE3%NODE1%NODE1%II = 33
OBJ_BASE%OBJ2(4)%NODE3%NODE1%NODE2%II = 34
OBJ_BASE%OBJ2(4)%NODE3%NODE1%NODE2%NODE0(3)%II = 35
OBJ_BASE%OBJ2(4)%NODE3%NODE1%NODE2%NODE0(3)%NODE0(3)%II = 36
OBJ_BASE%OBJ2(4)%NODE3%NODE2%II = 37
OBJ_BASE%OBJ2(4)%NODE3%NODE2%NODE0(4)%II = 38
OBJ_BASE%OBJ2(4)%NODE3%NODE2%NODE0(4)%NODE0(4)%II = 39
OBJ_BASE%OBJ2(4)%NODE3%NODE2%NODE0(4)%NODE0(4)%NODE0(4)%II = 399

print*,"PASS"

CONTAINS
FUNCTION FUN (DMY)
TYPE(TY)::DMY(:)
TYPE(TY)::RES(6)
INTEGER :: FUN


RES = DMY

IF (RES(4)%II /= 20) PRINT*, 201
IF (RES(4)%NODE3%II /= 21) PRINT*, 202
IF (RES(4)%NODE3%NODE1%II /= 22) PRINT*, 203
IF (RES(4)%NODE3%NODE1%NODE1%II /= 23) PRINT*, 204
IF (RES(4)%NODE3%NODE1%NODE2%II /= 24) PRINT*, 205
IF (RES(4)%NODE3%NODE1%NODE2%NODE0(3)%II /= 25) PRINT*, 206
IF (RES(4)%NODE3%NODE1%NODE2%NODE0(3)%NODE0(3)%II /= 26) PRINT*, 207
IF (RES(4)%NODE3%NODE2%II /= 27) PRINT*, 208
IF (RES(4)%NODE3%NODE2%NODE0(4)%II /= 28) PRINT*, 209
IF (RES(4)%NODE3%NODE2%NODE0(4)%NODE0(4)%II /=29) PRINT*, 210
IF (RES(4)%NODE3%NODE2%NODE0(4)%NODE0(4)%NODE0(4)%II /= 299) PRINT*, 211

FUN = 1
END FUNCTION
END
