TYPE TY1
INTEGER,ALLOCATABLE::ALC2(:)
INTEGER::KK
END TYPE

TYPE TT
   INTEGER, ALLOCATABLE:: ALC(:)
   TYPE(TY1),ALLOCATABLE:: NODE1
END TYPE
TYPE, EXTENDS(TT)::TY
INTEGER::A
END TYPE

TYPE(TT):: OBJ2
ALLOCATE(OBJ2%ALC(5))
ALLOCATE(OBJ2%NODE1)
ALLOCATE(OBJ2%NODE1%ALC2(5))
OBJ2%ALC = [1,2,3,4,5]
OBJ2%NODE1%ALC2 =[1,2,3,4,5]
OBJ2%NODE1%KK  = 10
CALL SUB(TY(OBJ2,12))
IF(ANY(OBJ2%ALC.NE.[1,2,3,4,5]))PRINT*,"101" , OBJ2%ALC
IF(ANY(OBJ2%NODE1%ALC2.NE.[1,2,3,4,5]))PRINT*,"102" , OBJ2%NODE1%ALC2
IF(OBJ2%NODE1%KK.NE.10)PRINT*,"103"
PRINT*,"PASS"
CONTAINS
SUBROUTINE SUB(DMY1)
TYPE(TY), INTENT(IN) ::DMY1
IF(ANY(DMY1%ALC.NE.[1,2,3,4,5]))PRINT*,"102"
IF(DMY1%A.NE.12)PRINT*,"103"
END SUBROUTINE
END
