TYPE TY0
INTEGER :: JJ = 20
TYPE(TY1),ALLOCATABLE :: NODE2
END TYPE

TYPE TY1
INTEGER :: II = 21
CHARACTER(LEN=5) :: MSG = "HELLO"
TYPE(TY0), ALLOCATABLE :: NODE1
END TYPE

TYPE(TY1),ALLOCATABLE :: OBJ
TYPE(TY1),ALLOCATABLE :: OBJ2

ALLOCATE(OBJ)
ALLOCATE(OBJ%NODE1)
ALLOCATE(OBJ%NODE1%NODE2)
ALLOCATE(OBJ%NODE1%NODE2%NODE1)
ALLOCATE(OBJ%NODE1%NODE2%NODE1%NODE2)
ALLOCATE(OBJ%NODE1%NODE2%NODE1%NODE2%NODE1)

OBJ%II = 11
OBJ%MSG = "JAPAN"
OBJ%NODE1%JJ = 12
OBJ%NODE1%NODE2%II = 13
OBJ%NODE1%NODE2%MSG = "WORLD"
OBJ%NODE1%NODE2%NODE1%JJ = 14
OBJ%NODE1%NODE2%NODE1%NODE2%II = 15
OBJ%NODE1%NODE2%NODE1%NODE2%MSG = "NIGHT"
OBJ%NODE1%NODE2%NODE1%NODE2%NODE1%JJ = 16

ALLOCATE(OBJ2)
ALLOCATE(OBJ2%NODE1)
ALLOCATE(OBJ2%NODE1%NODE2)
ALLOCATE(OBJ2%NODE1%NODE2%NODE1)
ALLOCATE(OBJ2%NODE1%NODE2%NODE1%NODE2)
ALLOCATE(OBJ2%NODE1%NODE2%NODE1%NODE2%NODE1)

OBJ=OBJ2

OBJ2%II = 31
OBJ2%MSG = "OLLEH"
OBJ2%NODE1%JJ = 32
OBJ2%NODE1%NODE2%II = 33
OBJ2%NODE1%NODE2%NODE1%JJ = 34
OBJ2%NODE1%NODE2%NODE1%NODE2%II = 35
OBJ2%NODE1%NODE2%NODE1%NODE2%MSG = "TGHIN"
OBJ2%NODE1%NODE2%NODE1%NODE2%NODE1%JJ = 36

if (OBJ%II /= 21) print*, 101
if (OBJ%MSG /= "HELLO") print*, 102
if (OBJ%NODE1%JJ /= 20) print*, 103
if (OBJ%NODE1%NODE2%II /= 21) print*, 104
if (OBJ%NODE1%NODE2%NODE1%JJ /= 20) print*, 105
if (OBJ%NODE1%NODE2%NODE1%NODE2%II /= 21) print*, 106
if (OBJ%NODE1%NODE2%NODE1%NODE2%MSG /= "HELLO") print*, 107
if (OBJ%NODE1%NODE2%NODE1%NODE2%NODE1%JJ /= 20) print*, 108
print*,"PASS"
END
