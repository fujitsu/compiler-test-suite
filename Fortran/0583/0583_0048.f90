TYPE NODE
INTEGER,ALLOCATABLE :: VALUE(:)
TYPE (NODE), ALLOCATABLE :: NEXT_NODE(:)
END TYPE

TYPE(NODE),ALLOCATABLE::OBJ

ALLOCATE(OBJ)
ALLOCATE(OBJ%VALUE(3))

ALLOCATE(OBJ%NEXT_NODE(3))
ALLOCATE(OBJ%NEXT_NODE(1)%NEXT_NODE(2))
ALLOCATE(OBJ%NEXT_NODE(1)%NEXT_NODE(1)%NEXT_NODE(3))
ALLOCATE(OBJ%NEXT_NODE(1)%NEXT_NODE(2)%NEXT_NODE(4))
ALLOCATE(OBJ%NEXT_NODE(2)%NEXT_NODE(3))
ALLOCATE(OBJ%NEXT_NODE(3)%NEXT_NODE(4))

ALLOCATE(OBJ%NEXT_NODE(2)%VALUE(2))
ALLOCATE(OBJ%NEXT_NODE(1)%NEXT_NODE(2)%VALUE(3))
ALLOCATE(OBJ%NEXT_NODE(2)%NEXT_NODE(3)%VALUE(4))
ALLOCATE(OBJ%NEXT_NODE(1)%NEXT_NODE(1)%NEXT_NODE(3)%VALUE(5))

OBJ%VALUE = 11
OBJ%VALUE = 12
OBJ%VALUE = 13
OBJ%NEXT_NODE(2)%VALUE = 14
OBJ%NEXT_NODE(1)%NEXT_NODE(2)%VALUE = 15
OBJ%NEXT_NODE(2)%NEXT_NODE(3)%VALUE = 16
OBJ%NEXT_NODE(1)%NEXT_NODE(1)%NEXT_NODE(3)%VALUE = 17

DEALLOCATE(OBJ)

IF (ALLOCATED(OBJ)) print*, 101

print*,"PASS"
END
