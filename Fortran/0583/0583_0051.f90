TYPE NODE
INTEGER,ALLOCATABLE :: VALUE
TYPE (NODE), ALLOCATABLE :: NEXT_NODE(:)
END TYPE

TYPE TY
TYPE(NODE),ALLOCATABLE::OBJ(:)
END TYPE

TYPE(TY) :: OBJ1

ALLOCATE(OBJ1%OBJ(3))
ALLOCATE(OBJ1%OBJ(1)%VALUE)
ALLOCATE(OBJ1%OBJ(2)%VALUE)
ALLOCATE(OBJ1%OBJ(3)%VALUE)

ALLOCATE(OBJ1%OBJ(2)%NEXT_NODE(3))
ALLOCATE(OBJ1%OBJ(2)%NEXT_NODE(1)%NEXT_NODE(2))
ALLOCATE(OBJ1%OBJ(2)%NEXT_NODE(1)%NEXT_NODE(1)%NEXT_NODE(3))
ALLOCATE(OBJ1%OBJ(2)%NEXT_NODE(1)%NEXT_NODE(2)%NEXT_NODE(4))
ALLOCATE(OBJ1%OBJ(2)%NEXT_NODE(2)%NEXT_NODE(3))
ALLOCATE(OBJ1%OBJ(2)%NEXT_NODE(3)%NEXT_NODE(4))

ALLOCATE(OBJ1%OBJ(2)%NEXT_NODE(2)%VALUE)
ALLOCATE(OBJ1%OBJ(2)%NEXT_NODE(1)%NEXT_NODE(2)%VALUE)
ALLOCATE(OBJ1%OBJ(2)%NEXT_NODE(2)%NEXT_NODE(3)%VALUE)
ALLOCATE(OBJ1%OBJ(2)%NEXT_NODE(1)%NEXT_NODE(1)%NEXT_NODE(3)%VALUE)

OBJ1%OBJ(1)%VALUE = 11
OBJ1%OBJ(2)%VALUE = 12
OBJ1%OBJ(3)%VALUE = 13
OBJ1%OBJ(2)%NEXT_NODE(2)%VALUE = 14
OBJ1%OBJ(2)%NEXT_NODE(1)%NEXT_NODE(2)%VALUE = 15
OBJ1%OBJ(2)%NEXT_NODE(2)%NEXT_NODE(3)%VALUE = 16
OBJ1%OBJ(2)%NEXT_NODE(1)%NEXT_NODE(1)%NEXT_NODE(3)%VALUE = 17

DEALLOCATE(OBJ1%OBJ)

IF (ALLOCATED(OBJ1%OBJ)) print*, 101

print*,"PASS"
END
