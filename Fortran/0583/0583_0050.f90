TYPE NODE
INTEGER,ALLOCATABLE :: VALUE
TYPE (NODE), ALLOCATABLE :: NEXT_NODE(:)
END TYPE

TYPE(NODE),ALLOCATABLE::OBJ(:)

ALLOCATE(OBJ(3))
ALLOCATE(OBJ(1)%VALUE)
ALLOCATE(OBJ(2)%VALUE)
ALLOCATE(OBJ(3)%VALUE)

ALLOCATE(OBJ(2)%NEXT_NODE(3))
ALLOCATE(OBJ(2)%NEXT_NODE(1)%NEXT_NODE(2))
ALLOCATE(OBJ(2)%NEXT_NODE(1)%NEXT_NODE(1)%NEXT_NODE(3))
ALLOCATE(OBJ(2)%NEXT_NODE(1)%NEXT_NODE(2)%NEXT_NODE(4))
ALLOCATE(OBJ(2)%NEXT_NODE(2)%NEXT_NODE(3))
ALLOCATE(OBJ(2)%NEXT_NODE(3)%NEXT_NODE(4))

ALLOCATE(OBJ(2)%NEXT_NODE(2)%VALUE)
ALLOCATE(OBJ(2)%NEXT_NODE(1)%NEXT_NODE(2)%VALUE)
ALLOCATE(OBJ(2)%NEXT_NODE(2)%NEXT_NODE(3)%VALUE)
ALLOCATE(OBJ(2)%NEXT_NODE(1)%NEXT_NODE(1)%NEXT_NODE(3)%VALUE)

OBJ(1)%VALUE = 11
OBJ(2)%VALUE = 12
OBJ(3)%VALUE = 13
OBJ(2)%NEXT_NODE(2)%VALUE = 14
OBJ(2)%NEXT_NODE(1)%NEXT_NODE(2)%VALUE = 15
OBJ(2)%NEXT_NODE(2)%NEXT_NODE(3)%VALUE = 16
OBJ(2)%NEXT_NODE(1)%NEXT_NODE(1)%NEXT_NODE(3)%VALUE = 17

DEALLOCATE(OBJ)

IF (ALLOCATED(OBJ)) print*, 101

print*,"PASS"
END
