TYPE NODE
INTEGER :: VALUE = 20
TYPE (NODE), ALLOCATABLE :: NEXT_NODE(:)
END TYPE

TYPE(NODE),ALLOCATABLE :: OBJ1(:)
TYPE(NODE),ALLOCATABLE :: OBJ2(:)

ALLOCATE(OBJ1(3))

ALLOCATE(OBJ1(2)%NEXT_NODE(3))
ALLOCATE(OBJ1(2)%NEXT_NODE(1)%NEXT_NODE(2))
ALLOCATE(OBJ1(2)%NEXT_NODE(1)%NEXT_NODE(1)%NEXT_NODE(3))
ALLOCATE(OBJ1(2)%NEXT_NODE(1)%NEXT_NODE(2)%NEXT_NODE(4))
ALLOCATE(OBJ1(2)%NEXT_NODE(2)%NEXT_NODE(3))
ALLOCATE(OBJ1(2)%NEXT_NODE(3)%NEXT_NODE(4))

OBJ1(1)%VALUE = 11
OBJ1(2)%VALUE = 12
OBJ1(3)%VALUE = 13
OBJ1(2)%NEXT_NODE(2)%VALUE = 14
OBJ1(2)%NEXT_NODE(1)%NEXT_NODE(2)%VALUE = 15
OBJ1(2)%NEXT_NODE(2)%NEXT_NODE(3)%VALUE = 16
OBJ1(2)%NEXT_NODE(1)%NEXT_NODE(1)%NEXT_NODE(3)%VALUE = 17

ALLOCATE(OBJ2(3))

ALLOCATE(OBJ2(3)%NEXT_NODE(2))
ALLOCATE(OBJ2(3)%NEXT_NODE(1)%NEXT_NODE(3))
ALLOCATE(OBJ2(3)%NEXT_NODE(1)%NEXT_NODE(1)%NEXT_NODE(2))
ALLOCATE(OBJ2(3)%NEXT_NODE(1)%NEXT_NODE(2)%NEXT_NODE(3))
ALLOCATE(OBJ2(3)%NEXT_NODE(1)%NEXT_NODE(3)%NEXT_NODE(4))
ALLOCATE(OBJ2(3)%NEXT_NODE(2)%NEXT_NODE(5))
ALLOCATE(OBJ2(3)%NEXT_NODE(2)%NEXT_NODE(2)%NEXT_NODE(5))

OBJ1 = OBJ2

OBJ2(1)%VALUE = 31
OBJ2(3)%VALUE = 32
OBJ2(3)%NEXT_NODE(2)%VALUE = 33
OBJ2(3)%NEXT_NODE(1)%NEXT_NODE(2)%VALUE = 34
OBJ2(3)%NEXT_NODE(2)%NEXT_NODE(3)%VALUE = 35
OBJ2(3)%NEXT_NODE(1)%NEXT_NODE(1)%NEXT_NODE(2)%VALUE = 36

if (OBJ1(1)%VALUE /= 20) print*, 101
if (OBJ1(3)%VALUE /= 20) print*, 102
if (OBJ1(3)%NEXT_NODE(2)%VALUE /= 20) print*, 103, OBJ1(3)%NEXT_NODE(2)%VALUE
if (OBJ1(3)%NEXT_NODE(1)%NEXT_NODE(2)%VALUE /= 20) print*, 104, OBJ1(3)%NEXT_NODE(1)%NEXT_NODE(2)%VALUE
if (OBJ1(3)%NEXT_NODE(2)%NEXT_NODE(3)%VALUE /= 20) print*, 105, OBJ1(3)%NEXT_NODE(2)%NEXT_NODE(3)%VALUE
if (OBJ1(3)%NEXT_NODE(1)%NEXT_NODE(1)%NEXT_NODE(2)%VALUE /= 20) print*, 106, OBJ1(3)%NEXT_NODE(1)%NEXT_NODE(1)%NEXT_NODE(2)%VALUE

if (SIZE(OBJ1(3)%NEXT_NODE) /= 2) print*, 201
if (SIZE(OBJ1(3)%NEXT_NODE(1)%NEXT_NODE) /= 3) print*, 202
if (SIZE(OBJ1(3)%NEXT_NODE(1)%NEXT_NODE(1)%NEXT_NODE) /= 2) print*, 203
if (SIZE(OBJ1(3)%NEXT_NODE(1)%NEXT_NODE(2)%NEXT_NODE) /= 3) print*, 204
if (SIZE(OBJ1(3)%NEXT_NODE(1)%NEXT_NODE(3)%NEXT_NODE) /= 4) print*, 205
if (SIZE(OBJ1(3)%NEXT_NODE(2)%NEXT_NODE) /= 5) print*, 206
if (SIZE(OBJ1(3)%NEXT_NODE(2)%NEXT_NODE(2)%NEXT_NODE) /= 5) print*, 207

print*,"PASS"
END
