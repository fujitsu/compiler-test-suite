TYPE TY0
INTEGER,ALLOCATABLE :: II
TYPE(TY0),ALLOCATABLE :: NODE0
END TYPE

TYPE TY1
INTEGER,ALLOCATABLE :: II
TYPE(TY1), ALLOCATABLE :: NODE1
TYPE(TY0),ALLOCATABLE :: NODE2
END TYPE

TYPE TY
INTEGER,ALLOCATABLE :: II
TYPE(TY1), ALLOCATABLE :: NODE3
END TYPE

TYPE(TY),ALLOCATABLE :: OBJ
TYPE(TY),ALLOCATABLE :: OBJ2

ALLOCATE(OBJ)
ALLOCATE(OBJ%II)
ALLOCATE(OBJ%NODE3)
ALLOCATE(OBJ%NODE3%II)
ALLOCATE(OBJ%NODE3%NODE1)
ALLOCATE(OBJ%NODE3%NODE1%II)
ALLOCATE(OBJ%NODE3%NODE1%NODE1)
ALLOCATE(OBJ%NODE3%NODE1%NODE1%II)
ALLOCATE(OBJ%NODE3%NODE1%NODE2)
ALLOCATE(OBJ%NODE3%NODE1%NODE2%II)
ALLOCATE(OBJ%NODE3%NODE1%NODE2%NODE0)
ALLOCATE(OBJ%NODE3%NODE1%NODE2%NODE0%II)
ALLOCATE(OBJ%NODE3%NODE1%NODE2%NODE0%NODE0)
ALLOCATE(OBJ%NODE3%NODE1%NODE2%NODE0%NODE0%II)

ALLOCATE(OBJ%NODE3%NODE2)
ALLOCATE(OBJ%NODE3%NODE2%II)
ALLOCATE(OBJ%NODE3%NODE2%NODE0)
ALLOCATE(OBJ%NODE3%NODE2%NODE0%II)
ALLOCATE(OBJ%NODE3%NODE2%NODE0%NODE0)
ALLOCATE(OBJ%NODE3%NODE2%NODE0%NODE0%II)
ALLOCATE(OBJ%NODE3%NODE2%NODE0%NODE0%NODE0)
ALLOCATE(OBJ%NODE3%NODE2%NODE0%NODE0%NODE0%II)

ALLOCATE(OBJ2)
ALLOCATE(OBJ2%II)
ALLOCATE(OBJ2%NODE3)
ALLOCATE(OBJ2%NODE3%II)
ALLOCATE(OBJ2%NODE3%NODE1)
ALLOCATE(OBJ2%NODE3%NODE1%II)
ALLOCATE(OBJ2%NODE3%NODE1%NODE1)
ALLOCATE(OBJ2%NODE3%NODE1%NODE1%II)
ALLOCATE(OBJ2%NODE3%NODE1%NODE2)
ALLOCATE(OBJ2%NODE3%NODE1%NODE2%II)
ALLOCATE(OBJ2%NODE3%NODE1%NODE2%NODE0)
ALLOCATE(OBJ2%NODE3%NODE1%NODE2%NODE0%II)
ALLOCATE(OBJ2%NODE3%NODE1%NODE2%NODE0%NODE0)
ALLOCATE(OBJ2%NODE3%NODE1%NODE2%NODE0%NODE0%II)

ALLOCATE(OBJ2%NODE3%NODE2)
ALLOCATE(OBJ2%NODE3%NODE2%II)
ALLOCATE(OBJ2%NODE3%NODE2%NODE0)
ALLOCATE(OBJ2%NODE3%NODE2%NODE0%II)
ALLOCATE(OBJ2%NODE3%NODE2%NODE0%NODE0)
ALLOCATE(OBJ2%NODE3%NODE2%NODE0%NODE0%II)
ALLOCATE(OBJ2%NODE3%NODE2%NODE0%NODE0%NODE0)
ALLOCATE(OBJ2%NODE3%NODE2%NODE0%NODE0%NODE0%II)

OBJ%II = 10
OBJ%NODE3%II = 11
OBJ%NODE3%NODE1%II = 12
OBJ%NODE3%NODE1%NODE1%II = 13
OBJ%NODE3%NODE1%NODE2%II = 14
OBJ%NODE3%NODE1%NODE2%NODE0%II = 15
OBJ%NODE3%NODE1%NODE2%NODE0%NODE0%II = 16
OBJ%NODE3%NODE2%II = 17
OBJ%NODE3%NODE2%NODE0%II = 18
OBJ%NODE3%NODE2%NODE0%NODE0%II = 19
OBJ%NODE3%NODE2%NODE0%NODE0%NODE0%II = 199

OBJ2%II = 20
OBJ2%NODE3%II = 21
OBJ2%NODE3%NODE1%II = 22
OBJ2%NODE3%NODE1%NODE1%II = 23
OBJ2%NODE3%NODE1%NODE2%II = 24
OBJ2%NODE3%NODE1%NODE2%NODE0%II = 25
OBJ2%NODE3%NODE1%NODE2%NODE0%NODE0%II = 26
OBJ2%NODE3%NODE2%II = 27
OBJ2%NODE3%NODE2%NODE0%II = 28
OBJ2%NODE3%NODE2%NODE0%NODE0%II = 29
OBJ2%NODE3%NODE2%NODE0%NODE0%NODE0%II = 299

CALL SUB(OBJ, OBJ2)

OBJ2%II = 30
OBJ2%NODE3%II = 31
OBJ2%NODE3%NODE1%II = 32
OBJ2%NODE3%NODE1%NODE1%II = 33
OBJ2%NODE3%NODE1%NODE2%II = 34
OBJ2%NODE3%NODE1%NODE2%NODE0%II = 35
OBJ2%NODE3%NODE1%NODE2%NODE0%NODE0%II = 36
OBJ2%NODE3%NODE2%II = 37
OBJ2%NODE3%NODE2%NODE0%II = 38
OBJ2%NODE3%NODE2%NODE0%NODE0%II = 39

if (OBJ%II /= 20) print*, 102
if (OBJ%NODE3%II /= 21) print*, 103
if (OBJ%NODE3%NODE1%II /= 22) print*, 104
if (OBJ%NODE3%NODE1%NODE1%II /= 23) print*, 105
if (OBJ%NODE3%NODE1%NODE2%II /= 24) print*, 106
if (OBJ%NODE3%NODE1%NODE2%NODE0%II /= 25) print*, 107
if (OBJ%NODE3%NODE1%NODE2%NODE0%NODE0%II /= 26) print*, 108
if (OBJ%NODE3%NODE2%II /= 27) print*, 109
if (OBJ%NODE3%NODE2%NODE0%II /= 28) print*, 110
if (OBJ%NODE3%NODE2%NODE0%NODE0%II /= 29) print*, 111
if (OBJ%NODE3%NODE2%NODE0%NODE0%NODE0%II /= 299) print*, 112

print*,"PASS"

CONTAINS
SUBROUTINE SUB (DMY, FUN)
TYPE(TY),ALLOCATABLE,INTENT(OUT)::DMY
TYPE(TY),ALLOCATABLE::FUN

ALLOCATE(DMY)

DMY = FUN

if (DMY%II /= 20) print*, 202
if (DMY%NODE3%II /= 21) print*, 203
if (DMY%NODE3%NODE1%II /= 22) print*, 204
if (DMY%NODE3%NODE1%NODE1%II /= 23) print*, 205
if (DMY%NODE3%NODE1%NODE2%II /= 24) print*, 206
if (DMY%NODE3%NODE1%NODE2%NODE0%II /= 25) print*, 207
if (DMY%NODE3%NODE1%NODE2%NODE0%NODE0%II /= 26) print*, 208
if (DMY%NODE3%NODE2%II /= 27) print*, 209
if (DMY%NODE3%NODE2%NODE0%II /= 28) print*, 210
if (DMY%NODE3%NODE2%NODE0%NODE0%II /= 29) print*, 211
if (DMY%NODE3%NODE2%NODE0%NODE0%NODE0%II /= 299) print*, 212
END SUBROUTINE
END
