MODULE MOD1
TYPE TY0
INTEGER,ALLOCATABLE :: II
TYPE(TY0),ALLOCATABLE :: NODE0(:)
END TYPE

TYPE TY1
INTEGER,ALLOCATABLE :: II
TYPE(TY1), ALLOCATABLE :: NODE1(:)
TYPE(TY0),POINTER :: PTR
END TYPE

TYPE TY
INTEGER,ALLOCATABLE :: II
TYPE(TY1), ALLOCATABLE :: NODE3(:)
END TYPE

TYPE BASE
TYPE(TY),ALLOCATABLE :: OBJ(:)
TYPE(TY),ALLOCATABLE :: OBJ2(:)
END TYPE

TYPE(BASE):: OBJ_BASE
END MODULE

PROGRAM MAIN

CALL SUB()

CONTAINS
SUBROUTINE SUB()
USE MOD1
ALLOCATE(OBJ_BASE%OBJ(3))
ALLOCATE(OBJ_BASE%OBJ(2)%II)
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(3))
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%II)
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%NODE1(3))
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%NODE1(2)%II)
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%NODE1(2)%NODE1(4))
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%NODE1(2)%NODE1(2)%II)
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%NODE1(2)%PTR)
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%NODE1(2)%PTR%II)
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%NODE1(2)%PTR%NODE0(3))
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%NODE1(2)%PTR%NODE0(2)%II)
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%NODE1(2)%PTR%NODE0(2)%NODE0(3))
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%NODE1(2)%PTR%NODE0(2)%NODE0(2)%II)

ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%PTR)
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%PTR%II)
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%PTR%NODE0(4))
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%PTR%NODE0(3)%II)
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%PTR%NODE0(3)%NODE0(4))
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%PTR%NODE0(3)%NODE0(3)%II)
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%PTR%NODE0(3)%NODE0(3)%NODE0(4))
ALLOCATE(OBJ_BASE%OBJ(2)%NODE3(2)%PTR%NODE0(3)%NODE0(3)%NODE0(3)%II)

ALLOCATE(OBJ_BASE%OBJ2(6))
ALLOCATE(OBJ_BASE%OBJ2(4)%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(4))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(4))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE1(5))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE1(3)%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%PTR)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%PTR%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%PTR%NODE0(4))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%PTR%NODE0(3)%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%PTR%NODE0(3)%NODE0(4))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%PTR%NODE0(3)%NODE0(3)%II)

ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%PTR)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%PTR%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%PTR%NODE0(5))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%PTR%NODE0(4)%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%PTR%NODE0(4)%NODE0(5))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%PTR%NODE0(4)%NODE0(4)%II)
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%PTR%NODE0(4)%NODE0(4)%NODE0(5))
ALLOCATE(OBJ_BASE%OBJ2(4)%NODE3(3)%PTR%NODE0(4)%NODE0(4)%NODE0(4)%II)

OBJ_BASE%OBJ(2)%II = 10
OBJ_BASE%OBJ(2)%NODE3(2)%II = 11
OBJ_BASE%OBJ(2)%NODE3(2)%NODE1(2)%II = 12
OBJ_BASE%OBJ(2)%NODE3(2)%NODE1(2)%NODE1(2)%II = 13
OBJ_BASE%OBJ(2)%NODE3(2)%NODE1(2)%PTR%II = 14
OBJ_BASE%OBJ(2)%NODE3(2)%NODE1(2)%PTR%NODE0(2)%II = 15
OBJ_BASE%OBJ(2)%NODE3(2)%NODE1(2)%PTR%NODE0(2)%NODE0(2)%II = 16
OBJ_BASE%OBJ(2)%NODE3(2)%PTR%II = 17
OBJ_BASE%OBJ(2)%NODE3(2)%PTR%NODE0(3)%II = 18
OBJ_BASE%OBJ(2)%NODE3(2)%PTR%NODE0(3)%NODE0(3)%II = 19
OBJ_BASE%OBJ(2)%NODE3(2)%PTR%NODE0(3)%NODE0(3)%NODE0(3)%II = 199

OBJ_BASE%OBJ2(4)%II = 20
OBJ_BASE%OBJ2(4)%NODE3(3)%II = 21
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%II = 22
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE1(3)%II = 23
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%PTR%II = 24
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%PTR%NODE0(3)%II = 25
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%PTR%NODE0(3)%NODE0(3)%II = 26
OBJ_BASE%OBJ2(4)%NODE3(3)%PTR%II = 27
OBJ_BASE%OBJ2(4)%NODE3(3)%PTR%NODE0(4)%II = 28
OBJ_BASE%OBJ2(4)%NODE3(3)%PTR%NODE0(4)%NODE0(4)%II = 29
OBJ_BASE%OBJ2(4)%NODE3(3)%PTR%NODE0(4)%NODE0(4)%NODE0(4)%II = 299

OBJ_BASE%OBJ = OBJ_BASE%OBJ2(3:5)

OBJ_BASE%OBJ2(4)%II = 30
OBJ_BASE%OBJ2(4)%NODE3(3)%II = 31
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%II = 32
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%NODE1(3)%II = 33
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%PTR%II = 34
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%PTR%NODE0(3)%II = 35
OBJ_BASE%OBJ2(4)%NODE3(3)%NODE1(3)%PTR%NODE0(3)%NODE0(3)%II = 36
OBJ_BASE%OBJ2(4)%NODE3(3)%PTR%II = 37
OBJ_BASE%OBJ2(4)%NODE3(3)%PTR%NODE0(4)%II = 38
OBJ_BASE%OBJ2(4)%NODE3(3)%PTR%NODE0(4)%NODE0(4)%II = 39
OBJ_BASE%OBJ2(4)%NODE3(3)%PTR%NODE0(4)%NODE0(4)%NODE0(4)%II = 399

IF (OBJ_BASE%OBJ(2)%II /= 20) print*, 102
IF (OBJ_BASE%OBJ(2)%NODE3(3)%II /= 21) print*, 103
IF (OBJ_BASE%OBJ(2)%NODE3(3)%NODE1(3)%II /= 22) print*, 104
IF (OBJ_BASE%OBJ(2)%NODE3(3)%NODE1(3)%NODE1(3)%II /= 23) print*, 105
IF (OBJ_BASE%OBJ(2)%NODE3(3)%NODE1(3)%PTR%II /= 34) print*, 106
IF (OBJ_BASE%OBJ(2)%NODE3(3)%NODE1(3)%PTR%NODE0(3)%II /= 35) print*, 107
IF (OBJ_BASE%OBJ(2)%NODE3(3)%NODE1(3)%PTR%NODE0(3)%NODE0(3)%II /= 36) print*, 108
IF (OBJ_BASE%OBJ(2)%NODE3(3)%PTR%II /= 37) print*, 109
IF (OBJ_BASE%OBJ(2)%NODE3(3)%PTR%NODE0(4)%II /= 38) print*, 110
IF (OBJ_BASE%OBJ(2)%NODE3(3)%PTR%NODE0(4)%NODE0(4)%II /= 39) print*, 111
IF (OBJ_BASE%OBJ(2)%NODE3(3)%PTR%NODE0(4)%NODE0(4)%NODE0(4)%II /= 399) print*, 112

print*,"PASS"
END SUBROUTINE
END
