SUBROUTINE EX_SUB()
         TYPE TY
         INTEGER :: JJ
         INTEGER,ALLOCATABLE :: ALC
         REAL,ALLOCATABLE :: REALALC
         END TYPE
        TYPE TY1
         INTEGER :: II
        INTEGER,ALLOCATABLE :: ALC2
        TYPE(TY), ALLOCATABLE :: NODE2
        END TYPE

        TYPE TY2
         INTEGER :: KK
        TYPE(TY1), ALLOCATABLE :: NODE3
        END TYPE

        TYPE TY3
         INTEGER :: LL
        TYPE(TY1), ALLOCATABLE :: NODE4
        TYPE(TY2), ALLOCATABLE :: NODE5
        END TYPE
        TYPE(TY1),ALLOCATABLE :: OBJ3
        TYPE(TY2),ALLOCATABLE :: OBJ2
 
        integer,allocatable::tt1
        ALLOCATE(OBJ2)
        ALLOCATE(OBJ2%NODE3)
        ALLOCATE(OBJ2%NODE3%ALC2)
        ALLOCATE(OBJ2%NODE3%NODE2)
        ALLOCATE(OBJ2%NODE3%NODE2%REALALC)
        ALLOCATE(OBJ2%NODE3%NODE2%ALC)
        ALLOCATE(OBJ3)
        ALLOCATE(OBJ3%NODE2)
        ALLOCATE(OBJ3%ALC2)
        ALLOCATE(OBJ3%NODE2%ALC)
        ALLOCATE(OBJ3%NODE2%REALALC)
        OBJ2%KK = 4
        OBJ2%NODE3%ALC2 = 5
        OBJ2%NODE3%II=15
        OBJ2%NODE3%NODE2%ALC = 6
        OBJ2%NODE3%NODE2%REALALC = 6.0
        OBJ2%NODE3%NODE2%JJ = 12
        OBJ3%II = 91
        OBJ3%ALC2 = 92
        OBJ3%NODE2%ALC =93
        OBJ3%NODE2%REALALC = 94.5
        CALL SUB(TY3(18,OBJ3,OBJ2))
        CALL SUB(TY3(19,OBJ3,OBJ2))
        CALL SUB(TY3(11,OBJ3,OBJ2))
        CALL SUB(TY3(12,OBJ3,OBJ2))
        allocate(tt1)
        tt1 =30
        IF(OBJ2%NODE3%ALC2.NE.5)PRINT*,"101", OBJ2%NODE3%ALC2
        IF(OBJ2%NODE3%II.NE.15)PRINT*,"102", OBJ2%NODE3%II
        IF(OBJ2%NODE3%NODE2%ALC.NE.6)PRINT*,"103", OBJ2%NODE3%NODE2%ALC
        IF(OBJ2%NODE3%NODE2%REALALC.NE.6.0)PRINT*,"111", OBJ2%NODE3%NODE2%REALALC
        IF(OBJ2%NODE3%NODE2%JJ.NE.12)PRINT*,"112", OBJ2%NODE3%NODE2%JJ
        IF(OBJ3%II.NE.91)PRINT*,"201",OBJ3%II
        IF(OBJ3%ALC2.NE.92)PRINT*,"202",OBJ3%ALC2
        IF(OBJ3%NODE2%ALC.NE.93)PRINT*,"203",OBJ3%NODE2%ALC
        IF(OBJ3%NODE2%REALALC.NE.94.5)PRINT*,"204",OBJ3%NODE2%REALALC
        PRINT*,"PASS"
        CONTAINS
        SUBROUTINE SUB(OBJ)
        TYPE(TY3):: OBJ
        IF(OBJ%NODE5%NODE3%ALC2.NE.5)PRINT*,"103", OBJ%NODE5%NODE3%ALC2
        IF(OBJ%NODE5%NODE3%NODE2%ALC.NE.6)PRINT*,"104",OBJ%NODE5%NODE3%NODE2%ALC
        IF(OBJ%NODE5%NODE3%NODE2%REALALC.NE.6.0)PRINT*,"105", OBJ%NODE5%NODE3%NODE2%REALALC
        IF(OBJ%NODE4%II.NE.91)PRINT*,"201",OBJ3%II
        IF(OBJ%NODE4%ALC2.NE.92)PRINT*,"202",OBJ%NODE4%ALC2
        IF(OBJ%NODE4%NODE2%ALC.NE.93)PRINT*,"203",OBJ%NODE4%NODE2%ALC
        IF(OBJ%NODE4%NODE2%REALALC.NE.94.5)PRINT*,"204",OBJ%NODE4%NODE2%REALALC
        deallocate(OBJ%NODE4%NODE2%REALALC)
        deallocate(OBJ%NODE4%NODE2%ALC)
        END SUBROUTINE
        END SUBROUTINE
CALL EX_SUB()
END
