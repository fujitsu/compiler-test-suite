PROGRAM MAIN
  IMPLICIT NONE

TYPE BASE
     REAL(KIND=8) ::REAL1
     INTEGER(KIND=8) ::INT1
     INTEGER,ALLOCATABLE::PTR
END TYPE

TYPE ,EXTENDS(BASE)::DERIV
  INTEGER(KIND=8) :: INT2
  REAL(KIND=8) ::REAL2
  INTEGER,ALLOCATABLE::PTR2
END TYPE

TYPE ,EXTENDS(DERIV)::DERIV1
  INTEGER(KIND=8) :: INT3
  REAL(KIND=8) ::REAL3
  INTEGER,ALLOCATABLE::PTR3
  TYPE(DERIV),ALLOCATABLE::DERIV_COM
END TYPE

TYPE CON
  INTEGER::K
  TYPE(DERIV1),ALLOCATABLE::OBJ1
END TYPE

TYPE(CON)::OBJ
INTEGER,ALLOCATABLE::X
CLASS(DERIV1),ALLOCATABLE::DERIV_OBJ
ALLOCATE(DERIV_OBJ)
ALLOCATE(DERIV_OBJ%PTR3)
ALLOCATE(DERIV_OBJ%DERIV_COM)
ALLOCATE(DERIV_OBJ%PTR)
ALLOCATE(DERIV_OBJ%PTR2)
DERIV_OBJ%REAL3= 20.2
DERIV_OBJ%INT3= 21
DERIV_OBJ%PTR3 = 23
DERIV_OBJ%PTR =24
DERIV_OBJ%PTR2 =25
ALLOCATE(OBJ%OBJ1)
CALL SUB(CON(12,DERIV_OBJ))
ALLOCATE(X)
X=45
DEALLOCATE(OBJ%OBJ1)
PRINT*,"PASS"
IF(DERIV_OBJ%REAL3.NE.20.2)PRINT*,"101"
IF(DERIV_OBJ%INT3.NE.21)PRINT*,"102"
IF(DERIV_OBJ%PTR3.NE.23)PRINT*,"103",DERIV_OBJ%PTR3
IF(DERIV_OBJ%PTR2.NE.25)PRINT*,"104",DERIV_OBJ%PTR2
IF(DERIV_OBJ%PTR.NE.24)PRINT*,"105",DERIV_OBJ%PTR
CONTAINS
SUBROUTINE SUB(OBJ)
TYPE(CON)::OBJ
deallocate(OBJ%OBJ1%PTR)
END SUBROUTINE
END

