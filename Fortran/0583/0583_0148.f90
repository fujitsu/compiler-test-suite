MODULE MOD1
TYPE TY
INTEGER,ALLOCATABLE :: VALUE
TYPE (TT), ALLOCATABLE :: OBJTT
END TYPE

TYPE TT
CHARACTER(LEN=:),ALLOCATABLE :: MSG
END TYPE

TYPE(TY),ALLOCATABLE :: OBJ1
TYPE(TY),ALLOCATABLE :: OBJ2
END MODULE

USE MOD1
ALLOCATE(OBJ1)
ALLOCATE(OBJ1%VALUE)
ALLOCATE(OBJ1%OBJTT)
ALLOCATE(CHARACTER(LEN=5)::OBJ1%OBJTT%MSG)

ALLOCATE(OBJ2)
ALLOCATE(OBJ2%VALUE)
ALLOCATE(OBJ2%OBJTT)
ALLOCATE(CHARACTER(LEN=6)::OBJ2%OBJTT%MSG)

OBJ1%VALUE = 10
OBJ1%OBJTT%MSG = "HELLO"

OBJ2%VALUE = 20
OBJ2%OBJTT%MSG = "WORLD"

OBJ1 = OBJ2

OBJ2%VALUE = 30
OBJ2%OBJTT%MSG = "NIGHT"

if (OBJ1%VALUE /= 20) print*, 101
if (OBJ1%OBJTT%MSG /= "WORLD") print*, 102

print*,"PASS"
END
