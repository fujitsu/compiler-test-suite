TYPE NODE
INTEGER,ALLOCATABLE :: VALUE
TYPE (NODE), ALLOCATABLE :: NEXT_NODE
END TYPE

TYPE(NODE),ALLOCATABLE :: OBJ

ALLOCATE(OBJ)
ALLOCATE(OBJ%NEXT_NODE)
ALLOCATE(OBJ%NEXT_NODE%NEXT_NODE)
ALLOCATE(OBJ%NEXT_NODE%NEXT_NODE%NEXT_NODE)

ALLOCATE(OBJ%VALUE)
ALLOCATE(OBJ%NEXT_NODE%VALUE)
ALLOCATE(OBJ%NEXT_NODE%NEXT_NODE%VALUE)
ALLOCATE(OBJ%NEXT_NODE%NEXT_NODE%NEXT_NODE%VALUE)

OBJ%VALUE = 10
OBJ%NEXT_NODE%VALUE = 11
OBJ%NEXT_NODE%NEXT_NODE%VALUE = 12
OBJ%NEXT_NODE%NEXT_NODE%NEXT_NODE%VALUE = 13

CALL SUB(OBJ)

IF (OBJ%VALUE /= 20) PRINT*, 101
IF (OBJ%NEXT_NODE%VALUE /= 21) PRINT*, 102
IF (OBJ%NEXT_NODE%NEXT_NODE%VALUE /= 22) PRINT*, 103
IF (OBJ%NEXT_NODE%NEXT_NODE%NEXT_NODE%VALUE /= 23) PRINT*, 104
PRINT*,"PASS"

CONTAINS
SUBROUTINE SUB (DMY)
TYPE(NODE),ALLOCATABLE :: DMY
TYPE(NODE),ALLOCATABLE :: RES

DMY%VALUE = 20
DMY%NEXT_NODE%VALUE = 21
DMY%NEXT_NODE%NEXT_NODE%VALUE = 22
DMY%NEXT_NODE%NEXT_NODE%NEXT_NODE%VALUE = 23

ALLOCATE(RES)

RES = DMY
END SUBROUTINE
END
