SUBROUTINE EX_SUB()
         TYPE TY
         INTEGER :: JJ
         INTEGER,ALLOCATABLE :: ALC
         REAL,ALLOCATABLE :: REALALC
         END TYPE
        TYPE TY1
         INTEGER :: II
        INTEGER,ALLOCATABLE :: ALC2
        TYPE(TY), ALLOCATABLE :: NODE2
        END TYPE
        TYPE TY2
         INTEGER :: KK
        TYPE(TY1), ALLOCATABLE :: NODE3
        END TYPE

        TYPE(TY),ALLOCATABLE :: OBJ2
        integer,allocatable::t1
        ALLOCATE(OBJ2)
        ALLOCATE(OBJ2%ALC)
        ALLOCATE(OBJ2%REALALC)
        OBJ2%JJ = 4
        OBJ2%ALC = 5
        OBJ2%REALALC = 9.0
        CALL SUB2(TY2(6,TY1(9,OBJ2%ALC,OBJ2)))
        allocate(t1)
        t1 =110
        IF(OBJ2%ALC.NE.5)PRINT*,"101", OBJ2%ALC
        IF(OBJ2%REALALC.NE.9.0)PRINT*,"102", OBJ2%REALALC
        CALL SUB(TY2(6,TY1(9,OBJ2%ALC,OBJ2)))
        IF(OBJ2%ALC.NE.5)PRINT*,"101", OBJ2%ALC
        IF(OBJ2%REALALC.NE.9.0)PRINT*,"102", OBJ2%REALALC
        PRINT*,"PASS"
        CONTAINS
        SUBROUTINE SUB(OBJ)
        TYPE(TY2),INTENT(IN) :: OBJ
        IF(OBJ%NODE3%NODE2%JJ .NE. 4) PRINT*,"121"
        IF(OBJ%NODE3%NODE2%ALC .NE. 5) PRINT*,"122"
        IF(OBJ%NODE3%II .NE. 9) PRINT*,"123"
        IF(OBJ%NODE3%ALC2 .NE. 5) PRINT*,"124"
        IF(OBJ%NODE3%NODE2%REALALC .NE.9.0) PRINT*,"122"
        IF(OBJ%KK .NE. 6) PRINT*,"123"
        END SUBROUTINE
         SUBROUTINE SUB2(OBJ)
        TYPE(TY2) :: OBJ
        IF(OBJ%NODE3%NODE2%JJ .NE. 4) PRINT*,"121"
        IF(OBJ%NODE3%NODE2%ALC .NE. 5) PRINT*,"122" 
        IF(OBJ%NODE3%II .NE. 9) PRINT*,"123"
        IF(OBJ%NODE3%ALC2 .NE. 5) PRINT*,"124"
        IF(OBJ%NODE3%NODE2%REALALC .NE.9.0) PRINT*,"122"
        IF(OBJ%KK .NE. 6) PRINT*,"123"
        DEALLOCATE(OBJ%NODE3%NODE2%REALALC)
        DEALLOCATE(OBJ%NODE3%NODE2%ALC)
        END SUBROUTINE

        END SUBROUTINE
CALL EX_SUB()
END
