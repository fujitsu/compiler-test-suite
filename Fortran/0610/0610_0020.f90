MODULE mod1
IMPLICIT NONE

TYPE t1
  REAL :: r1 = 0.0
END TYPE

TYPE,EXTENDS(t1) :: t2
  REAL :: r2 = 0.0
END TYPE

INTERFACE OPERATOR(.plus.)
  MODULE PROCEDURE addit
END INTERFACE 

CONTAINS

FUNCTION addit(dy1,dy2)
IMPLICIT NONE
CLASS(t2),INTENT(IN) :: dy1
REAL,INTENT(IN) :: dy2
CLASS(t2),ALLOCATABLE :: addit
ALLOCATE(addit)
addit%r2 = dy1%r2 + dy2
END FUNCTION

END MODULE


PROGRAM main
USE mod1
IMPLICIT NONE

CLASS(t2),ALLOCATABLE :: acc
ALLOCATE(acc)
acc%r2 = 10.00

SELECT TYPE(aa => acc .plus. 12.00)
TYPE IS(t2)
  IF(aa%r2 .EQ. 22.00) THEN
    PRINT*,'pass'
  ELSE
    PRINT*,101
  END IF
END SELECT

END PROGRAM
