       REAL A(50),B(50),C(50),D(50),Z(50,2),res(50,2)
      data res/ 1., 3.5, 1.7777778, 1.125, 0.8, 0.6111111, 0.48979592,
     +     0.40625, 0.34567901, 0.3, 0.26446283,0.2361111, 0.21301776,
     +     0.19387755, 0.17777778, 0.1640625, 0.15224914, 0.14197531,
     +     0.13296398,0.125, 0.117913835, 0.11157025, 0.10586011,
     +     0.10069445, 0.096, 9.171598E-02, 8.7791495E-02,
     +     8.418368E-02, 8.085613E-02, 7.777777E-02, 7.492195E-02,
     +     7.2265625E-02, 6.97888E-02, 6.747405E-02, 6.530613E-02,
     +     6.3271604E-02, 6.1358656E-02, 5.9556786E-02, 5.7856675E-02,
     +     5.625E-02, 5.4729327E-02, 5.3287983E-02, 5.191996E-02,
     +     5.0619837E-02, 4.938272E-02, 4.8204157E-02, 4.7080125E-02,
     +     4.6006944E-02, 4.4981256E-02, 4.4E-02, 1., 3.5, 1.7777778,
     +     1.125, 0.79999995, 0.6111111, 0.48979592, 0.40625,
     +     0.34567901, 0.29999998, 0.2644628, 0.2361111, 0.21301776,
     +     0.19387755, 0.17777778, 0.1640625, 0.15224914,
     +     0.14197531, 0.13296398, 0.125, 0.11791384, 0.111570254,
     +     0.10586011, 0.10069445, 0.096, 9.171598E-02, 8.7791495E-02,
     +     8.418368E-02, 8.085614E-02, 7.777777E-02, 7.492195E-02,
     +     7.2265625E-02, 6.978879E-02, 6.7474045E-02, 6.530613E-02,
     +     6.32716E-02, 6.1358656E-02, 5.9556786E-02, 5.785668E-02,
     +     5.6250002E-02, 5.4729327E-02, 5.3287983E-02, 5.1919955E-02,
     +     5.0619833E-02, 4.9382716E-02, 4.8204157E-02, 4.7080125E-02,
     +     4.600694E-02, 4.4981256E-02, 4.4E-02/

       DO 101 I=1,50
         B(I)=I*2+10.0D0
         A(I)=I
         C(I)=I
         D(I)=I
         Z(I,1)=I
         Z(I,2)=I+1.0D0
 101   CONTINUE
       S1=1.0
       S2=2.0

       ICN=1
       DO 100 K=1,2
       DO 1 I=1,50
         A(I)=B(I)+S1+D(I)-S2
 1     CONTINUE
       ICN=ICN+1

       DO 2 I=5,50
         A(I)=B(I)+C(I)-D(I)
 2     CONTINUE
       ICN=ICN+1

       DO 3 I=2,50
         Z(I,1)=B(I)/C(I)/D(I)
 3     CONTINUE
       ICN=ICN+1

       DO 4 J=1,2
       DO 4 I=1,50
         Z(I,2)=B(I)/C(I)/Z(I,J)*D(I)
 4     CONTINUE
       ICN=ICN+1
 100   CONTINUE
       PRINT *,ICN
       write(6,*) A
       write(6,*)
       call check(Z,res)
       END

#define IS_EQUAL(a,b) ((a==b).or.(a==0.and.abs(b)<10E-6).or.(abs(a-b)/abs(a)<10E-6))
      subroutine check(calc,res)
      real calc(50,2),res(50,2)
      logical ngcheck/.FALSE./
      do i=1,40
         do j=1,2
            if (IS_EQUAL(calc(i,j), res(i,j))) then
            else
               ngcheck = .TRUE.
            endif
         enddo
      enddo
      if (ngcheck) write(6,*) calc
      end
