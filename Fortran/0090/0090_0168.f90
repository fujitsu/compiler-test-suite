program main
  common /com/v,w,t,s
  complex(kind=4),dimension(1:10) :: v,w,t,s
  complex(kind=4),dimension(1:10) :: p,q
  real(kind=4) res
  integer ires
  integer,parameter :: ians = -2120000

  call init
  p(1:10) = v(1:10) + w(1:10)
  q(1:10) = t(1:10) + s(1:10)
  res = real(sum(p+q))-aimag(sum(p+q))
  ires = res*100000
  if (ires .eq. ians) then
    print *,"ok"
  else
    print *,"ng"
  endif
end program main

subroutine init()

  common /com/v,w,t,s
  complex(kind=4),dimension(1:10) :: v,w,t,s

  v = (/(-1.1_4,1.0_4),(-0.1_4,-0.9_4),(-1.2_4,2.1_4),(1.9_4,0.1_4),(1.0_4,0.0_4),(-1.0_4,1.2_4),(0.5_4,-1.0_4),(2.2_4,1.1_4),(0.9_4,1.1_4),(2.0_4,0.1_4)/)
  w = (/(-0.4_4,1.2_4),(-0.2_4,-0.8_4),(-1.9_4,1.2_4),(-2.0_4,-1.0_4),(1.2_4,1.0_4),(-0.8_4,0.2_4),(-0.8_4,1.0_4),(-2.0_4,0.5_4),(0.8_4,2.1_4),(-2.0_4,-1.4_4)/)
  t = (/(-1.0_4,2.0_4),(0.5_4,0.0_4),(1.2_4,-2.0_4),(-1.0_4,1.3_4),(1.5_4,1.5_4),(-0.9_4,1.2_4),(1.5_4,1.0_4),(-2.0_4,1.9_4),(0.8_4,0.9_4),(1.0_4,0.9_4)/)
  s = (/(2.4_4,2.2_4),(2.0_4,1.8_4),(0.9_4,-1.0_4),(-1.0_4,-1.0_4),(-1.0_4,2.5_4),(0.7_4,0.8_4),(1.8_4,1.2_4),(2.1_4,2.2_4),(-1.0_4,0.3_4),(0.8_4,1.0_4)/)

end subroutine
